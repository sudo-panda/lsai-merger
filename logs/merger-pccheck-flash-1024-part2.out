2025-05-23 01:06:45,418 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=1024, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=1000, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, seed=4, checkpoint_dir='/iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts', loss_file='/iopsstor/scratch/cscs/bkundu/lsai-merger/results/bf16/loss-pccheck-flash-1024-part2.csv', checkpoint_freq=100, max_async=1, warmup=3, load_checkpoint=True, non_blocking=False)
2025-05-23 01:06:45,423 - root - INFO - Random state checkpoint loaded from /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:06:45,423 - root - INFO - Training will resume from step: 400
2025-05-23 01:06:45,423 - root - INFO - Setting up DataLoaders...
2025-05-23 01:06:46,461 - root - INFO - Setting up Model...
2025-05-23 01:06:54,537 - root - INFO - Loading checkpoint model, optimizer + scheduler
/iopsstor/scratch/cscs/bkundu/lsai-merger/LSAI-Checkpointing/training/utils.py:85: UserWarning: The given buffer is not writable, and PyTorch does not support non-writable tensors. This means you can write to the underlying (supposedly non-writable) buffer using the tensor. You may want to copy the buffer to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at /opt/pytorch/pytorch/torch/csrc/utils/tensor_new.cpp:1561.)
  data = torch.frombuffer(payload, dtype=torch.float32)
2025-05-23 01:06:57,806 - root - INFO - Checkpoint loaded from /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/checkpoint_pccheck.pt
2025-05-23 01:06:57,819 - root - INFO - Loaded optimizer, scheduler checkpoint at step 400 in 3.28 seconds
Model size: 755041280, Optimizer size: 1510082852, Total size: 2265124132
BSIZE IS 2265124132
At checkpoint, bsize is 2265124132
2025-05-23 01:07:04,395 - root - INFO - Checkpointing warmup done
2025-05-23 01:07:04,399 - root - INFO - ------------------------------------------------------------Starting training!
2025-05-23 01:07:05,176 - root - INFO - Step: 405 | Loss: 11.45 | Tokens per second: 6598.23 | Training tokens per second (%): 53.48 | MFU (%): 2.75 | TFLOPs: 27.23 | Fwd time: 0.0307094 | Bck time: 0.0445938
2025-05-23 01:07:05,730 - root - INFO - Step: 410 | Loss: 11.48 | Tokens per second: 9269.40 | Training tokens per second (%): 70.70 | MFU (%): 3.87 | TFLOPs: 38.26 | Fwd time: 0.0298005 | Bck time: 0.0449833
2025-05-23 01:07:06,288 - root - INFO - Step: 415 | Loss: 11.51 | Tokens per second: 9204.77 | Training tokens per second (%): 74.12 | MFU (%): 3.84 | TFLOPs: 37.99 | Fwd time: 0.0300174 | Bck time: 0.0439865
2025-05-23 01:07:06,838 - root - INFO - Step: 420 | Loss: 11.27 | Tokens per second: 9332.08 | Training tokens per second (%): 46.97 | MFU (%): 3.89 | TFLOPs: 38.52 | Fwd time: 0.0305096 | Bck time: 0.0440348
2025-05-23 01:07:07,385 - root - INFO - Step: 425 | Loss: 11.34 | Tokens per second: 9387.83 | Training tokens per second (%): 40.94 | MFU (%): 3.92 | TFLOPs: 38.75 | Fwd time: 0.0306127 | Bck time: 0.0445470
2025-05-23 01:07:07,967 - root - INFO - Step: 430 | Loss: 11.52 | Tokens per second: 8815.18 | Training tokens per second (%): 71.68 | MFU (%): 3.68 | TFLOPs: 36.39 | Fwd time: 0.0295394 | Bck time: 0.0434814
2025-05-23 01:07:08,590 - root - INFO - Step: 435 | Loss: 11.36 | Tokens per second: 8238.71 | Training tokens per second (%): 74.38 | MFU (%): 3.44 | TFLOPs: 34.01 | Fwd time: 0.0300489 | Bck time: 0.0443653
2025-05-23 01:07:09,141 - root - INFO - Step: 440 | Loss: 11.32 | Tokens per second: 9310.16 | Training tokens per second (%): 59.88 | MFU (%): 3.89 | TFLOPs: 38.43 | Fwd time: 0.0299697 | Bck time: 0.0441664
2025-05-23 01:07:09,699 - root - INFO - Step: 445 | Loss: 11.10 | Tokens per second: 9211.79 | Training tokens per second (%): 68.91 | MFU (%): 3.84 | TFLOPs: 38.02 | Fwd time: 0.0300035 | Bck time: 0.0439874
2025-05-23 01:07:10,252 - root - INFO - Step: 450 | Loss: 11.33 | Tokens per second: 9276.98 | Training tokens per second (%): 77.27 | MFU (%): 3.87 | TFLOPs: 38.29 | Fwd time: 0.0300689 | Bck time: 0.0436470
2025-05-23 01:07:10,817 - root - INFO - Step: 455 | Loss: 11.08 | Tokens per second: 9090.30 | Training tokens per second (%): 76.52 | MFU (%): 3.79 | TFLOPs: 37.52 | Fwd time: 0.0297535 | Bck time: 0.0447982
2025-05-23 01:07:11,370 - root - INFO - Step: 460 | Loss: 11.37 | Tokens per second: 9278.25 | Training tokens per second (%): 76.35 | MFU (%): 3.87 | TFLOPs: 38.30 | Fwd time: 0.0299973 | Bck time: 0.0446465
2025-05-23 01:07:11,918 - root - INFO - Step: 465 | Loss: 11.18 | Tokens per second: 9363.52 | Training tokens per second (%): 67.70 | MFU (%): 3.91 | TFLOPs: 38.65 | Fwd time: 0.0291080 | Bck time: 0.0444779
2025-05-23 01:07:12,472 - root - INFO - Step: 470 | Loss: 11.15 | Tokens per second: 9262.62 | Training tokens per second (%): 68.83 | MFU (%): 3.87 | TFLOPs: 38.23 | Fwd time: 0.0300797 | Bck time: 0.0435667
2025-05-23 01:07:13,030 - root - INFO - Step: 475 | Loss: 11.49 | Tokens per second: 9201.55 | Training tokens per second (%): 66.56 | MFU (%): 3.84 | TFLOPs: 37.98 | Fwd time: 0.0302286 | Bck time: 0.0446830
2025-05-23 01:07:13,586 - root - INFO - Step: 480 | Loss: 10.92 | Tokens per second: 9227.95 | Training tokens per second (%): 73.26 | MFU (%): 3.85 | TFLOPs: 38.09 | Fwd time: 0.0300600 | Bck time: 0.0443550
2025-05-23 01:07:14,139 - root - INFO - Step: 485 | Loss: 11.52 | Tokens per second: 9285.22 | Training tokens per second (%): 48.54 | MFU (%): 3.88 | TFLOPs: 38.33 | Fwd time: 0.0302875 | Bck time: 0.0451507
2025-05-23 01:07:14,692 - root - INFO - Step: 490 | Loss: 11.54 | Tokens per second: 9287.74 | Training tokens per second (%): 54.59 | MFU (%): 3.88 | TFLOPs: 38.34 | Fwd time: 0.0297801 | Bck time: 0.0449956
2025-05-23 01:07:15,251 - root - INFO - Step: 495 | Loss: 11.57 | Tokens per second: 9189.06 | Training tokens per second (%): 46.95 | MFU (%): 3.84 | TFLOPs: 37.93 | Fwd time: 0.0301218 | Bck time: 0.0443985
2025-05-23 01:07:15,808 - root - INFO - Step: 500 | Loss: 11.44 | Tokens per second: 9209.74 | Training tokens per second (%): 87.85 | MFU (%): 3.84 | TFLOPs: 38.01 | Fwd time: 0.0304154 | Bck time: 0.0442370
2025-05-23 01:07:20,790 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:07:20,798 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 01:07:21,377 - root - INFO - Step: 505 | Loss: 11.14 | Tokens per second: 919.57 | Training tokens per second (%): 53.85 | MFU (%): 0.38 | TFLOPs: 3.80 | Fwd time: 0.0300925 | Bck time: 0.0431520
2025-05-23 01:07:21,923 - root - INFO - Step: 510 | Loss: 11.35 | Tokens per second: 9410.62 | Training tokens per second (%): 58.40 | MFU (%): 3.93 | TFLOPs: 38.84 | Fwd time: 0.0297242 | Bck time: 0.0437827
2025-05-23 01:07:22,470 - root - INFO - Step: 515 | Loss: 10.69 | Tokens per second: 9380.98 | Training tokens per second (%): 51.07 | MFU (%): 3.92 | TFLOPs: 38.72 | Fwd time: 0.0297986 | Bck time: 0.0439261
2025-05-23 01:07:23,019 - root - INFO - Step: 520 | Loss: 11.18 | Tokens per second: 9350.41 | Training tokens per second (%): 67.07 | MFU (%): 3.90 | TFLOPs: 38.59 | Fwd time: 0.0300311 | Bck time: 0.0442621
2025-05-23 01:07:23,571 - root - INFO - Step: 525 | Loss: 11.08 | Tokens per second: 9304.29 | Training tokens per second (%): 65.33 | MFU (%): 3.88 | TFLOPs: 38.40 | Fwd time: 0.0297969 | Bck time: 0.0437634
2025-05-23 01:07:24,120 - root - INFO - Step: 530 | Loss: 11.27 | Tokens per second: 9351.33 | Training tokens per second (%): 81.27 | MFU (%): 3.90 | TFLOPs: 38.60 | Fwd time: 0.0299086 | Bck time: 0.0438626
2025-05-23 01:07:24,691 - root - INFO - Step: 535 | Loss: 11.33 | Tokens per second: 8992.31 | Training tokens per second (%): 84.04 | MFU (%): 3.75 | TFLOPs: 37.12 | Fwd time: 0.0299267 | Bck time: 0.0444187
2025-05-23 01:07:25,257 - root - INFO - Step: 540 | Loss: 10.15 | Tokens per second: 9061.05 | Training tokens per second (%): 53.63 | MFU (%): 3.78 | TFLOPs: 37.40 | Fwd time: 0.0313948 | Bck time: 0.0437331
2025-05-23 01:07:25,816 - root - INFO - Step: 545 | Loss: 11.17 | Tokens per second: 9178.80 | Training tokens per second (%): 82.29 | MFU (%): 3.83 | TFLOPs: 37.89 | Fwd time: 0.0303268 | Bck time: 0.0440642
2025-05-23 01:07:26,363 - root - INFO - Step: 550 | Loss: 11.33 | Tokens per second: 9393.79 | Training tokens per second (%): 33.73 | MFU (%): 3.92 | TFLOPs: 38.77 | Fwd time: 0.0304673 | Bck time: 0.0446778
2025-05-23 01:07:26,914 - root - INFO - Step: 555 | Loss: 11.60 | Tokens per second: 9314.00 | Training tokens per second (%): 51.64 | MFU (%): 3.89 | TFLOPs: 38.44 | Fwd time: 0.0298085 | Bck time: 0.0437915
2025-05-23 01:07:27,468 - root - INFO - Step: 560 | Loss: 11.46 | Tokens per second: 9267.55 | Training tokens per second (%): 71.05 | MFU (%): 3.87 | TFLOPs: 38.25 | Fwd time: 0.0298279 | Bck time: 0.0446710
2025-05-23 01:07:28,014 - root - INFO - Step: 565 | Loss: 11.35 | Tokens per second: 9396.68 | Training tokens per second (%): 43.40 | MFU (%): 3.92 | TFLOPs: 38.79 | Fwd time: 0.0303546 | Bck time: 0.0435676
2025-05-23 01:07:28,561 - root - INFO - Step: 570 | Loss: 11.47 | Tokens per second: 9378.92 | Training tokens per second (%): 39.67 | MFU (%): 3.91 | TFLOPs: 38.71 | Fwd time: 0.0303436 | Bck time: 0.0439774
2025-05-23 01:07:29,110 - root - INFO - Step: 575 | Loss: 11.14 | Tokens per second: 9366.79 | Training tokens per second (%): 47.83 | MFU (%): 3.91 | TFLOPs: 38.66 | Fwd time: 0.0300170 | Bck time: 0.0445769
2025-05-23 01:07:29,657 - root - INFO - Step: 580 | Loss: 11.60 | Tokens per second: 9369.71 | Training tokens per second (%): 29.63 | MFU (%): 3.91 | TFLOPs: 38.67 | Fwd time: 0.0299207 | Bck time: 0.0444660
2025-05-23 01:07:30,208 - root - INFO - Step: 585 | Loss: 11.01 | Tokens per second: 9325.87 | Training tokens per second (%): 45.20 | MFU (%): 3.89 | TFLOPs: 38.49 | Fwd time: 0.0300125 | Bck time: 0.0443113
2025-05-23 01:07:30,759 - root - INFO - Step: 590 | Loss: 11.24 | Tokens per second: 9322.06 | Training tokens per second (%): 64.39 | MFU (%): 3.89 | TFLOPs: 38.48 | Fwd time: 0.0306030 | Bck time: 0.0445545
2025-05-23 01:07:31,307 - root - INFO - Step: 595 | Loss: 11.44 | Tokens per second: 9359.54 | Training tokens per second (%): 47.64 | MFU (%): 3.91 | TFLOPs: 38.63 | Fwd time: 0.0302569 | Bck time: 0.0443216
2025-05-23 01:07:31,857 - root - INFO - Step: 600 | Loss: 11.23 | Tokens per second: 9332.20 | Training tokens per second (%): 45.84 | MFU (%): 3.89 | TFLOPs: 38.52 | Fwd time: 0.0303279 | Bck time: 0.0445017
2025-05-23 01:07:37,133 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:07:37,135 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 01:07:37,813 - root - INFO - Step: 605 | Loss: 11.40 | Tokens per second: 859.88 | Training tokens per second (%): 47.93 | MFU (%): 0.36 | TFLOPs: 3.55 | Fwd time: 0.0278552 | Bck time: 0.0441769
2025-05-23 01:07:38,363 - root - INFO - Step: 610 | Loss: 11.61 | Tokens per second: 9324.29 | Training tokens per second (%): 40.45 | MFU (%): 3.89 | TFLOPs: 38.49 | Fwd time: 0.0308474 | Bck time: 0.0441562
2025-05-23 01:07:38,917 - root - INFO - Step: 615 | Loss: 11.40 | Tokens per second: 9265.99 | Training tokens per second (%): 69.38 | MFU (%): 3.87 | TFLOPs: 38.25 | Fwd time: 0.0297878 | Bck time: 0.0442203
2025-05-23 01:07:39,465 - root - INFO - Step: 620 | Loss: 10.95 | Tokens per second: 9375.54 | Training tokens per second (%): 54.59 | MFU (%): 3.91 | TFLOPs: 38.70 | Fwd time: 0.0300939 | Bck time: 0.0438119
2025-05-23 01:07:40,017 - root - INFO - Step: 625 | Loss: 11.38 | Tokens per second: 9299.41 | Training tokens per second (%): 60.74 | MFU (%): 3.88 | TFLOPs: 38.38 | Fwd time: 0.0303565 | Bck time: 0.0440803
2025-05-23 01:07:40,568 - root - INFO - Step: 630 | Loss: 11.25 | Tokens per second: 9319.77 | Training tokens per second (%): 55.82 | MFU (%): 3.89 | TFLOPs: 38.47 | Fwd time: 0.0305315 | Bck time: 0.0443199
2025-05-23 01:07:41,121 - root - INFO - Step: 635 | Loss: 11.45 | Tokens per second: 9277.39 | Training tokens per second (%): 75.61 | MFU (%): 3.87 | TFLOPs: 38.29 | Fwd time: 0.0299915 | Bck time: 0.0441906
2025-05-23 01:07:41,667 - root - INFO - Step: 640 | Loss: 11.23 | Tokens per second: 9397.68 | Training tokens per second (%): 61.74 | MFU (%): 3.92 | TFLOPs: 38.79 | Fwd time: 0.0303268 | Bck time: 0.0442032
2025-05-23 01:07:42,215 - root - INFO - Step: 645 | Loss: 11.10 | Tokens per second: 9380.46 | Training tokens per second (%): 45.98 | MFU (%): 3.91 | TFLOPs: 38.72 | Fwd time: 0.0300044 | Bck time: 0.0442513
2025-05-23 01:07:42,774 - root - INFO - Step: 650 | Loss: 10.97 | Tokens per second: 9185.08 | Training tokens per second (%): 80.64 | MFU (%): 3.83 | TFLOPs: 37.91 | Fwd time: 0.0309811 | Bck time: 0.0441461
2025-05-23 01:07:43,319 - root - INFO - Step: 655 | Loss: 11.26 | Tokens per second: 9406.81 | Training tokens per second (%): 48.71 | MFU (%): 3.93 | TFLOPs: 38.83 | Fwd time: 0.0300235 | Bck time: 0.0427711
2025-05-23 01:07:43,855 - root - INFO - Step: 660 | Loss: 11.17 | Tokens per second: 9579.16 | Training tokens per second (%): 51.99 | MFU (%): 4.00 | TFLOPs: 39.54 | Fwd time: 0.0300211 | Bck time: 0.0427154
2025-05-23 01:07:44,419 - root - INFO - Step: 665 | Loss: 11.27 | Tokens per second: 9096.69 | Training tokens per second (%): 70.82 | MFU (%): 3.80 | TFLOPs: 37.55 | Fwd time: 0.0302089 | Bck time: 0.0442499
2025-05-23 01:07:44,968 - root - INFO - Step: 670 | Loss: 10.73 | Tokens per second: 9350.23 | Training tokens per second (%): 67.19 | MFU (%): 3.90 | TFLOPs: 38.59 | Fwd time: 0.0306500 | Bck time: 0.0435187
2025-05-23 01:07:45,514 - root - INFO - Step: 675 | Loss: 10.93 | Tokens per second: 9402.40 | Training tokens per second (%): 37.05 | MFU (%): 3.92 | TFLOPs: 38.81 | Fwd time: 0.0304134 | Bck time: 0.0438413
2025-05-23 01:07:46,068 - root - INFO - Step: 680 | Loss: 11.01 | Tokens per second: 9264.89 | Training tokens per second (%): 64.96 | MFU (%): 3.87 | TFLOPs: 38.24 | Fwd time: 0.0301312 | Bck time: 0.0439537
2025-05-23 01:07:46,618 - root - INFO - Step: 685 | Loss: 11.19 | Tokens per second: 9343.14 | Training tokens per second (%): 64.36 | MFU (%): 3.90 | TFLOPs: 38.56 | Fwd time: 0.0301272 | Bck time: 0.0432923
2025-05-23 01:07:47,165 - root - INFO - Step: 690 | Loss: 11.08 | Tokens per second: 9388.91 | Training tokens per second (%): 29.28 | MFU (%): 3.92 | TFLOPs: 38.75 | Fwd time: 0.0301743 | Bck time: 0.0440169
2025-05-23 01:07:47,734 - root - INFO - Step: 695 | Loss: 11.25 | Tokens per second: 9021.05 | Training tokens per second (%): 79.20 | MFU (%): 3.76 | TFLOPs: 37.24 | Fwd time: 0.0310742 | Bck time: 0.0448187
2025-05-23 01:07:48,287 - root - INFO - Step: 700 | Loss: 11.03 | Tokens per second: 9276.06 | Training tokens per second (%): 59.45 | MFU (%): 3.87 | TFLOPs: 38.29 | Fwd time: 0.0314287 | Bck time: 0.0441652
2025-05-23 01:07:52,419 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:07:52,421 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 01:07:52,987 - root - INFO - Step: 705 | Loss: 11.20 | Tokens per second: 1089.83 | Training tokens per second (%): 70.08 | MFU (%): 0.45 | TFLOPs: 4.50 | Fwd time: 0.0296423 | Bck time: 0.0427122
2025-05-23 01:07:53,540 - root - INFO - Step: 710 | Loss: 11.22 | Tokens per second: 9271.86 | Training tokens per second (%): 100.00 | MFU (%): 3.87 | TFLOPs: 38.27 | Fwd time: 0.0306076 | Bck time: 0.0436898
2025-05-23 01:07:54,096 - root - INFO - Step: 715 | Loss: 11.02 | Tokens per second: 9243.43 | Training tokens per second (%): 56.64 | MFU (%): 3.86 | TFLOPs: 38.15 | Fwd time: 0.0305641 | Bck time: 0.0434403
2025-05-23 01:07:54,634 - root - INFO - Step: 720 | Loss: 10.20 | Tokens per second: 9528.23 | Training tokens per second (%): 46.68 | MFU (%): 3.98 | TFLOPs: 39.33 | Fwd time: 0.0299906 | Bck time: 0.0429925
2025-05-23 01:07:55,183 - root - INFO - Step: 725 | Loss: 11.17 | Tokens per second: 9361.71 | Training tokens per second (%): 39.39 | MFU (%): 3.91 | TFLOPs: 38.64 | Fwd time: 0.0307545 | Bck time: 0.0435981
2025-05-23 01:07:55,732 - root - INFO - Step: 730 | Loss: 11.19 | Tokens per second: 9350.14 | Training tokens per second (%): 45.06 | MFU (%): 3.90 | TFLOPs: 38.59 | Fwd time: 0.0312506 | Bck time: 0.0432485
2025-05-23 01:07:56,279 - root - INFO - Step: 735 | Loss: 11.05 | Tokens per second: 9382.35 | Training tokens per second (%): 37.15 | MFU (%): 3.92 | TFLOPs: 38.73 | Fwd time: 0.0308244 | Bck time: 0.0438495
2025-05-23 01:07:56,833 - root - INFO - Step: 740 | Loss: 11.51 | Tokens per second: 9264.04 | Training tokens per second (%): 56.19 | MFU (%): 3.87 | TFLOPs: 38.24 | Fwd time: 0.0314472 | Bck time: 0.0433386
2025-05-23 01:07:57,380 - root - INFO - Step: 745 | Loss: 11.25 | Tokens per second: 9377.43 | Training tokens per second (%): 35.76 | MFU (%): 3.91 | TFLOPs: 38.71 | Fwd time: 0.0301050 | Bck time: 0.0429890
2025-05-23 01:07:57,931 - root - INFO - Step: 750 | Loss: 11.29 | Tokens per second: 9319.36 | Training tokens per second (%): 72.73 | MFU (%): 3.89 | TFLOPs: 38.47 | Fwd time: 0.0308321 | Bck time: 0.0440732
2025-05-23 01:07:58,481 - root - INFO - Step: 755 | Loss: 11.25 | Tokens per second: 9341.55 | Training tokens per second (%): 69.63 | MFU (%): 3.90 | TFLOPs: 38.56 | Fwd time: 0.0301595 | Bck time: 0.0441893
2025-05-23 01:07:59,038 - root - INFO - Step: 760 | Loss: 11.31 | Tokens per second: 9215.07 | Training tokens per second (%): 87.03 | MFU (%): 3.85 | TFLOPs: 38.04 | Fwd time: 0.0319940 | Bck time: 0.0435023
2025-05-23 01:07:59,603 - root - INFO - Step: 765 | Loss: 10.82 | Tokens per second: 9077.94 | Training tokens per second (%): 96.66 | MFU (%): 3.79 | TFLOPs: 37.47 | Fwd time: 0.0309085 | Bck time: 0.0433285
2025-05-23 01:08:00,151 - root - INFO - Step: 770 | Loss: 10.97 | Tokens per second: 9369.69 | Training tokens per second (%): 65.62 | MFU (%): 3.91 | TFLOPs: 38.67 | Fwd time: 0.0304568 | Bck time: 0.0434374
2025-05-23 01:08:00,708 - root - INFO - Step: 775 | Loss: 10.70 | Tokens per second: 9213.29 | Training tokens per second (%): 54.79 | MFU (%): 3.85 | TFLOPs: 38.03 | Fwd time: 0.0308541 | Bck time: 0.0437174
2025-05-23 01:08:01,258 - root - INFO - Step: 780 | Loss: 11.50 | Tokens per second: 9343.57 | Training tokens per second (%): 48.96 | MFU (%): 3.90 | TFLOPs: 38.57 | Fwd time: 0.0309214 | Bck time: 0.0436646
2025-05-23 01:08:01,809 - root - INFO - Step: 785 | Loss: 11.25 | Tokens per second: 9310.85 | Training tokens per second (%): 67.97 | MFU (%): 3.89 | TFLOPs: 38.43 | Fwd time: 0.0306470 | Bck time: 0.0437695
2025-05-23 01:08:02,355 - root - INFO - Step: 790 | Loss: 10.86 | Tokens per second: 9398.01 | Training tokens per second (%): 64.88 | MFU (%): 3.92 | TFLOPs: 38.79 | Fwd time: 0.0306619 | Bck time: 0.0426675
2025-05-23 01:08:02,918 - root - INFO - Step: 795 | Loss: 10.84 | Tokens per second: 9114.89 | Training tokens per second (%): 76.72 | MFU (%): 3.80 | TFLOPs: 37.62 | Fwd time: 0.0304295 | Bck time: 0.0427551
2025-05-23 01:08:03,476 - root - INFO - Step: 800 | Loss: 11.00 | Tokens per second: 9206.76 | Training tokens per second (%): 70.10 | MFU (%): 3.84 | TFLOPs: 38.00 | Fwd time: 0.0315089 | Bck time: 0.0439114
2025-05-23 01:08:07,576 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:08:07,580 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 01:08:08,181 - root - INFO - Step: 805 | Loss: 11.19 | Tokens per second: 1088.64 | Training tokens per second (%): 82.40 | MFU (%): 0.45 | TFLOPs: 4.49 | Fwd time: 0.0307552 | Bck time: 0.0446693
2025-05-23 01:08:08,734 - root - INFO - Step: 810 | Loss: 11.03 | Tokens per second: 9271.25 | Training tokens per second (%): 67.11 | MFU (%): 3.87 | TFLOPs: 38.27 | Fwd time: 0.0308790 | Bck time: 0.0443490
2025-05-23 01:08:09,284 - root - INFO - Step: 815 | Loss: 11.44 | Tokens per second: 9336.70 | Training tokens per second (%): 62.75 | MFU (%): 3.90 | TFLOPs: 38.54 | Fwd time: 0.0303356 | Bck time: 0.0419272
2025-05-23 01:08:09,833 - root - INFO - Step: 820 | Loss: 10.57 | Tokens per second: 9359.89 | Training tokens per second (%): 61.56 | MFU (%): 3.91 | TFLOPs: 38.63 | Fwd time: 0.0314267 | Bck time: 0.0430800
2025-05-23 01:08:10,392 - root - INFO - Step: 825 | Loss: 11.06 | Tokens per second: 9175.41 | Training tokens per second (%): 89.63 | MFU (%): 3.83 | TFLOPs: 37.87 | Fwd time: 0.0312920 | Bck time: 0.0439553
2025-05-23 01:08:10,945 - root - INFO - Step: 830 | Loss: 11.13 | Tokens per second: 9275.52 | Training tokens per second (%): 68.81 | MFU (%): 3.87 | TFLOPs: 38.29 | Fwd time: 0.0316386 | Bck time: 0.0433615
2025-05-23 01:08:11,496 - root - INFO - Step: 835 | Loss: 11.33 | Tokens per second: 9326.16 | Training tokens per second (%): 37.79 | MFU (%): 3.89 | TFLOPs: 38.49 | Fwd time: 0.0305227 | Bck time: 0.0438567
2025-05-23 01:08:12,048 - root - INFO - Step: 840 | Loss: 11.11 | Tokens per second: 9303.16 | Training tokens per second (%): 35.92 | MFU (%): 3.88 | TFLOPs: 38.40 | Fwd time: 0.0314733 | Bck time: 0.0437973
2025-05-23 01:08:12,604 - root - INFO - Step: 845 | Loss: 11.25 | Tokens per second: 9231.69 | Training tokens per second (%): 57.68 | MFU (%): 3.85 | TFLOPs: 38.10 | Fwd time: 0.0319020 | Bck time: 0.0436452
2025-05-23 01:08:13,158 - root - INFO - Step: 850 | Loss: 10.68 | Tokens per second: 9256.29 | Training tokens per second (%): 57.05 | MFU (%): 3.86 | TFLOPs: 38.21 | Fwd time: 0.0314715 | Bck time: 0.0441359
2025-05-23 01:08:13,717 - root - INFO - Step: 855 | Loss: 11.23 | Tokens per second: 9185.96 | Training tokens per second (%): 84.08 | MFU (%): 3.83 | TFLOPs: 37.92 | Fwd time: 0.0309469 | Bck time: 0.0433174
2025-05-23 01:08:14,270 - root - INFO - Step: 860 | Loss: 11.34 | Tokens per second: 9276.18 | Training tokens per second (%): 34.51 | MFU (%): 3.87 | TFLOPs: 38.29 | Fwd time: 0.0317311 | Bck time: 0.0431469
2025-05-23 01:08:14,825 - root - INFO - Step: 865 | Loss: 10.42 | Tokens per second: 9256.28 | Training tokens per second (%): 59.63 | MFU (%): 3.86 | TFLOPs: 38.21 | Fwd time: 0.0310102 | Bck time: 0.0444183
2025-05-23 01:08:15,382 - root - INFO - Step: 870 | Loss: 10.87 | Tokens per second: 9210.55 | Training tokens per second (%): 70.31 | MFU (%): 3.84 | TFLOPs: 38.02 | Fwd time: 0.0314902 | Bck time: 0.0432411
2025-05-23 01:08:15,936 - root - INFO - Step: 875 | Loss: 10.93 | Tokens per second: 9277.04 | Training tokens per second (%): 49.41 | MFU (%): 3.87 | TFLOPs: 38.29 | Fwd time: 0.0310446 | Bck time: 0.0436504
2025-05-23 01:08:16,490 - root - INFO - Step: 880 | Loss: 11.51 | Tokens per second: 9263.64 | Training tokens per second (%): 61.56 | MFU (%): 3.87 | TFLOPs: 38.24 | Fwd time: 0.0318403 | Bck time: 0.0436458
2025-05-23 01:08:17,048 - root - INFO - Step: 885 | Loss: 10.75 | Tokens per second: 9197.45 | Training tokens per second (%): 71.84 | MFU (%): 3.84 | TFLOPs: 37.96 | Fwd time: 0.0310661 | Bck time: 0.0431281
2025-05-23 01:08:17,607 - root - INFO - Step: 890 | Loss: 10.93 | Tokens per second: 9184.89 | Training tokens per second (%): 73.14 | MFU (%): 3.83 | TFLOPs: 37.91 | Fwd time: 0.0311472 | Bck time: 0.0440946
2025-05-23 01:08:18,160 - root - INFO - Step: 895 | Loss: 11.45 | Tokens per second: 9277.61 | Training tokens per second (%): 50.63 | MFU (%): 3.87 | TFLOPs: 38.29 | Fwd time: 0.0310189 | Bck time: 0.0436449
2025-05-23 01:08:18,716 - root - INFO - Step: 900 | Loss: 11.10 | Tokens per second: 9227.84 | Training tokens per second (%): 46.68 | MFU (%): 3.85 | TFLOPs: 38.09 | Fwd time: 0.0316823 | Bck time: 0.0440046
2025-05-23 01:08:22,877 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:08:22,883 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 01:08:23,458 - root - INFO - Step: 905 | Loss: 11.39 | Tokens per second: 1080.15 | Training tokens per second (%): 42.01 | MFU (%): 0.45 | TFLOPs: 4.46 | Fwd time: 0.0311485 | Bck time: 0.0435607
2025-05-23 01:08:24,018 - root - INFO - Step: 910 | Loss: 10.79 | Tokens per second: 9171.96 | Training tokens per second (%): 82.42 | MFU (%): 3.83 | TFLOPs: 37.86 | Fwd time: 0.0318780 | Bck time: 0.0430295
2025-05-23 01:08:24,571 - root - INFO - Step: 915 | Loss: 11.03 | Tokens per second: 9276.22 | Training tokens per second (%): 49.36 | MFU (%): 3.87 | TFLOPs: 38.29 | Fwd time: 0.0300512 | Bck time: 0.0438409
2025-05-23 01:08:25,122 - root - INFO - Step: 920 | Loss: 11.09 | Tokens per second: 9311.22 | Training tokens per second (%): 76.00 | MFU (%): 3.89 | TFLOPs: 38.43 | Fwd time: 0.0305889 | Bck time: 0.0437728
2025-05-23 01:08:25,673 - root - INFO - Step: 925 | Loss: 10.94 | Tokens per second: 9319.29 | Training tokens per second (%): 40.98 | MFU (%): 3.89 | TFLOPs: 38.47 | Fwd time: 0.0300714 | Bck time: 0.0443126
2025-05-23 01:08:26,231 - root - INFO - Step: 930 | Loss: 10.68 | Tokens per second: 9193.02 | Training tokens per second (%): 71.88 | MFU (%): 3.84 | TFLOPs: 37.95 | Fwd time: 0.0310395 | Bck time: 0.0435653
2025-05-23 01:08:26,785 - root - INFO - Step: 935 | Loss: 10.99 | Tokens per second: 9265.74 | Training tokens per second (%): 54.55 | MFU (%): 3.87 | TFLOPs: 38.25 | Fwd time: 0.0309212 | Bck time: 0.0439857
2025-05-23 01:08:27,342 - root - INFO - Step: 940 | Loss: 10.77 | Tokens per second: 9220.27 | Training tokens per second (%): 78.89 | MFU (%): 3.85 | TFLOPs: 38.06 | Fwd time: 0.0316599 | Bck time: 0.0437119
2025-05-23 01:08:27,905 - root - INFO - Step: 945 | Loss: 11.04 | Tokens per second: 9125.00 | Training tokens per second (%): 52.44 | MFU (%): 3.81 | TFLOPs: 37.66 | Fwd time: 0.0317056 | Bck time: 0.0437482
2025-05-23 01:08:28,482 - root - INFO - Step: 950 | Loss: 10.76 | Tokens per second: 8888.71 | Training tokens per second (%): 81.88 | MFU (%): 3.71 | TFLOPs: 36.69 | Fwd time: 0.0312575 | Bck time: 0.0434123
2025-05-23 01:08:29,039 - root - INFO - Step: 955 | Loss: 10.90 | Tokens per second: 9220.39 | Training tokens per second (%): 55.59 | MFU (%): 3.85 | TFLOPs: 38.06 | Fwd time: 0.0313167 | Bck time: 0.0439035
2025-05-23 01:08:29,602 - root - INFO - Step: 960 | Loss: 11.17 | Tokens per second: 9111.15 | Training tokens per second (%): 76.97 | MFU (%): 3.80 | TFLOPs: 37.61 | Fwd time: 0.0305713 | Bck time: 0.0441247
2025-05-23 01:08:30,158 - root - INFO - Step: 965 | Loss: 11.24 | Tokens per second: 9244.20 | Training tokens per second (%): 55.33 | MFU (%): 3.86 | TFLOPs: 38.16 | Fwd time: 0.0312857 | Bck time: 0.0435814
2025-05-23 01:08:30,711 - root - INFO - Step: 970 | Loss: 11.10 | Tokens per second: 9268.96 | Training tokens per second (%): 36.58 | MFU (%): 3.87 | TFLOPs: 38.26 | Fwd time: 0.0316707 | Bck time: 0.0441571
2025-05-23 01:08:31,270 - root - INFO - Step: 975 | Loss: 10.38 | Tokens per second: 9188.42 | Training tokens per second (%): 60.94 | MFU (%): 3.83 | TFLOPs: 37.93 | Fwd time: 0.0313015 | Bck time: 0.0440187
2025-05-23 01:08:31,853 - root - INFO - Step: 980 | Loss: 11.26 | Tokens per second: 8801.04 | Training tokens per second (%): 76.52 | MFU (%): 3.67 | TFLOPs: 36.33 | Fwd time: 0.0310642 | Bck time: 0.0440458
2025-05-23 01:08:32,409 - root - INFO - Step: 985 | Loss: 10.86 | Tokens per second: 9228.34 | Training tokens per second (%): 63.61 | MFU (%): 3.85 | TFLOPs: 38.09 | Fwd time: 0.0309998 | Bck time: 0.0440464
2025-05-23 01:08:32,965 - root - INFO - Step: 990 | Loss: 11.30 | Tokens per second: 9241.07 | Training tokens per second (%): 48.40 | MFU (%): 3.86 | TFLOPs: 38.14 | Fwd time: 0.0312592 | Bck time: 0.0438901
2025-05-23 01:08:33,532 - root - INFO - Step: 995 | Loss: 11.18 | Tokens per second: 9044.18 | Training tokens per second (%): 66.09 | MFU (%): 3.77 | TFLOPs: 37.33 | Fwd time: 0.0316620 | Bck time: 0.0432098
2025-05-23 01:08:34,092 - root - INFO - Step: 1000 | Loss: 10.77 | Tokens per second: 9177.33 | Training tokens per second (%): 72.13 | MFU (%): 3.83 | TFLOPs: 37.88 | Fwd time: 0.0316297 | Bck time: 0.0447474
2025-05-23 01:08:38,179 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:08:38,182 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
total_size: 2265124132, bsize: 2265124132, ratio: 2.0
2265124132 2 False
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 58.71176719665527 ms
CPU copy took 5278.865575790405 ms
---------------------- [PERF] Single Checkpoint time is 5.363238096237183 sec, average is 5.363233804702759
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 58.64834785461426 ms
CPU copy took 5166.183710098267 ms
---------------------- [PERF] Single Checkpoint time is 5.245366811752319 sec, average is 5.304298758506775
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 58.64286422729492 ms
CPU copy took 3573.6680030822754 ms
---------------------- [PERF] Single Checkpoint time is 3.6528677940368652 sec, average is 5.245363712310791
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 58.64548683166504 ms
CPU copy took 3605.626106262207 ms
---------------------- [PERF] Single Checkpoint time is 3.6949329376220703 sec, average is 4.470147013664246
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 58.64357948303223 ms
CPU copy took 3760.401964187622 ms
---------------------- [PERF] Single Checkpoint time is 3.839599370956421 sec, average is 3.8395962715148926
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 58.646440505981445 ms
CPU copy took 3414.936065673828 ms
---------------------- [PERF] Single Checkpoint time is 3.494142532348633 sec, average is 3.7672632932662964
---- exit
PR_ADDR_DATA is 0x400a7c350000, PR_ADDR is 0x400a7c0d0000, PEER_CHECK_ADDR is 0x400a7c150000
--------------- init enqueue: 0
--------------- init enqueue: 1
Call dram.alloc, num_batches is 2, batch_size_floats is 2265124132
------------------------- is_distributed is 0, rank is 0
Parall_iter 0, Write new metadata at address 0x400a7c250000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 94, parall_iter is 0, num_threads is 1, last counter is 0, curr_counter is 1
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400a7c350000, curr_pr_arr is 0x400a7c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x400a7c350000!
Thread ID: 1, savenvm_thread_nd took 5198.980011 ms
Thread ID: 1, set_cpu took 0.087101 ms
Threads took 5199.294176 ms
MSYNC 9060496528 TOOK 72.829850 ms
CAS was successful! new counter is 1, is_distributed is 0
******** checkp_info saved in 0x400a7c250000, curr_checkpoint is 0x400a7c250000
0, 1
Parall_iter 1, Write new metadata at address 0x400a7c2d0000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 10, parall_iter is 1, num_threads is 1, last counter is 1, curr_counter is 2
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400c98420000, curr_pr_arr is 0x400c98420000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x400c98420000!
Thread ID: 2, savenvm_thread_nd took 5086.794216 ms
Thread ID: 2, set_cpu took 0.089213 ms
Threads took 5087.034753 ms
MSYNC 9060496528 TOOK 72.564131 ms
CAS was successful! new counter is 2, is_distributed is 0
******** checkp_info saved in 0x400a7c2d0000, curr_checkpoint is 0x400a7c2d0000
1, 2
Parall_iter 0, Write new metadata at address 0x400a7c250000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 34, parall_iter is 0, num_threads is 1, last counter is 2, curr_counter is 3
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400a7c350000, curr_pr_arr is 0x400a7c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x400a7c350000!
Thread ID: 1, savenvm_thread_nd took 2729.487467 ms
Thread ID: 1, set_cpu took 0.090781 ms
Threads took 2729.731010 ms
MSYNC 9060496528 TOOK 838.264106 ms
CAS was successful! new counter is 3, is_distributed is 0
******** checkp_info saved in 0x400a7c250000, curr_checkpoint is 0x400a7c250000
0, 3
Parall_iter 1, Write new metadata at address 0x400a7c2d0000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 98, parall_iter is 1, num_threads is 1, last counter is 3, curr_counter is 4
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400c98420000, curr_pr_arr is 0x400c98420000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x400c98420000!
Thread ID: 2, savenvm_thread_nd took 2738.573349 ms
Thread ID: 2, set_cpu took 0.080029 ms
Threads took 2738.802110 ms
MSYNC 9060496528 TOOK 860.910948 ms
CAS was successful! new counter is 4, is_distributed is 0
******** checkp_info saved in 0x400a7c2d0000, curr_checkpoint is 0x400a7c2d0000
1, 4
Parall_iter 0, Write new metadata at address 0x400a7c250000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 122, parall_iter is 0, num_threads is 1, last counter is 4, curr_counter is 5
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400a7c350000, curr_pr_arr is 0x400a7c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x400a7c350000!
Thread ID: 1, savenvm_thread_nd took 2889.345515 ms
Thread ID: 1, set_cpu took 0.079645 ms
Threads took 2889.579299 ms
MSYNC 9060496528 TOOK 863.570186 ms
CAS was successful! new counter is 5, is_distributed is 0
******** checkp_info saved in 0x400a7c250000, curr_checkpoint is 0x400a7c250000
0, 5
Parall_iter 1, Write new metadata at address 0x400a7c2d0000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 39, parall_iter is 1, num_threads is 1, last counter is 5, curr_counter is 6
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400c98420000, curr_pr_arr is 0x400c98420000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x400c98420000!
Thread ID: 2, savenvm_thread_nd took 2626.809693 ms
Thread ID: 2, set_cpu took 0.079741 ms
Threads took 2627.034549 ms
MSYNC 9060496528 TOOK 782.148066 ms
CAS was successful! new counter is 6, is_distributed is 0
******** checkp_info saved in 0x400a7c2d0000, curr_checkpoint is 0x400a7c2d0000
1, 6
2025-05-23 01:08:39,183 - root - INFO - Training completed
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
0, 3, 0
1, 4, 3
max_piter is 1
Writing offset is 52080, parall_iter_offset is 2265137152
data_offset is 9063170048
