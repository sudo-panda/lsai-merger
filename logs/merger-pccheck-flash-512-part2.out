2025-05-23 01:25:50,552 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=512, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=1000, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, seed=4, checkpoint_dir='/iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts', loss_file='/iopsstor/scratch/cscs/bkundu/lsai-merger/results/bf16/loss-pccheck-flash-512-part2.csv', checkpoint_freq=100, max_async=1, warmup=3, load_checkpoint=True, non_blocking=False)
2025-05-23 01:25:50,557 - root - INFO - Random state checkpoint loaded from /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:25:50,557 - root - INFO - Training will resume from step: 400
2025-05-23 01:25:50,557 - root - INFO - Setting up DataLoaders...
2025-05-23 01:25:51,288 - root - INFO - Setting up Model...
2025-05-23 01:25:56,930 - root - INFO - Loading checkpoint model, optimizer + scheduler
/iopsstor/scratch/cscs/bkundu/lsai-merger/LSAI-Checkpointing/training/utils.py:85: UserWarning: The given buffer is not writable, and PyTorch does not support non-writable tensors. This means you can write to the underlying (supposedly non-writable) buffer using the tensor. You may want to copy the buffer to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at /opt/pytorch/pytorch/torch/csrc/utils/tensor_new.cpp:1561.)
  data = torch.frombuffer(payload, dtype=torch.float32)
2025-05-23 01:25:58,288 - root - INFO - Checkpoint loaded from /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/checkpoint_pccheck.pt
2025-05-23 01:25:58,298 - root - INFO - Loaded optimizer, scheduler checkpoint at step 400 in 1.36 seconds
Model size: 255885824, Optimizer size: 511771940, Total size: 767657764
BSIZE IS 767657764
At checkpoint, bsize is 767657764
2025-05-23 01:26:03,827 - root - INFO - Checkpointing warmup done
2025-05-23 01:26:03,831 - root - INFO - ------------------------------------------------------------Starting training!
2025-05-23 01:26:04,700 - root - INFO - Step: 405 | Loss: 11.82 | Tokens per second: 2948.38 | Training tokens per second (%): 76.80 | MFU (%): 0.37 | TFLOPs: 3.64 | Fwd time: 0.0362723 | Bck time: 0.0499784
2025-05-23 01:26:05,320 - root - INFO - Step: 410 | Loss: 11.77 | Tokens per second: 4132.26 | Training tokens per second (%): 94.88 | MFU (%): 0.52 | TFLOPs: 5.10 | Fwd time: 0.0353013 | Bck time: 0.0499092
2025-05-23 01:26:05,953 - root - INFO - Step: 415 | Loss: 11.84 | Tokens per second: 4051.13 | Training tokens per second (%): 86.99 | MFU (%): 0.51 | TFLOPs: 5.00 | Fwd time: 0.0361328 | Bck time: 0.0503471
2025-05-23 01:26:06,572 - root - INFO - Step: 420 | Loss: 11.72 | Tokens per second: 4140.10 | Training tokens per second (%): 72.15 | MFU (%): 0.52 | TFLOPs: 5.11 | Fwd time: 0.0353348 | Bck time: 0.0498627
2025-05-23 01:26:07,193 - root - INFO - Step: 425 | Loss: 11.80 | Tokens per second: 4127.62 | Training tokens per second (%): 69.69 | MFU (%): 0.51 | TFLOPs: 5.09 | Fwd time: 0.0359853 | Bck time: 0.0495912
2025-05-23 01:26:07,817 - root - INFO - Step: 430 | Loss: 11.84 | Tokens per second: 4103.19 | Training tokens per second (%): 95.20 | MFU (%): 0.51 | TFLOPs: 5.06 | Fwd time: 0.0359703 | Bck time: 0.0491182
2025-05-23 01:26:08,463 - root - INFO - Step: 435 | Loss: 11.77 | Tokens per second: 3966.36 | Training tokens per second (%): 98.67 | MFU (%): 0.49 | TFLOPs: 4.89 | Fwd time: 0.0372964 | Bck time: 0.0510073
2025-05-23 01:26:09,086 - root - INFO - Step: 440 | Loss: 11.74 | Tokens per second: 4117.81 | Training tokens per second (%): 83.01 | MFU (%): 0.51 | TFLOPs: 5.08 | Fwd time: 0.0359488 | Bck time: 0.0501725
2025-05-23 01:26:09,715 - root - INFO - Step: 445 | Loss: 11.70 | Tokens per second: 4074.48 | Training tokens per second (%): 79.30 | MFU (%): 0.51 | TFLOPs: 5.03 | Fwd time: 0.0357797 | Bck time: 0.0502232
2025-05-23 01:26:10,342 - root - INFO - Step: 450 | Loss: 11.78 | Tokens per second: 4083.06 | Training tokens per second (%): 92.34 | MFU (%): 0.51 | TFLOPs: 5.04 | Fwd time: 0.0352065 | Bck time: 0.0495188
2025-05-23 01:26:10,981 - root - INFO - Step: 455 | Loss: 11.72 | Tokens per second: 4016.42 | Training tokens per second (%): 92.58 | MFU (%): 0.50 | TFLOPs: 4.95 | Fwd time: 0.0362039 | Bck time: 0.0503666
2025-05-23 01:26:11,601 - root - INFO - Step: 460 | Loss: 11.73 | Tokens per second: 4132.58 | Training tokens per second (%): 93.32 | MFU (%): 0.52 | TFLOPs: 5.10 | Fwd time: 0.0356452 | Bck time: 0.0502721
2025-05-23 01:26:12,255 - root - INFO - Step: 465 | Loss: 11.71 | Tokens per second: 3918.37 | Training tokens per second (%): 90.66 | MFU (%): 0.49 | TFLOPs: 4.83 | Fwd time: 0.0368000 | Bck time: 0.0508365
2025-05-23 01:26:12,888 - root - INFO - Step: 470 | Loss: 11.63 | Tokens per second: 4045.73 | Training tokens per second (%): 85.86 | MFU (%): 0.50 | TFLOPs: 4.99 | Fwd time: 0.0367102 | Bck time: 0.0505095
2025-05-23 01:26:13,523 - root - INFO - Step: 475 | Loss: 11.81 | Tokens per second: 4039.39 | Training tokens per second (%): 92.62 | MFU (%): 0.50 | TFLOPs: 4.98 | Fwd time: 0.0358596 | Bck time: 0.0509990
2025-05-23 01:26:14,154 - root - INFO - Step: 480 | Loss: 11.69 | Tokens per second: 4059.51 | Training tokens per second (%): 85.16 | MFU (%): 0.51 | TFLOPs: 5.01 | Fwd time: 0.0360622 | Bck time: 0.0507051
2025-05-23 01:26:14,778 - root - INFO - Step: 485 | Loss: 11.81 | Tokens per second: 4105.47 | Training tokens per second (%): 83.36 | MFU (%): 0.51 | TFLOPs: 5.06 | Fwd time: 0.0363352 | Bck time: 0.0503408
2025-05-23 01:26:15,404 - root - INFO - Step: 490 | Loss: 11.85 | Tokens per second: 4096.21 | Training tokens per second (%): 84.41 | MFU (%): 0.51 | TFLOPs: 5.05 | Fwd time: 0.0361523 | Bck time: 0.0506826
2025-05-23 01:26:16,038 - root - INFO - Step: 495 | Loss: 11.85 | Tokens per second: 4040.27 | Training tokens per second (%): 73.91 | MFU (%): 0.50 | TFLOPs: 4.98 | Fwd time: 0.0368014 | Bck time: 0.0514212
2025-05-23 01:26:16,684 - root - INFO - Step: 500 | Loss: 11.83 | Tokens per second: 3968.02 | Training tokens per second (%): 100.00 | MFU (%): 0.49 | TFLOPs: 4.89 | Fwd time: 0.0375018 | Bck time: 0.0512067
2025-05-23 01:26:17,671 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:26:17,677 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 01:26:18,384 - root - INFO - Step: 505 | Loss: 11.68 | Tokens per second: 1506.88 | Training tokens per second (%): 85.62 | MFU (%): 0.19 | TFLOPs: 1.86 | Fwd time: 0.0384594 | Bck time: 0.0526937
2025-05-23 01:26:19,027 - root - INFO - Step: 510 | Loss: 11.85 | Tokens per second: 3987.71 | Training tokens per second (%): 79.53 | MFU (%): 0.50 | TFLOPs: 4.92 | Fwd time: 0.0368093 | Bck time: 0.0498752
2025-05-23 01:26:19,667 - root - INFO - Step: 515 | Loss: 11.51 | Tokens per second: 4002.53 | Training tokens per second (%): 81.95 | MFU (%): 0.50 | TFLOPs: 4.94 | Fwd time: 0.0381293 | Bck time: 0.0503605
2025-05-23 01:26:20,305 - root - INFO - Step: 520 | Loss: 11.71 | Tokens per second: 4019.58 | Training tokens per second (%): 84.45 | MFU (%): 0.50 | TFLOPs: 4.96 | Fwd time: 0.0371970 | Bck time: 0.0503563
2025-05-23 01:26:20,939 - root - INFO - Step: 525 | Loss: 11.61 | Tokens per second: 4039.22 | Training tokens per second (%): 75.82 | MFU (%): 0.50 | TFLOPs: 4.98 | Fwd time: 0.0374058 | Bck time: 0.0496711
2025-05-23 01:26:21,568 - root - INFO - Step: 530 | Loss: 11.82 | Tokens per second: 4072.11 | Training tokens per second (%): 95.04 | MFU (%): 0.51 | TFLOPs: 5.02 | Fwd time: 0.0375941 | Bck time: 0.0493416
2025-05-23 01:26:22,229 - root - INFO - Step: 535 | Loss: 11.70 | Tokens per second: 3877.14 | Training tokens per second (%): 100.00 | MFU (%): 0.48 | TFLOPs: 4.78 | Fwd time: 0.0377325 | Bck time: 0.0501084
2025-05-23 01:26:22,884 - root - INFO - Step: 540 | Loss: 11.23 | Tokens per second: 3915.20 | Training tokens per second (%): 82.30 | MFU (%): 0.49 | TFLOPs: 4.83 | Fwd time: 0.0378668 | Bck time: 0.0501813
2025-05-23 01:26:23,537 - root - INFO - Step: 545 | Loss: 11.79 | Tokens per second: 3926.53 | Training tokens per second (%): 98.32 | MFU (%): 0.49 | TFLOPs: 4.84 | Fwd time: 0.0376436 | Bck time: 0.0496683
2025-05-23 01:26:24,172 - root - INFO - Step: 550 | Loss: 11.77 | Tokens per second: 4031.25 | Training tokens per second (%): 47.46 | MFU (%): 0.50 | TFLOPs: 4.97 | Fwd time: 0.0371580 | Bck time: 0.0502206
2025-05-23 01:26:24,812 - root - INFO - Step: 555 | Loss: 11.82 | Tokens per second: 4009.22 | Training tokens per second (%): 78.40 | MFU (%): 0.50 | TFLOPs: 4.94 | Fwd time: 0.0384672 | Bck time: 0.0503925
2025-05-23 01:26:25,455 - root - INFO - Step: 560 | Loss: 11.74 | Tokens per second: 3981.73 | Training tokens per second (%): 82.54 | MFU (%): 0.50 | TFLOPs: 4.91 | Fwd time: 0.0383917 | Bck time: 0.0506627
2025-05-23 01:26:26,091 - root - INFO - Step: 565 | Loss: 11.77 | Tokens per second: 4032.08 | Training tokens per second (%): 68.01 | MFU (%): 0.50 | TFLOPs: 4.97 | Fwd time: 0.0374308 | Bck time: 0.0502847
2025-05-23 01:26:26,727 - root - INFO - Step: 570 | Loss: 11.82 | Tokens per second: 4025.62 | Training tokens per second (%): 68.91 | MFU (%): 0.50 | TFLOPs: 4.96 | Fwd time: 0.0375917 | Bck time: 0.0504288
2025-05-23 01:26:27,362 - root - INFO - Step: 575 | Loss: 11.68 | Tokens per second: 4036.43 | Training tokens per second (%): 91.13 | MFU (%): 0.50 | TFLOPs: 4.98 | Fwd time: 0.0376144 | Bck time: 0.0503118
2025-05-23 01:26:28,002 - root - INFO - Step: 580 | Loss: 11.76 | Tokens per second: 4008.34 | Training tokens per second (%): 56.88 | MFU (%): 0.50 | TFLOPs: 4.94 | Fwd time: 0.0384301 | Bck time: 0.0509308
2025-05-23 01:26:28,639 - root - INFO - Step: 585 | Loss: 11.63 | Tokens per second: 4022.14 | Training tokens per second (%): 70.39 | MFU (%): 0.50 | TFLOPs: 4.96 | Fwd time: 0.0378116 | Bck time: 0.0492068
2025-05-23 01:26:29,272 - root - INFO - Step: 590 | Loss: 11.75 | Tokens per second: 4045.52 | Training tokens per second (%): 84.38 | MFU (%): 0.50 | TFLOPs: 4.99 | Fwd time: 0.0372470 | Bck time: 0.0498113
2025-05-23 01:26:29,910 - root - INFO - Step: 595 | Loss: 11.77 | Tokens per second: 4018.73 | Training tokens per second (%): 65.47 | MFU (%): 0.50 | TFLOPs: 4.96 | Fwd time: 0.0378583 | Bck time: 0.0508208
2025-05-23 01:26:30,548 - root - INFO - Step: 600 | Loss: 11.68 | Tokens per second: 4016.01 | Training tokens per second (%): 80.35 | MFU (%): 0.50 | TFLOPs: 4.95 | Fwd time: 0.0384780 | Bck time: 0.0507861
2025-05-23 01:26:31,652 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:26:31,654 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 01:26:32,353 - root - INFO - Step: 605 | Loss: 11.76 | Tokens per second: 1419.25 | Training tokens per second (%): 69.22 | MFU (%): 0.18 | TFLOPs: 1.75 | Fwd time: 0.0368762 | Bck time: 0.0521979
2025-05-23 01:26:32,997 - root - INFO - Step: 610 | Loss: 11.82 | Tokens per second: 3976.26 | Training tokens per second (%): 60.90 | MFU (%): 0.50 | TFLOPs: 4.90 | Fwd time: 0.0368165 | Bck time: 0.0505920
2025-05-23 01:26:33,632 - root - INFO - Step: 615 | Loss: 11.84 | Tokens per second: 4039.95 | Training tokens per second (%): 95.23 | MFU (%): 0.50 | TFLOPs: 4.98 | Fwd time: 0.0371440 | Bck time: 0.0491880
2025-05-23 01:26:34,439 - root - INFO - Step: 620 | Loss: 11.62 | Tokens per second: 3172.95 | Training tokens per second (%): 72.07 | MFU (%): 0.40 | TFLOPs: 3.91 | Fwd time: 0.0409355 | Bck time: 0.0503141
2025-05-23 01:26:35,085 - root - INFO - Step: 625 | Loss: 11.74 | Tokens per second: 3968.29 | Training tokens per second (%): 91.09 | MFU (%): 0.49 | TFLOPs: 4.89 | Fwd time: 0.0379264 | Bck time: 0.0494998
2025-05-23 01:26:35,705 - root - INFO - Step: 630 | Loss: 11.68 | Tokens per second: 4134.53 | Training tokens per second (%): 89.22 | MFU (%): 0.52 | TFLOPs: 5.10 | Fwd time: 0.0365926 | Bck time: 0.0498018
2025-05-23 01:26:36,337 - root - INFO - Step: 635 | Loss: 11.85 | Tokens per second: 4056.21 | Training tokens per second (%): 91.45 | MFU (%): 0.51 | TFLOPs: 5.00 | Fwd time: 0.0372314 | Bck time: 0.0502257
2025-05-23 01:26:36,971 - root - INFO - Step: 640 | Loss: 11.74 | Tokens per second: 4041.15 | Training tokens per second (%): 84.26 | MFU (%): 0.50 | TFLOPs: 4.98 | Fwd time: 0.0371841 | Bck time: 0.0500915
2025-05-23 01:26:37,603 - root - INFO - Step: 645 | Loss: 11.68 | Tokens per second: 4055.75 | Training tokens per second (%): 69.41 | MFU (%): 0.51 | TFLOPs: 5.00 | Fwd time: 0.0371133 | Bck time: 0.0505068
2025-05-23 01:26:38,254 - root - INFO - Step: 650 | Loss: 11.50 | Tokens per second: 3934.24 | Training tokens per second (%): 97.15 | MFU (%): 0.49 | TFLOPs: 4.85 | Fwd time: 0.0383722 | Bck time: 0.0502986
2025-05-23 01:26:38,898 - root - INFO - Step: 655 | Loss: 11.72 | Tokens per second: 3980.56 | Training tokens per second (%): 71.37 | MFU (%): 0.50 | TFLOPs: 4.91 | Fwd time: 0.0377013 | Bck time: 0.0500765
2025-05-23 01:26:39,533 - root - INFO - Step: 660 | Loss: 11.69 | Tokens per second: 4035.52 | Training tokens per second (%): 82.23 | MFU (%): 0.50 | TFLOPs: 4.98 | Fwd time: 0.0380440 | Bck time: 0.0501852
2025-05-23 01:26:40,173 - root - INFO - Step: 665 | Loss: 11.76 | Tokens per second: 4004.21 | Training tokens per second (%): 81.80 | MFU (%): 0.50 | TFLOPs: 4.94 | Fwd time: 0.0372206 | Bck time: 0.0490091
2025-05-23 01:26:40,807 - root - INFO - Step: 670 | Loss: 11.53 | Tokens per second: 4042.96 | Training tokens per second (%): 87.62 | MFU (%): 0.50 | TFLOPs: 4.99 | Fwd time: 0.0370759 | Bck time: 0.0494612
2025-05-23 01:26:41,438 - root - INFO - Step: 675 | Loss: 11.60 | Tokens per second: 4064.18 | Training tokens per second (%): 67.54 | MFU (%): 0.51 | TFLOPs: 5.01 | Fwd time: 0.0376496 | Bck time: 0.0499516
2025-05-23 01:26:42,078 - root - INFO - Step: 680 | Loss: 11.61 | Tokens per second: 4000.42 | Training tokens per second (%): 77.38 | MFU (%): 0.50 | TFLOPs: 4.93 | Fwd time: 0.0383998 | Bck time: 0.0496964
2025-05-23 01:26:42,708 - root - INFO - Step: 685 | Loss: 11.69 | Tokens per second: 4068.62 | Training tokens per second (%): 86.37 | MFU (%): 0.51 | TFLOPs: 5.02 | Fwd time: 0.0370423 | Bck time: 0.0500222
2025-05-23 01:26:43,339 - root - INFO - Step: 690 | Loss: 11.64 | Tokens per second: 4066.53 | Training tokens per second (%): 58.55 | MFU (%): 0.51 | TFLOPs: 5.02 | Fwd time: 0.0374668 | Bck time: 0.0497881
2025-05-23 01:26:43,985 - root - INFO - Step: 695 | Loss: 11.64 | Tokens per second: 3966.38 | Training tokens per second (%): 88.95 | MFU (%): 0.49 | TFLOPs: 4.89 | Fwd time: 0.0369717 | Bck time: 0.0505839
2025-05-23 01:26:44,612 - root - INFO - Step: 700 | Loss: 11.60 | Tokens per second: 4086.55 | Training tokens per second (%): 78.91 | MFU (%): 0.51 | TFLOPs: 5.04 | Fwd time: 0.0357148 | Bck time: 0.0501912
2025-05-23 01:26:45,633 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:26:45,636 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 01:26:46,288 - root - INFO - Step: 705 | Loss: 11.70 | Tokens per second: 1528.28 | Training tokens per second (%): 87.07 | MFU (%): 0.19 | TFLOPs: 1.88 | Fwd time: 0.0361787 | Bck time: 0.0491757
2025-05-23 01:26:46,916 - root - INFO - Step: 710 | Loss: 11.78 | Tokens per second: 4076.98 | Training tokens per second (%): 100.00 | MFU (%): 0.51 | TFLOPs: 5.03 | Fwd time: 0.0369662 | Bck time: 0.0491890
2025-05-23 01:26:47,547 - root - INFO - Step: 715 | Loss: 11.55 | Tokens per second: 4064.31 | Training tokens per second (%): 74.26 | MFU (%): 0.51 | TFLOPs: 5.01 | Fwd time: 0.0357193 | Bck time: 0.0501092
2025-05-23 01:26:48,166 - root - INFO - Step: 720 | Loss: 11.42 | Tokens per second: 4138.88 | Training tokens per second (%): 81.05 | MFU (%): 0.52 | TFLOPs: 5.10 | Fwd time: 0.0365303 | Bck time: 0.0499155
2025-05-23 01:26:48,781 - root - INFO - Step: 725 | Loss: 11.61 | Tokens per second: 4169.77 | Training tokens per second (%): 61.80 | MFU (%): 0.52 | TFLOPs: 5.14 | Fwd time: 0.0354549 | Bck time: 0.0492029
2025-05-23 01:26:49,394 - root - INFO - Step: 730 | Loss: 11.61 | Tokens per second: 4175.75 | Training tokens per second (%): 77.11 | MFU (%): 0.52 | TFLOPs: 5.15 | Fwd time: 0.0360571 | Bck time: 0.0495601
2025-05-23 01:26:50,008 - root - INFO - Step: 735 | Loss: 11.58 | Tokens per second: 4176.47 | Training tokens per second (%): 59.10 | MFU (%): 0.52 | TFLOPs: 5.15 | Fwd time: 0.0353627 | Bck time: 0.0493758
2025-05-23 01:26:50,634 - root - INFO - Step: 740 | Loss: 11.67 | Tokens per second: 4096.29 | Training tokens per second (%): 86.37 | MFU (%): 0.51 | TFLOPs: 5.05 | Fwd time: 0.0374684 | Bck time: 0.0496722
2025-05-23 01:26:51,250 - root - INFO - Step: 745 | Loss: 11.73 | Tokens per second: 4156.31 | Training tokens per second (%): 51.52 | MFU (%): 0.52 | TFLOPs: 5.13 | Fwd time: 0.0357086 | Bck time: 0.0494909
2025-05-23 01:26:51,874 - root - INFO - Step: 750 | Loss: 11.79 | Tokens per second: 4108.09 | Training tokens per second (%): 96.09 | MFU (%): 0.51 | TFLOPs: 5.07 | Fwd time: 0.0365354 | Bck time: 0.0499589
2025-05-23 01:26:52,496 - root - INFO - Step: 755 | Loss: 11.64 | Tokens per second: 4125.02 | Training tokens per second (%): 94.22 | MFU (%): 0.51 | TFLOPs: 5.09 | Fwd time: 0.0355872 | Bck time: 0.0496008
2025-05-23 01:26:53,124 - root - INFO - Step: 760 | Loss: 11.72 | Tokens per second: 4079.73 | Training tokens per second (%): 94.06 | MFU (%): 0.51 | TFLOPs: 5.03 | Fwd time: 0.0368576 | Bck time: 0.0500256
2025-05-23 01:26:53,761 - root - INFO - Step: 765 | Loss: 11.58 | Tokens per second: 4023.14 | Training tokens per second (%): 100.00 | MFU (%): 0.50 | TFLOPs: 4.96 | Fwd time: 0.0367162 | Bck time: 0.0501988
2025-05-23 01:26:54,384 - root - INFO - Step: 770 | Loss: 11.59 | Tokens per second: 4113.30 | Training tokens per second (%): 90.94 | MFU (%): 0.51 | TFLOPs: 5.07 | Fwd time: 0.0360358 | Bck time: 0.0497360
2025-05-23 01:26:55,011 - root - INFO - Step: 775 | Loss: 11.55 | Tokens per second: 4087.56 | Training tokens per second (%): 69.57 | MFU (%): 0.51 | TFLOPs: 5.04 | Fwd time: 0.0352135 | Bck time: 0.0493107
2025-05-23 01:26:55,628 - root - INFO - Step: 780 | Loss: 11.81 | Tokens per second: 4153.14 | Training tokens per second (%): 83.36 | MFU (%): 0.52 | TFLOPs: 5.12 | Fwd time: 0.0363399 | Bck time: 0.0499061
2025-05-23 01:26:56,249 - root - INFO - Step: 785 | Loss: 11.71 | Tokens per second: 4123.84 | Training tokens per second (%): 90.78 | MFU (%): 0.51 | TFLOPs: 5.09 | Fwd time: 0.0355843 | Bck time: 0.0492679
2025-05-23 01:26:56,873 - root - INFO - Step: 790 | Loss: 11.60 | Tokens per second: 4108.12 | Training tokens per second (%): 95.66 | MFU (%): 0.51 | TFLOPs: 5.07 | Fwd time: 0.0367777 | Bck time: 0.0493955
2025-05-23 01:26:57,524 - root - INFO - Step: 795 | Loss: 11.62 | Tokens per second: 3939.10 | Training tokens per second (%): 96.05 | MFU (%): 0.49 | TFLOPs: 4.86 | Fwd time: 0.0381150 | Bck time: 0.0507561
2025-05-23 01:26:58,159 - root - INFO - Step: 800 | Loss: 11.54 | Tokens per second: 4034.40 | Training tokens per second (%): 81.48 | MFU (%): 0.50 | TFLOPs: 4.98 | Fwd time: 0.0377831 | Bck time: 0.0501353
2025-05-23 01:26:59,523 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:26:59,537 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 01:27:00,212 - root - INFO - Step: 805 | Loss: 11.65 | Tokens per second: 1247.53 | Training tokens per second (%): 89.49 | MFU (%): 0.16 | TFLOPs: 1.54 | Fwd time: 0.0362337 | Bck time: 0.0501005
2025-05-23 01:27:00,834 - root - INFO - Step: 810 | Loss: 11.69 | Tokens per second: 4122.59 | Training tokens per second (%): 85.59 | MFU (%): 0.51 | TFLOPs: 5.08 | Fwd time: 0.0361715 | Bck time: 0.0497917
2025-05-23 01:27:01,456 - root - INFO - Step: 815 | Loss: 11.75 | Tokens per second: 4114.61 | Training tokens per second (%): 83.44 | MFU (%): 0.51 | TFLOPs: 5.07 | Fwd time: 0.0357568 | Bck time: 0.0481941
2025-05-23 01:27:02,071 - root - INFO - Step: 820 | Loss: 11.61 | Tokens per second: 4168.30 | Training tokens per second (%): 83.44 | MFU (%): 0.52 | TFLOPs: 5.14 | Fwd time: 0.0371132 | Bck time: 0.0490535
2025-05-23 01:27:02,698 - root - INFO - Step: 825 | Loss: 11.66 | Tokens per second: 4090.43 | Training tokens per second (%): 99.26 | MFU (%): 0.51 | TFLOPs: 5.04 | Fwd time: 0.0357433 | Bck time: 0.0496280
2025-05-23 01:27:03,318 - root - INFO - Step: 830 | Loss: 11.73 | Tokens per second: 4132.19 | Training tokens per second (%): 80.31 | MFU (%): 0.52 | TFLOPs: 5.10 | Fwd time: 0.0360895 | Bck time: 0.0491307
2025-05-23 01:27:03,931 - root - INFO - Step: 835 | Loss: 11.70 | Tokens per second: 4178.94 | Training tokens per second (%): 73.05 | MFU (%): 0.52 | TFLOPs: 5.15 | Fwd time: 0.0358946 | Bck time: 0.0493457
2025-05-23 01:27:04,540 - root - INFO - Step: 840 | Loss: 11.67 | Tokens per second: 4209.85 | Training tokens per second (%): 68.44 | MFU (%): 0.52 | TFLOPs: 5.19 | Fwd time: 0.0362710 | Bck time: 0.0480979
2025-05-23 01:27:05,157 - root - INFO - Step: 845 | Loss: 11.71 | Tokens per second: 4154.26 | Training tokens per second (%): 79.84 | MFU (%): 0.52 | TFLOPs: 5.12 | Fwd time: 0.0363944 | Bck time: 0.0492491
2025-05-23 01:27:05,777 - root - INFO - Step: 850 | Loss: 11.45 | Tokens per second: 4136.54 | Training tokens per second (%): 79.77 | MFU (%): 0.52 | TFLOPs: 5.10 | Fwd time: 0.0367553 | Bck time: 0.0495278
2025-05-23 01:27:06,410 - root - INFO - Step: 855 | Loss: 11.68 | Tokens per second: 4047.86 | Training tokens per second (%): 96.60 | MFU (%): 0.50 | TFLOPs: 4.99 | Fwd time: 0.0364236 | Bck time: 0.0497515
2025-05-23 01:27:07,027 - root - INFO - Step: 860 | Loss: 11.71 | Tokens per second: 4156.26 | Training tokens per second (%): 61.33 | MFU (%): 0.52 | TFLOPs: 5.13 | Fwd time: 0.0364012 | Bck time: 0.0490948
2025-05-23 01:27:07,643 - root - INFO - Step: 865 | Loss: 11.34 | Tokens per second: 4158.34 | Training tokens per second (%): 89.69 | MFU (%): 0.52 | TFLOPs: 5.13 | Fwd time: 0.0363056 | Bck time: 0.0493342
2025-05-23 01:27:08,271 - root - INFO - Step: 870 | Loss: 11.56 | Tokens per second: 4081.90 | Training tokens per second (%): 93.95 | MFU (%): 0.51 | TFLOPs: 5.03 | Fwd time: 0.0364589 | Bck time: 0.0492506
2025-05-23 01:27:08,894 - root - INFO - Step: 875 | Loss: 11.56 | Tokens per second: 4111.66 | Training tokens per second (%): 65.86 | MFU (%): 0.51 | TFLOPs: 5.07 | Fwd time: 0.0354853 | Bck time: 0.0498187
2025-05-23 01:27:09,519 - root - INFO - Step: 880 | Loss: 11.81 | Tokens per second: 4100.86 | Training tokens per second (%): 92.27 | MFU (%): 0.51 | TFLOPs: 5.06 | Fwd time: 0.0362171 | Bck time: 0.0498103
2025-05-23 01:27:10,149 - root - INFO - Step: 885 | Loss: 11.55 | Tokens per second: 4066.94 | Training tokens per second (%): 88.20 | MFU (%): 0.51 | TFLOPs: 5.02 | Fwd time: 0.0362456 | Bck time: 0.0491737
2025-05-23 01:27:10,773 - root - INFO - Step: 890 | Loss: 11.56 | Tokens per second: 4106.92 | Training tokens per second (%): 90.27 | MFU (%): 0.51 | TFLOPs: 5.07 | Fwd time: 0.0367029 | Bck time: 0.0493445
2025-05-23 01:27:11,393 - root - INFO - Step: 895 | Loss: 11.76 | Tokens per second: 4136.76 | Training tokens per second (%): 82.42 | MFU (%): 0.52 | TFLOPs: 5.10 | Fwd time: 0.0360289 | Bck time: 0.0491559
2025-05-23 01:27:12,014 - root - INFO - Step: 900 | Loss: 11.61 | Tokens per second: 4125.78 | Training tokens per second (%): 72.77 | MFU (%): 0.51 | TFLOPs: 5.09 | Fwd time: 0.0360469 | Bck time: 0.0493754
2025-05-23 01:27:13,082 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:27:13,092 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 01:27:13,758 - root - INFO - Step: 905 | Loss: 11.75 | Tokens per second: 1468.62 | Training tokens per second (%): 64.02 | MFU (%): 0.18 | TFLOPs: 1.81 | Fwd time: 0.0363494 | Bck time: 0.0494400
2025-05-23 01:27:14,386 - root - INFO - Step: 910 | Loss: 11.39 | Tokens per second: 4076.77 | Training tokens per second (%): 91.95 | MFU (%): 0.51 | TFLOPs: 5.03 | Fwd time: 0.0366513 | Bck time: 0.0505976
2025-05-23 01:27:15,006 - root - INFO - Step: 915 | Loss: 11.62 | Tokens per second: 4134.47 | Training tokens per second (%): 78.75 | MFU (%): 0.52 | TFLOPs: 5.10 | Fwd time: 0.0354404 | Bck time: 0.0497376
2025-05-23 01:27:15,627 - root - INFO - Step: 920 | Loss: 11.74 | Tokens per second: 4128.13 | Training tokens per second (%): 99.73 | MFU (%): 0.51 | TFLOPs: 5.09 | Fwd time: 0.0358177 | Bck time: 0.0495640
2025-05-23 01:27:16,251 - root - INFO - Step: 925 | Loss: 11.57 | Tokens per second: 4110.46 | Training tokens per second (%): 62.85 | MFU (%): 0.51 | TFLOPs: 5.07 | Fwd time: 0.0366854 | Bck time: 0.0500066
2025-05-23 01:27:16,878 - root - INFO - Step: 930 | Loss: 11.61 | Tokens per second: 4082.42 | Training tokens per second (%): 84.69 | MFU (%): 0.51 | TFLOPs: 5.03 | Fwd time: 0.0366050 | Bck time: 0.0497200
2025-05-23 01:27:17,497 - root - INFO - Step: 935 | Loss: 11.68 | Tokens per second: 4145.46 | Training tokens per second (%): 90.55 | MFU (%): 0.52 | TFLOPs: 5.11 | Fwd time: 0.0357679 | Bck time: 0.0497512
2025-05-23 01:27:18,115 - root - INFO - Step: 940 | Loss: 11.48 | Tokens per second: 4147.00 | Training tokens per second (%): 97.46 | MFU (%): 0.52 | TFLOPs: 5.11 | Fwd time: 0.0364635 | Bck time: 0.0495939
2025-05-23 01:27:18,739 - root - INFO - Step: 945 | Loss: 11.57 | Tokens per second: 4102.59 | Training tokens per second (%): 82.30 | MFU (%): 0.51 | TFLOPs: 5.06 | Fwd time: 0.0357150 | Bck time: 0.0497815
2025-05-23 01:27:19,380 - root - INFO - Step: 950 | Loss: 11.52 | Tokens per second: 4001.94 | Training tokens per second (%): 83.75 | MFU (%): 0.50 | TFLOPs: 4.94 | Fwd time: 0.0366653 | Bck time: 0.0481994
2025-05-23 01:27:19,998 - root - INFO - Step: 955 | Loss: 11.52 | Tokens per second: 4147.04 | Training tokens per second (%): 72.66 | MFU (%): 0.52 | TFLOPs: 5.11 | Fwd time: 0.0357538 | Bck time: 0.0496811
2025-05-23 01:27:20,630 - root - INFO - Step: 960 | Loss: 11.72 | Tokens per second: 4056.35 | Training tokens per second (%): 86.52 | MFU (%): 0.51 | TFLOPs: 5.00 | Fwd time: 0.0365709 | Bck time: 0.0501455
2025-05-23 01:27:21,254 - root - INFO - Step: 965 | Loss: 11.71 | Tokens per second: 4105.34 | Training tokens per second (%): 77.11 | MFU (%): 0.51 | TFLOPs: 5.06 | Fwd time: 0.0364616 | Bck time: 0.0496850
2025-05-23 01:27:21,873 - root - INFO - Step: 970 | Loss: 11.67 | Tokens per second: 4140.06 | Training tokens per second (%): 59.96 | MFU (%): 0.52 | TFLOPs: 5.11 | Fwd time: 0.0365951 | Bck time: 0.0494510
2025-05-23 01:27:22,495 - root - INFO - Step: 975 | Loss: 11.29 | Tokens per second: 4117.61 | Training tokens per second (%): 84.57 | MFU (%): 0.51 | TFLOPs: 5.08 | Fwd time: 0.0358412 | Bck time: 0.0494978
2025-05-23 01:27:23,149 - root - INFO - Step: 980 | Loss: 11.77 | Tokens per second: 3920.53 | Training tokens per second (%): 93.05 | MFU (%): 0.49 | TFLOPs: 4.84 | Fwd time: 0.0369816 | Bck time: 0.0508040
2025-05-23 01:27:23,775 - root - INFO - Step: 985 | Loss: 11.65 | Tokens per second: 4093.53 | Training tokens per second (%): 93.44 | MFU (%): 0.51 | TFLOPs: 5.05 | Fwd time: 0.0365135 | Bck time: 0.0500941
2025-05-23 01:27:24,397 - root - INFO - Step: 990 | Loss: 11.78 | Tokens per second: 4118.25 | Training tokens per second (%): 76.68 | MFU (%): 0.51 | TFLOPs: 5.08 | Fwd time: 0.0362290 | Bck time: 0.0496114
2025-05-23 01:27:25,040 - root - INFO - Step: 995 | Loss: 11.78 | Tokens per second: 3989.61 | Training tokens per second (%): 76.60 | MFU (%): 0.50 | TFLOPs: 4.92 | Fwd time: 0.0357981 | Bck time: 0.0497501
2025-05-23 01:27:25,661 - root - INFO - Step: 1000 | Loss: 11.46 | Tokens per second: 4123.26 | Training tokens per second (%): 96.80 | MFU (%): 0.51 | TFLOPs: 5.09 | Fwd time: 0.0366088 | Bck time: 0.0502076
2025-05-23 01:27:26,732 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:27:26,740 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
total_size: 767657764, bsize: 767657764, ratio: 2.0
767657764 2 False
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 23.37479591369629 ms
CPU copy took 1665.4150485992432 ms
---------------------- [PERF] Single Checkpoint time is 1.709409475326538 sec, average is 1.7094058990478516
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 23.235797882080078 ms
CPU copy took 2100.73184967041 ms
---------------------- [PERF] Single Checkpoint time is 2.154578924179077 sec, average is 1.9319911003112793
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 23.23460578918457 ms
CPU copy took 1574.5923519134521 ms
---------------------- [PERF] Single Checkpoint time is 1.6233317852020264 sec, average is 1.7094058990478516
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 23.21934700012207 ms
CPU copy took 1746.7598915100098 ms
---------------------- [PERF] Single Checkpoint time is 1.795461654663086 sec, average is 1.752433180809021
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 23.227214813232422 ms
CPU copy took 2713.139533996582 ms
---------------------- [PERF] Single Checkpoint time is 2.761850357055664 sec, average is 1.7954604625701904
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 23.2236385345459 ms
CPU copy took 2555.068254470825 ms
---------------------- [PERF] Single Checkpoint time is 2.583627939224243 sec, average is 1.9750183820724487
---- exit
PR_ADDR_DATA is 0x4006772f0000, PR_ADDR is 0x400677070000, PEER_CHECK_ADDR is 0x4006770f0000
--------------- init enqueue: 0
--------------- init enqueue: 1
Call dram.alloc, num_batches is 2, batch_size_floats is 767657764
------------------------- is_distributed is 0, rank is 0
Parall_iter 0, Write new metadata at address 0x4006771f0000
------------------------- savenvmNew, is_distributed is 0, total_size is 767657764
At savenvmNew, tid is 107, parall_iter is 0, num_threads is 1, last counter is 0, curr_counter is 1
Writing offset is 58224, parall_iter_offset is 0
start_pr_arr is 0x4006772f0000, curr_pr_arr is 0x4006772f0000, batch_size is 767657764, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 767657764
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 767657764, start addr is 0x4006772f0000!
Thread ID: 1, savenvm_thread_nd took 1600.255529 ms
Thread ID: 1, set_cpu took 0.078206 ms
Threads took 1600.511553 ms
MSYNC 3070631056 TOOK 58.405233 ms
CAS was successful! new counter is 1, is_distributed is 0
******** checkp_info saved in 0x4006771f0000, curr_checkpoint is 0x4006771f0000
0, 1
Parall_iter 1, Write new metadata at address 0x400677270000
------------------------- savenvmNew, is_distributed is 0, total_size is 767657764
At savenvmNew, tid is 3, parall_iter is 1, num_threads is 1, last counter is 1, curr_counter is 2
Writing offset is 58224, parall_iter_offset is 767672320
start_pr_arr is 0x40072e360000, curr_pr_arr is 0x40072e360000, batch_size is 767657764, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 767657764
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 767657764, start addr is 0x40072e360000!
Thread ID: 2, savenvm_thread_nd took 1968.448219 ms
Thread ID: 2, set_cpu took 0.079102 ms
Threads took 1968.662356 ms
MSYNC 3070631056 TOOK 126.436834 ms
CAS was successful! new counter is 2, is_distributed is 0
******** checkp_info saved in 0x400677270000, curr_checkpoint is 0x400677270000
1, 2
Parall_iter 0, Write new metadata at address 0x4006771f0000
------------------------- savenvmNew, is_distributed is 0, total_size is 767657764
At savenvmNew, tid is 66, parall_iter is 0, num_threads is 1, last counter is 2, curr_counter is 3
Writing offset is 58224, parall_iter_offset is 0
start_pr_arr is 0x4006772f0000, curr_pr_arr is 0x4006772f0000, batch_size is 767657764, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 767657764
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 767657764, start addr is 0x4006772f0000!
Thread ID: 1, savenvm_thread_nd took 890.596072 ms
Thread ID: 1, set_cpu took 0.075038 ms
Threads took 890.804545 ms
MSYNC 3070631056 TOOK 677.874774 ms
CAS was successful! new counter is 3, is_distributed is 0
******** checkp_info saved in 0x4006771f0000, curr_checkpoint is 0x4006771f0000
0, 3
Parall_iter 1, Write new metadata at address 0x400677270000
------------------------- savenvmNew, is_distributed is 0, total_size is 767657764
At savenvmNew, tid is 91, parall_iter is 1, num_threads is 1, last counter is 3, curr_counter is 4
Writing offset is 58224, parall_iter_offset is 767672320
start_pr_arr is 0x40072e360000, curr_pr_arr is 0x40072e360000, batch_size is 767657764, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 767657764
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 767657764, start addr is 0x40072e360000!
Thread ID: 2, savenvm_thread_nd took 887.459006 ms
Thread ID: 2, set_cpu took 0.077534 ms
Threads took 887.654265 ms
MSYNC 3070631056 TOOK 853.522962 ms
CAS was successful! new counter is 4, is_distributed is 0
******** checkp_info saved in 0x400677270000, curr_checkpoint is 0x400677270000
1, 4
Parall_iter 0, Write new metadata at address 0x4006771f0000
------------------------- savenvmNew, is_distributed is 0, total_size is 767657764
At savenvmNew, tid is 7, parall_iter is 0, num_threads is 1, last counter is 4, curr_counter is 5
Writing offset is 58224, parall_iter_offset is 0
start_pr_arr is 0x4006772f0000, curr_pr_arr is 0x4006772f0000, batch_size is 767657764, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 767657764
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 767657764, start addr is 0x4006772f0000!
Thread ID: 1, savenvm_thread_nd took 894.029275 ms
Thread ID: 1, set_cpu took 0.072190 ms
Threads took 894.225013 ms
MSYNC 3070631056 TOOK 1813.425858 ms
CAS was successful! new counter is 5, is_distributed is 0
******** checkp_info saved in 0x4006771f0000, curr_checkpoint is 0x4006771f0000
0, 5
Parall_iter 1, Write new metadata at address 0x400677270000
------------------------- savenvmNew, is_distributed is 0, total_size is 767657764
At savenvmNew, tid is 32, parall_iter is 1, num_threads is 1, last counter is 5, curr_counter is 6
Writing offset is 58224, parall_iter_offset is 767672320
start_pr_arr is 0x40072e360000, curr_pr_arr is 0x40072e360000, batch_size is 767657764, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 767657764
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 767657764, start addr is 0x40072e360000!
Thread ID: 2, savenvm_thread_nd took 893.256819 ms
Thread ID: 2, set_cpu took 0.075806 ms
Threads took 893.467468 ms
MSYNC 3070631056 TOOK 1661.050844 ms
CAS was successful! new counter is 6, is_distributed is 0
******** checkp_info saved in 0x400677270000, curr_checkpoint is 0x400677270000
1, 6
2025-05-23 01:27:28,986 - root - INFO - Training completed
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
0, 3, 0
1, 4, 3
max_piter is 1
Writing offset is 58224, parall_iter_offset is 767672320
data_offset is 3073310720
