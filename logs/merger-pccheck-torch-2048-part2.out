2025-05-23 00:53:05,170 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=2048, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=1000, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, seed=4, checkpoint_dir='/iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts', loss_file='/iopsstor/scratch/cscs/bkundu/lsai-merger/results/bf16/loss-pccheck-torch-2048-part2.csv', checkpoint_freq=100, max_async=1, warmup=3, load_checkpoint=True, non_blocking=False)
2025-05-23 00:53:05,175 - root - INFO - Random state checkpoint loaded from /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 00:53:05,175 - root - INFO - Training will resume from step: 400
2025-05-23 00:53:05,175 - root - INFO - Setting up DataLoaders...
2025-05-23 00:53:10,914 - root - INFO - Setting up Model...
2025-05-23 00:53:26,711 - root - INFO - Loading checkpoint model, optimizer + scheduler
/iopsstor/scratch/cscs/bkundu/lsai-merger/LSAI-Checkpointing/training/utils.py:85: UserWarning: The given buffer is not writable, and PyTorch does not support non-writable tensors. This means you can write to the underlying (supposedly non-writable) buffer using the tensor. You may want to copy the buffer to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at /opt/pytorch/pytorch/torch/csrc/utils/tensor_new.cpp:1561.)
  data = torch.frombuffer(payload, dtype=torch.float32)
2025-05-23 00:53:33,964 - root - INFO - Checkpoint loaded from /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/checkpoint_pccheck.pt
2025-05-23 00:53:34,019 - root - INFO - Loaded optimizer, scheduler checkpoint at step 400 in 7.29 seconds
Model size: 2281834496, Optimizer size: 4563669284, Total size: 6845503780
BSIZE IS 6845503780
At checkpoint, bsize is 6845503780
2025-05-23 00:53:45,587 - root - INFO - Checkpointing warmup done
2025-05-23 00:53:45,591 - root - INFO - ------------------------------------------------------------Starting training!
2025-05-23 00:53:47,485 - root - INFO - Step: 405 | Loss: 9.59 | Tokens per second: 5414.75 | Training tokens per second (%): 26.74 | MFU (%): 7.50 | TFLOPs: 74.13 | Fwd time: 0.0319912 | Bck time: 0.0465162
2025-05-23 00:53:48,129 - root - INFO - Step: 410 | Loss: 9.67 | Tokens per second: 15983.72 | Training tokens per second (%): 35.83 | MFU (%): 22.13 | TFLOPs: 218.83 | Fwd time: 0.0313007 | Bck time: 0.0467352
2025-05-23 00:53:48,782 - root - INFO - Step: 415 | Loss: 9.57 | Tokens per second: 15750.09 | Training tokens per second (%): 54.84 | MFU (%): 21.80 | TFLOPs: 215.63 | Fwd time: 0.0316120 | Bck time: 0.0465891
2025-05-23 00:53:49,430 - root - INFO - Step: 420 | Loss: 9.62 | Tokens per second: 15871.12 | Training tokens per second (%): 26.02 | MFU (%): 21.97 | TFLOPs: 217.29 | Fwd time: 0.0321902 | Bck time: 0.0459352
2025-05-23 00:53:50,070 - root - INFO - Step: 425 | Loss: 9.45 | Tokens per second: 16069.59 | Training tokens per second (%): 20.47 | MFU (%): 22.25 | TFLOPs: 220.01 | Fwd time: 0.0321164 | Bck time: 0.0454393
2025-05-23 00:53:50,720 - root - INFO - Step: 430 | Loss: 10.03 | Tokens per second: 15814.50 | Training tokens per second (%): 46.42 | MFU (%): 21.89 | TFLOPs: 216.52 | Fwd time: 0.0315193 | Bck time: 0.0460016
2025-05-23 00:53:51,389 - root - INFO - Step: 435 | Loss: 9.49 | Tokens per second: 15371.04 | Training tokens per second (%): 57.19 | MFU (%): 21.28 | TFLOPs: 210.44 | Fwd time: 0.0325229 | Bck time: 0.0445578
2025-05-23 00:53:52,034 - root - INFO - Step: 440 | Loss: 9.35 | Tokens per second: 15947.54 | Training tokens per second (%): 29.94 | MFU (%): 22.08 | TFLOPs: 218.34 | Fwd time: 0.0314354 | Bck time: 0.0458696
2025-05-23 00:53:52,688 - root - INFO - Step: 445 | Loss: 9.41 | Tokens per second: 15738.34 | Training tokens per second (%): 48.73 | MFU (%): 21.79 | TFLOPs: 215.47 | Fwd time: 0.0321848 | Bck time: 0.0454843
2025-05-23 00:53:53,342 - root - INFO - Step: 450 | Loss: 9.43 | Tokens per second: 15723.91 | Training tokens per second (%): 50.03 | MFU (%): 21.77 | TFLOPs: 215.28 | Fwd time: 0.0319112 | Bck time: 0.0450161
2025-05-23 00:53:54,010 - root - INFO - Step: 455 | Loss: 9.04 | Tokens per second: 15391.28 | Training tokens per second (%): 59.03 | MFU (%): 21.31 | TFLOPs: 210.72 | Fwd time: 0.0320082 | Bck time: 0.0456223
2025-05-23 00:53:54,655 - root - INFO - Step: 460 | Loss: 9.46 | Tokens per second: 15950.33 | Training tokens per second (%): 40.87 | MFU (%): 22.08 | TFLOPs: 218.38 | Fwd time: 0.0318314 | Bck time: 0.0451192
2025-05-23 00:53:55,308 - root - INFO - Step: 465 | Loss: 9.20 | Tokens per second: 15755.77 | Training tokens per second (%): 49.50 | MFU (%): 21.81 | TFLOPs: 215.71 | Fwd time: 0.0320224 | Bck time: 0.0458006
2025-05-23 00:53:55,960 - root - INFO - Step: 470 | Loss: 9.08 | Tokens per second: 15766.05 | Training tokens per second (%): 46.00 | MFU (%): 21.83 | TFLOPs: 215.85 | Fwd time: 0.0318221 | Bck time: 0.0462364
2025-05-23 00:53:56,615 - root - INFO - Step: 475 | Loss: 9.42 | Tokens per second: 15706.87 | Training tokens per second (%): 53.28 | MFU (%): 21.74 | TFLOPs: 215.04 | Fwd time: 0.0320214 | Bck time: 0.0463880
2025-05-23 00:53:57,268 - root - INFO - Step: 480 | Loss: 9.10 | Tokens per second: 15741.80 | Training tokens per second (%): 46.63 | MFU (%): 21.79 | TFLOPs: 215.52 | Fwd time: 0.0313959 | Bck time: 0.0452560
2025-05-23 00:53:57,911 - root - INFO - Step: 485 | Loss: 9.55 | Tokens per second: 16015.95 | Training tokens per second (%): 24.27 | MFU (%): 22.17 | TFLOPs: 219.27 | Fwd time: 0.0319111 | Bck time: 0.0453660
2025-05-23 00:53:58,558 - root - INFO - Step: 490 | Loss: 9.62 | Tokens per second: 15883.59 | Training tokens per second (%): 31.86 | MFU (%): 21.99 | TFLOPs: 217.46 | Fwd time: 0.0325992 | Bck time: 0.0464054
2025-05-23 00:53:59,214 - root - INFO - Step: 495 | Loss: 9.80 | Tokens per second: 15673.90 | Training tokens per second (%): 33.48 | MFU (%): 21.70 | TFLOPs: 214.59 | Fwd time: 0.0324975 | Bck time: 0.0467455
2025-05-23 00:53:59,869 - root - INFO - Step: 500 | Loss: 9.84 | Tokens per second: 15702.88 | Training tokens per second (%): 55.93 | MFU (%): 21.74 | TFLOPs: 214.99 | Fwd time: 0.0319302 | Bck time: 0.0464201
2025-05-23 00:54:14,665 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 00:54:14,667 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 00:54:15,322 - root - INFO - Step: 505 | Loss: 9.17 | Tokens per second: 662.80 | Training tokens per second (%): 32.19 | MFU (%): 0.92 | TFLOPs: 9.07 | Fwd time: 0.0314647 | Bck time: 0.0463222
2025-05-23 00:54:15,964 - root - INFO - Step: 510 | Loss: 9.61 | Tokens per second: 16015.50 | Training tokens per second (%): 33.70 | MFU (%): 22.17 | TFLOPs: 219.27 | Fwd time: 0.0319339 | Bck time: 0.0457421
2025-05-23 00:54:16,609 - root - INFO - Step: 515 | Loss: 8.55 | Tokens per second: 15949.41 | Training tokens per second (%): 35.54 | MFU (%): 22.08 | TFLOPs: 218.36 | Fwd time: 0.0312558 | Bck time: 0.0458207
2025-05-23 00:54:17,350 - root - INFO - Step: 520 | Loss: 9.12 | Tokens per second: 13867.54 | Training tokens per second (%): 36.02 | MFU (%): 19.20 | TFLOPs: 189.86 | Fwd time: 0.0313542 | Bck time: 0.0454865
2025-05-23 00:54:18,006 - root - INFO - Step: 525 | Loss: 8.99 | Tokens per second: 15681.74 | Training tokens per second (%): 43.12 | MFU (%): 21.71 | TFLOPs: 214.70 | Fwd time: 0.0318413 | Bck time: 0.0451840
2025-05-23 00:54:18,656 - root - INFO - Step: 530 | Loss: 9.26 | Tokens per second: 15828.94 | Training tokens per second (%): 52.23 | MFU (%): 21.91 | TFLOPs: 216.71 | Fwd time: 0.0323218 | Bck time: 0.0452122
2025-05-23 00:54:19,329 - root - INFO - Step: 535 | Loss: 9.46 | Tokens per second: 15284.32 | Training tokens per second (%): 62.50 | MFU (%): 21.16 | TFLOPs: 209.26 | Fwd time: 0.0324912 | Bck time: 0.0448764
2025-05-23 00:54:19,994 - root - INFO - Step: 540 | Loss: 8.01 | Tokens per second: 15465.39 | Training tokens per second (%): 36.82 | MFU (%): 21.41 | TFLOPs: 211.74 | Fwd time: 0.0291417 | Bck time: 0.0453963
2025-05-23 00:54:20,644 - root - INFO - Step: 545 | Loss: 9.45 | Tokens per second: 15806.70 | Training tokens per second (%): 57.97 | MFU (%): 21.88 | TFLOPs: 216.41 | Fwd time: 0.0307391 | Bck time: 0.0449044
2025-05-23 00:54:21,281 - root - INFO - Step: 550 | Loss: 9.43 | Tokens per second: 16164.31 | Training tokens per second (%): 21.77 | MFU (%): 22.38 | TFLOPs: 221.31 | Fwd time: 0.0312952 | Bck time: 0.0456479
2025-05-23 00:54:21,919 - root - INFO - Step: 555 | Loss: 10.70 | Tokens per second: 16117.85 | Training tokens per second (%): 27.19 | MFU (%): 22.31 | TFLOPs: 220.67 | Fwd time: 0.0314661 | Bck time: 0.0451238
2025-05-23 00:54:22,560 - root - INFO - Step: 560 | Loss: 9.78 | Tokens per second: 16052.58 | Training tokens per second (%): 42.37 | MFU (%): 22.22 | TFLOPs: 219.78 | Fwd time: 0.0315883 | Bck time: 0.0450359
2025-05-23 00:54:23,196 - root - INFO - Step: 565 | Loss: 9.35 | Tokens per second: 16149.19 | Training tokens per second (%): 21.70 | MFU (%): 22.36 | TFLOPs: 221.10 | Fwd time: 0.0316639 | Bck time: 0.0450626
2025-05-23 00:54:23,834 - root - INFO - Step: 570 | Loss: 9.73 | Tokens per second: 16126.69 | Training tokens per second (%): 19.83 | MFU (%): 22.32 | TFLOPs: 220.79 | Fwd time: 0.0312634 | Bck time: 0.0450418
2025-05-23 00:54:24,471 - root - INFO - Step: 575 | Loss: 9.09 | Tokens per second: 16157.68 | Training tokens per second (%): 23.92 | MFU (%): 22.37 | TFLOPs: 221.21 | Fwd time: 0.0307809 | Bck time: 0.0457776
2025-05-23 00:54:25,104 - root - INFO - Step: 580 | Loss: 9.34 | Tokens per second: 16236.39 | Training tokens per second (%): 14.81 | MFU (%): 22.48 | TFLOPs: 222.29 | Fwd time: 0.0315928 | Bck time: 0.0450312
2025-05-23 00:54:25,747 - root - INFO - Step: 585 | Loss: 8.85 | Tokens per second: 16019.25 | Training tokens per second (%): 32.60 | MFU (%): 22.18 | TFLOPs: 219.32 | Fwd time: 0.0309888 | Bck time: 0.0447837
2025-05-23 00:54:26,388 - root - INFO - Step: 590 | Loss: 9.27 | Tokens per second: 16022.92 | Training tokens per second (%): 32.20 | MFU (%): 22.18 | TFLOPs: 219.37 | Fwd time: 0.0319974 | Bck time: 0.0451321
2025-05-23 00:54:27,026 - root - INFO - Step: 595 | Loss: 9.25 | Tokens per second: 16144.20 | Training tokens per second (%): 23.82 | MFU (%): 22.35 | TFLOPs: 221.03 | Fwd time: 0.0313401 | Bck time: 0.0454767
2025-05-23 00:54:27,663 - root - INFO - Step: 600 | Loss: 9.21 | Tokens per second: 16136.96 | Training tokens per second (%): 22.92 | MFU (%): 22.34 | TFLOPs: 220.93 | Fwd time: 0.0312711 | Bck time: 0.0450029
2025-05-23 00:54:42,566 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 00:54:42,568 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 00:54:43,228 - root - INFO - Step: 605 | Loss: 9.33 | Tokens per second: 658.01 | Training tokens per second (%): 33.96 | MFU (%): 0.91 | TFLOPs: 9.01 | Fwd time: 0.0308841 | Bck time: 0.0451340
2025-05-23 00:54:43,867 - root - INFO - Step: 610 | Loss: 10.17 | Tokens per second: 16095.75 | Training tokens per second (%): 30.22 | MFU (%): 22.28 | TFLOPs: 220.37 | Fwd time: 0.0312516 | Bck time: 0.0442081
2025-05-23 00:54:44,513 - root - INFO - Step: 615 | Loss: 9.20 | Tokens per second: 15921.09 | Training tokens per second (%): 44.69 | MFU (%): 22.04 | TFLOPs: 217.98 | Fwd time: 0.0309281 | Bck time: 0.0447345
2025-05-23 00:54:45,152 - root - INFO - Step: 620 | Loss: 8.83 | Tokens per second: 16099.16 | Training tokens per second (%): 29.02 | MFU (%): 22.29 | TFLOPs: 220.41 | Fwd time: 0.0309259 | Bck time: 0.0443377
2025-05-23 00:54:45,797 - root - INFO - Step: 625 | Loss: 9.22 | Tokens per second: 15937.11 | Training tokens per second (%): 40.37 | MFU (%): 22.06 | TFLOPs: 218.20 | Fwd time: 0.0319211 | Bck time: 0.0447502
2025-05-23 00:54:46,435 - root - INFO - Step: 630 | Loss: 9.28 | Tokens per second: 16128.44 | Training tokens per second (%): 27.91 | MFU (%): 22.33 | TFLOPs: 220.81 | Fwd time: 0.0314177 | Bck time: 0.0448188
2025-05-23 00:54:47,089 - root - INFO - Step: 635 | Loss: 9.49 | Tokens per second: 15726.96 | Training tokens per second (%): 52.14 | MFU (%): 21.77 | TFLOPs: 215.32 | Fwd time: 0.0317682 | Bck time: 0.0449105
2025-05-23 00:54:47,729 - root - INFO - Step: 640 | Loss: 9.24 | Tokens per second: 16068.99 | Training tokens per second (%): 30.87 | MFU (%): 22.24 | TFLOPs: 220.00 | Fwd time: 0.0316991 | Bck time: 0.0450403
2025-05-23 00:54:48,368 - root - INFO - Step: 645 | Loss: 9.12 | Tokens per second: 16101.71 | Training tokens per second (%): 31.95 | MFU (%): 22.29 | TFLOPs: 220.45 | Fwd time: 0.0313509 | Bck time: 0.0446794
2025-05-23 00:54:49,026 - root - INFO - Step: 650 | Loss: 8.90 | Tokens per second: 15630.70 | Training tokens per second (%): 62.01 | MFU (%): 21.64 | TFLOPs: 214.00 | Fwd time: 0.0322618 | Bck time: 0.0443463
2025-05-23 00:54:49,678 - root - INFO - Step: 655 | Loss: 9.30 | Tokens per second: 15776.35 | Training tokens per second (%): 34.36 | MFU (%): 21.84 | TFLOPs: 215.99 | Fwd time: 0.0317597 | Bck time: 0.0450686
2025-05-23 00:54:50,311 - root - INFO - Step: 660 | Loss: 9.27 | Tokens per second: 16239.50 | Training tokens per second (%): 26.00 | MFU (%): 22.48 | TFLOPs: 222.34 | Fwd time: 0.0313806 | Bck time: 0.0440328
2025-05-23 00:54:50,968 - root - INFO - Step: 665 | Loss: 9.14 | Tokens per second: 15660.69 | Training tokens per second (%): 50.09 | MFU (%): 21.68 | TFLOPs: 214.41 | Fwd time: 0.0309572 | Bck time: 0.0450103
2025-05-23 00:54:51,612 - root - INFO - Step: 670 | Loss: 8.74 | Tokens per second: 15975.29 | Training tokens per second (%): 36.77 | MFU (%): 22.12 | TFLOPs: 218.72 | Fwd time: 0.0316771 | Bck time: 0.0450501
2025-05-23 00:54:52,247 - root - INFO - Step: 675 | Loss: 8.67 | Tokens per second: 16196.74 | Training tokens per second (%): 18.53 | MFU (%): 22.42 | TFLOPs: 221.75 | Fwd time: 0.0311612 | Bck time: 0.0447455
2025-05-23 00:54:52,892 - root - INFO - Step: 680 | Loss: 8.95 | Tokens per second: 15943.17 | Training tokens per second (%): 42.48 | MFU (%): 22.07 | TFLOPs: 218.28 | Fwd time: 0.0316071 | Bck time: 0.0454670
2025-05-23 00:54:53,532 - root - INFO - Step: 685 | Loss: 9.53 | Tokens per second: 16065.94 | Training tokens per second (%): 39.21 | MFU (%): 22.24 | TFLOPs: 219.96 | Fwd time: 0.0305288 | Bck time: 0.0454986
2025-05-23 00:54:54,162 - root - INFO - Step: 690 | Loss: 8.99 | Tokens per second: 16331.70 | Training tokens per second (%): 14.64 | MFU (%): 22.61 | TFLOPs: 223.60 | Fwd time: 0.0310771 | Bck time: 0.0447629
2025-05-23 00:54:54,831 - root - INFO - Step: 695 | Loss: 9.11 | Tokens per second: 15383.36 | Training tokens per second (%): 69.60 | MFU (%): 21.30 | TFLOPs: 210.61 | Fwd time: 0.0313692 | Bck time: 0.0444295
2025-05-23 00:54:55,473 - root - INFO - Step: 700 | Loss: 8.74 | Tokens per second: 16013.20 | Training tokens per second (%): 38.46 | MFU (%): 22.17 | TFLOPs: 219.24 | Fwd time: 0.0305670 | Bck time: 0.0457527
2025-05-23 00:55:10,942 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 00:55:10,945 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 00:55:11,605 - root - INFO - Step: 705 | Loss: 9.04 | Tokens per second: 634.89 | Training tokens per second (%): 41.45 | MFU (%): 0.88 | TFLOPs: 8.69 | Fwd time: 0.0313977 | Bck time: 0.0448894
2025-05-23 00:55:12,251 - root - INFO - Step: 710 | Loss: 9.07 | Tokens per second: 15902.78 | Training tokens per second (%): 65.75 | MFU (%): 22.01 | TFLOPs: 217.73 | Fwd time: 0.0314875 | Bck time: 0.0448535
2025-05-23 00:55:12,899 - root - INFO - Step: 715 | Loss: 8.74 | Tokens per second: 15872.39 | Training tokens per second (%): 38.32 | MFU (%): 21.97 | TFLOPs: 217.31 | Fwd time: 0.0311103 | Bck time: 0.0453620
2025-05-23 00:55:13,535 - root - INFO - Step: 720 | Loss: 8.17 | Tokens per second: 16190.87 | Training tokens per second (%): 23.34 | MFU (%): 22.41 | TFLOPs: 221.67 | Fwd time: 0.0320539 | Bck time: 0.0445728
2025-05-23 00:55:14,167 - root - INFO - Step: 725 | Loss: 8.98 | Tokens per second: 16268.93 | Training tokens per second (%): 19.70 | MFU (%): 22.52 | TFLOPs: 222.74 | Fwd time: 0.0312931 | Bck time: 0.0447100
2025-05-23 00:55:14,801 - root - INFO - Step: 730 | Loss: 9.39 | Tokens per second: 16218.80 | Training tokens per second (%): 22.53 | MFU (%): 22.45 | TFLOPs: 222.05 | Fwd time: 0.0317412 | Bck time: 0.0452305
2025-05-23 00:55:15,437 - root - INFO - Step: 735 | Loss: 8.92 | Tokens per second: 16188.09 | Training tokens per second (%): 18.57 | MFU (%): 22.41 | TFLOPs: 221.63 | Fwd time: 0.0308603 | Bck time: 0.0452087
2025-05-23 00:55:16,081 - root - INFO - Step: 740 | Loss: 9.45 | Tokens per second: 15975.38 | Training tokens per second (%): 38.10 | MFU (%): 22.12 | TFLOPs: 218.72 | Fwd time: 0.0316926 | Bck time: 0.0437888
2025-05-23 00:55:16,721 - root - INFO - Step: 745 | Loss: 9.29 | Tokens per second: 16061.47 | Training tokens per second (%): 19.01 | MFU (%): 22.23 | TFLOPs: 219.90 | Fwd time: 0.0306044 | Bck time: 0.0442345
2025-05-23 00:55:17,361 - root - INFO - Step: 750 | Loss: 9.12 | Tokens per second: 16072.04 | Training tokens per second (%): 38.02 | MFU (%): 22.25 | TFLOPs: 220.04 | Fwd time: 0.0319334 | Bck time: 0.0444321
2025-05-23 00:55:18,002 - root - INFO - Step: 755 | Loss: 9.03 | Tokens per second: 16041.83 | Training tokens per second (%): 39.84 | MFU (%): 22.21 | TFLOPs: 219.63 | Fwd time: 0.0305875 | Bck time: 0.0454218
2025-05-23 00:55:18,655 - root - INFO - Step: 760 | Loss: 9.18 | Tokens per second: 15745.70 | Training tokens per second (%): 66.40 | MFU (%): 21.80 | TFLOPs: 215.57 | Fwd time: 0.0317796 | Bck time: 0.0450594
2025-05-23 00:55:19,315 - root - INFO - Step: 765 | Loss: 8.97 | Tokens per second: 15591.20 | Training tokens per second (%): 71.65 | MFU (%): 21.58 | TFLOPs: 213.46 | Fwd time: 0.0318866 | Bck time: 0.0448456
2025-05-23 00:55:19,954 - root - INFO - Step: 770 | Loss: 8.70 | Tokens per second: 16103.24 | Training tokens per second (%): 37.12 | MFU (%): 22.29 | TFLOPs: 220.47 | Fwd time: 0.0312408 | Bck time: 0.0448726
2025-05-23 00:55:20,602 - root - INFO - Step: 775 | Loss: 8.65 | Tokens per second: 15871.58 | Training tokens per second (%): 39.87 | MFU (%): 21.97 | TFLOPs: 217.30 | Fwd time: 0.0308876 | Bck time: 0.0446174
2025-05-23 00:55:21,237 - root - INFO - Step: 780 | Loss: 9.74 | Tokens per second: 16198.39 | Training tokens per second (%): 24.48 | MFU (%): 22.42 | TFLOPs: 221.77 | Fwd time: 0.0314215 | Bck time: 0.0452107
2025-05-23 00:55:21,868 - root - INFO - Step: 785 | Loss: 8.93 | Tokens per second: 16290.42 | Training tokens per second (%): 34.96 | MFU (%): 22.55 | TFLOPs: 223.03 | Fwd time: 0.0312576 | Bck time: 0.0453350
2025-05-23 00:55:22,507 - root - INFO - Step: 790 | Loss: 9.05 | Tokens per second: 16100.65 | Training tokens per second (%): 37.27 | MFU (%): 22.29 | TFLOPs: 220.43 | Fwd time: 0.0311532 | Bck time: 0.0449836
2025-05-23 00:55:23,171 - root - INFO - Step: 795 | Loss: 8.51 | Tokens per second: 15480.62 | Training tokens per second (%): 58.36 | MFU (%): 21.43 | TFLOPs: 211.95 | Fwd time: 0.0312654 | Bck time: 0.0449345
2025-05-23 00:55:23,821 - root - INFO - Step: 800 | Loss: 8.69 | Tokens per second: 15847.55 | Training tokens per second (%): 46.09 | MFU (%): 21.94 | TFLOPs: 216.97 | Fwd time: 0.0323125 | Bck time: 0.0453184
2025-05-23 00:55:39,254 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 00:55:39,256 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 00:55:39,931 - root - INFO - Step: 805 | Loss: 8.87 | Tokens per second: 635.73 | Training tokens per second (%): 56.74 | MFU (%): 0.88 | TFLOPs: 8.70 | Fwd time: 0.0314235 | Bck time: 0.0450949
2025-05-23 00:55:40,573 - root - INFO - Step: 810 | Loss: 8.78 | Tokens per second: 16027.08 | Training tokens per second (%): 34.25 | MFU (%): 22.19 | TFLOPs: 219.43 | Fwd time: 0.0320253 | Bck time: 0.0445114
2025-05-23 00:55:41,222 - root - INFO - Step: 815 | Loss: 9.37 | Tokens per second: 15844.64 | Training tokens per second (%): 42.13 | MFU (%): 21.93 | TFLOPs: 216.93 | Fwd time: 0.0307563 | Bck time: 0.0445047
2025-05-23 00:55:41,866 - root - INFO - Step: 820 | Loss: 8.74 | Tokens per second: 15974.73 | Training tokens per second (%): 37.11 | MFU (%): 22.11 | TFLOPs: 218.71 | Fwd time: 0.0320299 | Bck time: 0.0440354
2025-05-23 00:55:42,518 - root - INFO - Step: 825 | Loss: 8.89 | Tokens per second: 15770.00 | Training tokens per second (%): 64.04 | MFU (%): 21.83 | TFLOPs: 215.91 | Fwd time: 0.0314131 | Bck time: 0.0443793
2025-05-23 00:55:43,164 - root - INFO - Step: 830 | Loss: 8.89 | Tokens per second: 15929.56 | Training tokens per second (%): 38.42 | MFU (%): 22.05 | TFLOPs: 218.09 | Fwd time: 0.0318415 | Bck time: 0.0446139
2025-05-23 00:55:43,802 - root - INFO - Step: 835 | Loss: 9.02 | Tokens per second: 16106.28 | Training tokens per second (%): 18.90 | MFU (%): 22.30 | TFLOPs: 220.51 | Fwd time: 0.0311459 | Bck time: 0.0445876
2025-05-23 00:55:44,437 - root - INFO - Step: 840 | Loss: 9.01 | Tokens per second: 16195.17 | Training tokens per second (%): 17.96 | MFU (%): 22.42 | TFLOPs: 221.73 | Fwd time: 0.0313860 | Bck time: 0.0449198
2025-05-23 00:55:45,077 - root - INFO - Step: 845 | Loss: 9.24 | Tokens per second: 16075.83 | Training tokens per second (%): 28.84 | MFU (%): 22.25 | TFLOPs: 220.09 | Fwd time: 0.0314870 | Bck time: 0.0449469
2025-05-23 00:55:45,716 - root - INFO - Step: 850 | Loss: 8.69 | Tokens per second: 16107.16 | Training tokens per second (%): 28.53 | MFU (%): 22.30 | TFLOPs: 220.52 | Fwd time: 0.0320553 | Bck time: 0.0449179
2025-05-23 00:55:46,368 - root - INFO - Step: 855 | Loss: 8.96 | Tokens per second: 15776.63 | Training tokens per second (%): 60.01 | MFU (%): 21.84 | TFLOPs: 216.00 | Fwd time: 0.0313926 | Bck time: 0.0445065
2025-05-23 00:55:47,008 - root - INFO - Step: 860 | Loss: 9.02 | Tokens per second: 16058.13 | Training tokens per second (%): 17.26 | MFU (%): 22.23 | TFLOPs: 219.85 | Fwd time: 0.0318722 | Bck time: 0.0445860
2025-05-23 00:55:47,649 - root - INFO - Step: 865 | Loss: 8.42 | Tokens per second: 16053.76 | Training tokens per second (%): 30.07 | MFU (%): 22.22 | TFLOPs: 219.79 | Fwd time: 0.0309415 | Bck time: 0.0446155
2025-05-23 00:55:48,294 - root - INFO - Step: 870 | Loss: 8.73 | Tokens per second: 15953.99 | Training tokens per second (%): 44.47 | MFU (%): 22.09 | TFLOPs: 218.43 | Fwd time: 0.0318610 | Bck time: 0.0442107
2025-05-23 00:55:48,936 - root - INFO - Step: 875 | Loss: 8.71 | Tokens per second: 16023.26 | Training tokens per second (%): 27.70 | MFU (%): 22.18 | TFLOPs: 219.37 | Fwd time: 0.0318171 | Bck time: 0.0444565
2025-05-23 00:55:49,575 - root - INFO - Step: 880 | Loss: 9.35 | Tokens per second: 16091.72 | Training tokens per second (%): 30.81 | MFU (%): 22.28 | TFLOPs: 220.31 | Fwd time: 0.0318477 | Bck time: 0.0455262
2025-05-23 00:55:50,224 - root - INFO - Step: 885 | Loss: 8.50 | Tokens per second: 15841.14 | Training tokens per second (%): 55.39 | MFU (%): 21.93 | TFLOPs: 216.88 | Fwd time: 0.0308520 | Bck time: 0.0450628
2025-05-23 00:55:50,869 - root - INFO - Step: 890 | Loss: 8.64 | Tokens per second: 15941.49 | Training tokens per second (%): 46.77 | MFU (%): 22.07 | TFLOPs: 218.25 | Fwd time: 0.0322417 | Bck time: 0.0447805
2025-05-23 00:55:51,509 - root - INFO - Step: 895 | Loss: 9.28 | Tokens per second: 16081.50 | Training tokens per second (%): 25.31 | MFU (%): 22.26 | TFLOPs: 220.17 | Fwd time: 0.0304727 | Bck time: 0.0449222
2025-05-23 00:55:52,151 - root - INFO - Step: 900 | Loss: 8.90 | Tokens per second: 16026.92 | Training tokens per second (%): 28.43 | MFU (%): 22.19 | TFLOPs: 219.42 | Fwd time: 0.0326615 | Bck time: 0.0449730
2025-05-23 00:56:06,096 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 00:56:06,098 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 00:56:06,746 - root - INFO - Step: 905 | Loss: 9.36 | Tokens per second: 701.72 | Training tokens per second (%): 23.78 | MFU (%): 0.97 | TFLOPs: 9.61 | Fwd time: 0.0302473 | Bck time: 0.0455739
2025-05-23 00:56:07,383 - root - INFO - Step: 910 | Loss: 8.54 | Tokens per second: 16145.68 | Training tokens per second (%): 52.56 | MFU (%): 22.35 | TFLOPs: 221.05 | Fwd time: 0.0305449 | Bck time: 0.0450893
2025-05-23 00:56:08,014 - root - INFO - Step: 915 | Loss: 8.88 | Tokens per second: 16314.19 | Training tokens per second (%): 24.68 | MFU (%): 22.58 | TFLOPs: 223.36 | Fwd time: 0.0300238 | Bck time: 0.0449701
2025-05-23 00:56:08,648 - root - INFO - Step: 920 | Loss: 8.71 | Tokens per second: 16219.09 | Training tokens per second (%): 38.97 | MFU (%): 22.45 | TFLOPs: 222.06 | Fwd time: 0.0310553 | Bck time: 0.0445945
2025-05-23 00:56:09,279 - root - INFO - Step: 925 | Loss: 8.49 | Tokens per second: 16303.31 | Training tokens per second (%): 20.49 | MFU (%): 22.57 | TFLOPs: 223.21 | Fwd time: 0.0297456 | Bck time: 0.0437796
2025-05-23 00:56:09,920 - root - INFO - Step: 930 | Loss: 8.57 | Tokens per second: 16042.71 | Training tokens per second (%): 45.94 | MFU (%): 22.21 | TFLOPs: 219.64 | Fwd time: 0.0308459 | Bck time: 0.0445859
2025-05-23 00:56:10,552 - root - INFO - Step: 935 | Loss: 9.02 | Tokens per second: 16279.94 | Training tokens per second (%): 27.28 | MFU (%): 22.54 | TFLOPs: 222.89 | Fwd time: 0.0305247 | Bck time: 0.0452698
2025-05-23 00:56:11,187 - root - INFO - Step: 940 | Loss: 8.68 | Tokens per second: 16202.19 | Training tokens per second (%): 40.39 | MFU (%): 22.43 | TFLOPs: 221.82 | Fwd time: 0.0309868 | Bck time: 0.0450678
2025-05-23 00:56:11,827 - root - INFO - Step: 945 | Loss: 8.85 | Tokens per second: 16078.78 | Training tokens per second (%): 36.22 | MFU (%): 22.26 | TFLOPs: 220.13 | Fwd time: 0.0303232 | Bck time: 0.0447809
2025-05-23 00:56:12,491 - root - INFO - Step: 950 | Loss: 8.29 | Tokens per second: 15477.32 | Training tokens per second (%): 68.71 | MFU (%): 21.43 | TFLOPs: 211.90 | Fwd time: 0.0308593 | Bck time: 0.0449655
2025-05-23 00:56:13,127 - root - INFO - Step: 955 | Loss: 8.37 | Tokens per second: 16183.12 | Training tokens per second (%): 28.65 | MFU (%): 22.40 | TFLOPs: 221.56 | Fwd time: 0.0307963 | Bck time: 0.0448013
2025-05-23 00:56:13,773 - root - INFO - Step: 960 | Loss: 8.87 | Tokens per second: 15928.83 | Training tokens per second (%): 66.72 | MFU (%): 22.05 | TFLOPs: 218.08 | Fwd time: 0.0309776 | Bck time: 0.0446832
2025-05-23 00:56:14,402 - root - INFO - Step: 965 | Loss: 8.87 | Tokens per second: 16348.13 | Training tokens per second (%): 29.86 | MFU (%): 22.63 | TFLOPs: 223.82 | Fwd time: 0.0299765 | Bck time: 0.0451985
2025-05-23 00:56:15,032 - root - INFO - Step: 970 | Loss: 8.86 | Tokens per second: 16316.44 | Training tokens per second (%): 18.29 | MFU (%): 22.59 | TFLOPs: 223.39 | Fwd time: 0.0305345 | Bck time: 0.0450445
2025-05-23 00:56:15,666 - root - INFO - Step: 975 | Loss: 8.27 | Tokens per second: 16230.86 | Training tokens per second (%): 30.81 | MFU (%): 22.47 | TFLOPs: 222.22 | Fwd time: 0.0305663 | Bck time: 0.0448976
2025-05-23 00:56:16,315 - root - INFO - Step: 980 | Loss: 9.25 | Tokens per second: 15841.57 | Training tokens per second (%): 59.73 | MFU (%): 21.93 | TFLOPs: 216.89 | Fwd time: 0.0291157 | Bck time: 0.0443856
2025-05-23 00:56:16,941 - root - INFO - Step: 985 | Loss: 8.53 | Tokens per second: 16429.24 | Training tokens per second (%): 32.12 | MFU (%): 22.74 | TFLOPs: 224.93 | Fwd time: 0.0295831 | Bck time: 0.0443988
2025-05-23 00:56:17,573 - root - INFO - Step: 990 | Loss: 9.02 | Tokens per second: 16287.17 | Training tokens per second (%): 24.20 | MFU (%): 22.55 | TFLOPs: 222.99 | Fwd time: 0.0306834 | Bck time: 0.0452178
2025-05-23 00:56:18,224 - root - INFO - Step: 995 | Loss: 8.93 | Tokens per second: 15804.94 | Training tokens per second (%): 53.05 | MFU (%): 21.88 | TFLOPs: 216.39 | Fwd time: 0.0305800 | Bck time: 0.0451004
2025-05-23 00:56:18,855 - root - INFO - Step: 1000 | Loss: 8.20 | Tokens per second: 16283.99 | Training tokens per second (%): 36.98 | MFU (%): 22.54 | TFLOPs: 222.94 | Fwd time: 0.0300843 | Bck time: 0.0451019
2025-05-23 00:56:31,753 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 00:56:31,756 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
total_size: 6845503780, bsize: 6845503780, ratio: 2.0
6845503780 2 False
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 340.181827545166 ms
CPU copy took 12671.322107315063 ms
---------------------- [PERF] Single Checkpoint time is 13.032208442687988 sec, average is 13.032205820083618
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 317.2569274902344 ms
CPU copy took 13912.926197052002 ms
---------------------- [PERF] Single Checkpoint time is 14.250800371170044 sec, average is 13.641501426696777
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 317.0757293701172 ms
CPU copy took 14509.11021232605 ms
---------------------- [PERF] Single Checkpoint time is 14.846810817718506 sec, average is 14.250797033309937
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 318.3732032775879 ms
CPU copy took 12130.568742752075 ms
---------------------- [PERF] Single Checkpoint time is 12.46951937675476 sec, average is 13.641501426696777
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 320.20068168640137 ms
CPU copy took 11273.108959197998 ms
---------------------- [PERF] Single Checkpoint time is 11.6138916015625 sec, average is 13.032205820083618
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 319.72432136535645 ms
CPU copy took 22036.587953567505 ms
---------------------- [PERF] Single Checkpoint time is 22.361766815185547 sec, average is 13.641501426696777
---- exit
PR_ADDR_DATA is 0x401480410000, PR_ADDR is 0x401480190000, PEER_CHECK_ADDR is 0x401480210000
--------------- init enqueue: 0
--------------- init enqueue: 1
Call dram.alloc, num_batches is 2, batch_size_floats is 6845503780
------------------------- is_distributed is 0, rank is 0
Parall_iter 0, Write new metadata at address 0x401480310000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 108, parall_iter is 0, num_threads is 1, last counter is 0, curr_counter is 1
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x401480410000, curr_pr_arr is 0x401480410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x401480410000!
Thread ID: 1, savenvm_thread_nd took 12579.751341 ms
Thread ID: 1, set_cpu took 0.095358 ms
Threads took 12580.119523 ms
MSYNC 27382015120 TOOK 83.671312 ms
CAS was successful! new counter is 1, is_distributed is 0
******** checkp_info saved in 0x401480310000, curr_checkpoint is 0x401480310000
0, 1
Parall_iter 1, Write new metadata at address 0x401480390000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 30, parall_iter is 1, num_threads is 1, last counter is 1, curr_counter is 2
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401ae05a0000, curr_pr_arr is 0x401ae05a0000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401ae05a0000!
Thread ID: 2, savenvm_thread_nd took 13820.955515 ms
Thread ID: 2, set_cpu took 0.086750 ms
Threads took 13821.254323 ms
MSYNC 27382015120 TOOK 85.052204 ms
CAS was successful! new counter is 2, is_distributed is 0
******** checkp_info saved in 0x401480390000, curr_checkpoint is 0x401480390000
1, 2
Parall_iter 0, Write new metadata at address 0x401480310000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 95, parall_iter is 0, num_threads is 1, last counter is 2, curr_counter is 3
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x401480410000, curr_pr_arr is 0x401480410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x401480410000!
Thread ID: 1, savenvm_thread_nd took 14436.746469 ms
Thread ID: 1, set_cpu took 0.095069 ms
Threads took 14437.052925 ms
MSYNC 27382015120 TOOK 63.741867 ms
CAS was successful! new counter is 3, is_distributed is 0
******** checkp_info saved in 0x401480310000, curr_checkpoint is 0x401480310000
0, 3
Parall_iter 1, Write new metadata at address 0x401480390000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 49, parall_iter is 1, num_threads is 1, last counter is 3, curr_counter is 4
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401ae05a0000, curr_pr_arr is 0x401ae05a0000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401ae05a0000!
Thread ID: 2, savenvm_thread_nd took 12063.648774 ms
Thread ID: 2, set_cpu took 0.082269 ms
Threads took 12063.915838 ms
MSYNC 27382015120 TOOK 60.275623 ms
CAS was successful! new counter is 4, is_distributed is 0
******** checkp_info saved in 0x401480390000, curr_checkpoint is 0x401480390000
1, 4
Parall_iter 0, Write new metadata at address 0x401480310000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 115, parall_iter is 0, num_threads is 1, last counter is 4, curr_counter is 5
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x401480410000, curr_pr_arr is 0x401480410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x401480410000!
Thread ID: 1, savenvm_thread_nd took 10460.717885 ms
Thread ID: 1, set_cpu took 0.077246 ms
Threads took 10460.980918 ms
MSYNC 27382015120 TOOK 806.406324 ms
CAS was successful! new counter is 5, is_distributed is 0
******** checkp_info saved in 0x401480310000, curr_checkpoint is 0x401480310000
0, 5
Parall_iter 1, Write new metadata at address 0x401480390000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 47, parall_iter is 1, num_threads is 1, last counter is 5, curr_counter is 6
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401ae05a0000, curr_pr_arr is 0x401ae05a0000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401ae05a0000!
Thread ID: 2, savenvm_thread_nd took 21996.149969 ms
Thread ID: 2, set_cpu took 0.087773 ms
Threads took 21996.422026 ms
MSYNC 27382015120 TOOK 39.042371 ms
CAS was successful! new counter is 6, is_distributed is 0
******** checkp_info saved in 0x401480390000, curr_checkpoint is 0x401480390000
1, 6
2025-05-23 00:56:50,729 - root - INFO - Training completed
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
0, 3, 0
1, 4, 3
max_piter is 1
Writing offset is 39792, parall_iter_offset is 6845513728
data_offset is 27384676352
