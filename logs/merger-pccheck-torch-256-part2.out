2025-05-23 02:57:03,452 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=256, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=1000, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, seed=4, checkpoint_dir='/iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts', loss_file='/iopsstor/scratch/cscs/bkundu/lsai-merger/results/bf16/loss-pccheck-torch-256-part2.csv', checkpoint_freq=100, max_async=1, warmup=3, load_checkpoint=True, non_blocking=False)
2025-05-23 02:57:03,457 - root - INFO - Random state checkpoint loaded from /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 02:57:03,457 - root - INFO - Training will resume from step: 400
2025-05-23 02:57:03,457 - root - INFO - Setting up DataLoaders...
2025-05-23 02:57:05,662 - root - INFO - Setting up Model...
2025-05-23 02:57:20,860 - root - INFO - Loading checkpoint model, optimizer + scheduler
/iopsstor/scratch/cscs/bkundu/lsai-merger/LSAI-Checkpointing/training/utils.py:85: UserWarning: The given buffer is not writable, and PyTorch does not support non-writable tensors. This means you can write to the underlying (supposedly non-writable) buffer using the tensor. You may want to copy the buffer to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at /opt/pytorch/pytorch/torch/csrc/utils/tensor_new.cpp:1561.)
  data = torch.frombuffer(payload, dtype=torch.float32)
2025-05-23 02:57:27,559 - root - INFO - Checkpoint loaded from /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/checkpoint_pccheck.pt
2025-05-23 02:57:27,601 - root - INFO - Loaded optimizer, scheduler checkpoint at step 400 in 6.72 seconds
Model size: 2281834496, Optimizer size: 4563669284, Total size: 6845503780
BSIZE IS 6845503780
At checkpoint, bsize is 6845503780
2025-05-23 02:57:38,819 - root - INFO - Checkpointing warmup done
2025-05-23 02:57:38,823 - root - INFO - ------------------------------------------------------------Starting training!
2025-05-23 02:57:41,013 - root - INFO - Step: 405 | Loss: 9.69 | Tokens per second: 585.22 | Training tokens per second (%): 87.97 | MFU (%): 0.73 | TFLOPs: 7.19 | Fwd time: 0.0313225 | Bck time: 0.0459928
2025-05-23 02:57:41,613 - root - INFO - Step: 410 | Loss: 9.67 | Tokens per second: 2145.67 | Training tokens per second (%): 100.00 | MFU (%): 2.66 | TFLOPs: 26.35 | Fwd time: 0.0311139 | Bck time: 0.0453147
2025-05-23 02:57:42,208 - root - INFO - Step: 415 | Loss: 9.51 | Tokens per second: 2160.10 | Training tokens per second (%): 93.98 | MFU (%): 2.68 | TFLOPs: 26.53 | Fwd time: 0.0324828 | Bck time: 0.0435671
2025-05-23 02:57:42,802 - root - INFO - Step: 420 | Loss: 9.70 | Tokens per second: 2163.94 | Training tokens per second (%): 91.80 | MFU (%): 2.69 | TFLOPs: 26.58 | Fwd time: 0.0313531 | Bck time: 0.0451660
2025-05-23 02:57:43,400 - root - INFO - Step: 425 | Loss: 9.54 | Tokens per second: 2151.10 | Training tokens per second (%): 96.25 | MFU (%): 2.67 | TFLOPs: 26.42 | Fwd time: 0.0319305 | Bck time: 0.0454921
2025-05-23 02:57:44,005 - root - INFO - Step: 430 | Loss: 10.22 | Tokens per second: 2127.82 | Training tokens per second (%): 100.00 | MFU (%): 2.64 | TFLOPs: 26.13 | Fwd time: 0.0326968 | Bck time: 0.0450309
2025-05-23 02:57:44,616 - root - INFO - Step: 435 | Loss: 9.33 | Tokens per second: 2103.07 | Training tokens per second (%): 100.00 | MFU (%): 2.61 | TFLOPs: 25.83 | Fwd time: 0.0311831 | Bck time: 0.0463510
2025-05-23 02:57:45,211 - root - INFO - Step: 440 | Loss: 9.48 | Tokens per second: 2162.84 | Training tokens per second (%): 93.52 | MFU (%): 2.69 | TFLOPs: 26.56 | Fwd time: 0.0313021 | Bck time: 0.0449613
2025-05-23 02:57:45,804 - root - INFO - Step: 445 | Loss: 9.48 | Tokens per second: 2168.16 | Training tokens per second (%): 96.88 | MFU (%): 2.69 | TFLOPs: 26.63 | Fwd time: 0.0314169 | Bck time: 0.0453543
2025-05-23 02:57:46,406 - root - INFO - Step: 450 | Loss: 9.44 | Tokens per second: 2137.20 | Training tokens per second (%): 100.00 | MFU (%): 2.65 | TFLOPs: 26.25 | Fwd time: 0.0315803 | Bck time: 0.0452005
2025-05-23 02:57:46,998 - root - INFO - Step: 455 | Loss: 9.31 | Tokens per second: 2172.11 | Training tokens per second (%): 100.00 | MFU (%): 2.70 | TFLOPs: 26.68 | Fwd time: 0.0308696 | Bck time: 0.0457640
2025-05-23 02:57:47,598 - root - INFO - Step: 460 | Loss: 9.31 | Tokens per second: 2143.04 | Training tokens per second (%): 100.00 | MFU (%): 2.66 | TFLOPs: 26.32 | Fwd time: 0.0326144 | Bck time: 0.0456977
2025-05-23 02:57:48,203 - root - INFO - Step: 465 | Loss: 9.42 | Tokens per second: 2126.63 | Training tokens per second (%): 100.00 | MFU (%): 2.64 | TFLOPs: 26.12 | Fwd time: 0.0325413 | Bck time: 0.0457532
2025-05-23 02:57:48,816 - root - INFO - Step: 470 | Loss: 9.18 | Tokens per second: 2097.02 | Training tokens per second (%): 100.00 | MFU (%): 2.60 | TFLOPs: 25.75 | Fwd time: 0.0326529 | Bck time: 0.0460407
2025-05-23 02:57:49,434 - root - INFO - Step: 475 | Loss: 9.34 | Tokens per second: 2080.62 | Training tokens per second (%): 100.00 | MFU (%): 2.58 | TFLOPs: 25.55 | Fwd time: 0.0333236 | Bck time: 0.0464851
2025-05-23 02:57:50,046 - root - INFO - Step: 480 | Loss: 9.21 | Tokens per second: 2103.43 | Training tokens per second (%): 90.31 | MFU (%): 2.61 | TFLOPs: 25.83 | Fwd time: 0.0324797 | Bck time: 0.0455583
2025-05-23 02:57:50,657 - root - INFO - Step: 485 | Loss: 9.71 | Tokens per second: 2103.89 | Training tokens per second (%): 95.63 | MFU (%): 2.61 | TFLOPs: 25.84 | Fwd time: 0.0329537 | Bck time: 0.0459751
2025-05-23 02:57:51,260 - root - INFO - Step: 490 | Loss: 9.36 | Tokens per second: 2132.00 | Training tokens per second (%): 93.59 | MFU (%): 2.65 | TFLOPs: 26.18 | Fwd time: 0.0325400 | Bck time: 0.0451850
2025-05-23 02:57:51,865 - root - INFO - Step: 495 | Loss: 9.89 | Tokens per second: 2127.01 | Training tokens per second (%): 100.00 | MFU (%): 2.64 | TFLOPs: 26.12 | Fwd time: 0.0308765 | Bck time: 0.0450760
2025-05-23 02:57:52,461 - root - INFO - Step: 500 | Loss: 9.94 | Tokens per second: 2157.90 | Training tokens per second (%): 100.00 | MFU (%): 2.68 | TFLOPs: 26.50 | Fwd time: 0.0316908 | Bck time: 0.0452788
2025-05-23 02:58:10,775 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 02:58:10,778 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 02:58:11,372 - root - INFO - Step: 505 | Loss: 9.31 | Tokens per second: 67.70 | Training tokens per second (%): 96.17 | MFU (%): 0.08 | TFLOPs: 0.83 | Fwd time: 0.0311961 | Bck time: 0.0440401
2025-05-23 02:58:11,967 - root - INFO - Step: 510 | Loss: 9.87 | Tokens per second: 2160.14 | Training tokens per second (%): 100.00 | MFU (%): 2.68 | TFLOPs: 26.53 | Fwd time: 0.0316910 | Bck time: 0.0450581
2025-05-23 02:58:12,566 - root - INFO - Step: 515 | Loss: 8.63 | Tokens per second: 2150.46 | Training tokens per second (%): 100.00 | MFU (%): 2.67 | TFLOPs: 26.41 | Fwd time: 0.0317916 | Bck time: 0.0452974
2025-05-23 02:58:13,158 - root - INFO - Step: 520 | Loss: 9.18 | Tokens per second: 2169.39 | Training tokens per second (%): 88.91 | MFU (%): 2.69 | TFLOPs: 26.64 | Fwd time: 0.0307374 | Bck time: 0.0453046
2025-05-23 02:58:13,754 - root - INFO - Step: 525 | Loss: 9.03 | Tokens per second: 2159.08 | Training tokens per second (%): 91.64 | MFU (%): 2.68 | TFLOPs: 26.52 | Fwd time: 0.0315095 | Bck time: 0.0445504
2025-05-23 02:58:14,343 - root - INFO - Step: 530 | Loss: 9.34 | Tokens per second: 2182.32 | Training tokens per second (%): 100.00 | MFU (%): 2.71 | TFLOPs: 26.80 | Fwd time: 0.0307913 | Bck time: 0.0450454
2025-05-23 02:58:14,945 - root - INFO - Step: 535 | Loss: 9.47 | Tokens per second: 2136.70 | Training tokens per second (%): 100.00 | MFU (%): 2.65 | TFLOPs: 26.24 | Fwd time: 0.0302539 | Bck time: 0.0447011
2025-05-23 02:58:15,557 - root - INFO - Step: 540 | Loss: 7.83 | Tokens per second: 2102.79 | Training tokens per second (%): 99.14 | MFU (%): 2.61 | TFLOPs: 25.83 | Fwd time: 0.0330093 | Bck time: 0.0450834
2025-05-23 02:58:16,149 - root - INFO - Step: 545 | Loss: 9.48 | Tokens per second: 2174.24 | Training tokens per second (%): 100.00 | MFU (%): 2.70 | TFLOPs: 26.70 | Fwd time: 0.0315800 | Bck time: 0.0447333
2025-05-23 02:58:16,742 - root - INFO - Step: 550 | Loss: 9.48 | Tokens per second: 2166.15 | Training tokens per second (%): 67.89 | MFU (%): 2.69 | TFLOPs: 26.60 | Fwd time: 0.0321926 | Bck time: 0.0449276
2025-05-23 02:58:17,338 - root - INFO - Step: 555 | Loss: 10.16 | Tokens per second: 2159.93 | Training tokens per second (%): 87.27 | MFU (%): 2.68 | TFLOPs: 26.53 | Fwd time: 0.0312139 | Bck time: 0.0453112
2025-05-23 02:58:17,934 - root - INFO - Step: 560 | Loss: 9.82 | Tokens per second: 2156.74 | Training tokens per second (%): 92.34 | MFU (%): 2.68 | TFLOPs: 26.49 | Fwd time: 0.0321523 | Bck time: 0.0448250
2025-05-23 02:58:18,529 - root - INFO - Step: 565 | Loss: 9.26 | Tokens per second: 2161.35 | Training tokens per second (%): 76.02 | MFU (%): 2.68 | TFLOPs: 26.55 | Fwd time: 0.0312164 | Bck time: 0.0452056
2025-05-23 02:58:19,123 - root - INFO - Step: 570 | Loss: 9.81 | Tokens per second: 2164.19 | Training tokens per second (%): 95.78 | MFU (%): 2.69 | TFLOPs: 26.58 | Fwd time: 0.0319487 | Bck time: 0.0447942
2025-05-23 02:58:19,712 - root - INFO - Step: 575 | Loss: 9.10 | Tokens per second: 2186.37 | Training tokens per second (%): 100.00 | MFU (%): 2.72 | TFLOPs: 26.85 | Fwd time: 0.0314966 | Bck time: 0.0448362
2025-05-23 02:58:20,304 - root - INFO - Step: 580 | Loss: 9.36 | Tokens per second: 2172.94 | Training tokens per second (%): 81.41 | MFU (%): 2.70 | TFLOPs: 26.69 | Fwd time: 0.0318269 | Bck time: 0.0447719
2025-05-23 02:58:20,904 - root - INFO - Step: 585 | Loss: 8.62 | Tokens per second: 2141.62 | Training tokens per second (%): 94.22 | MFU (%): 2.66 | TFLOPs: 26.30 | Fwd time: 0.0327061 | Bck time: 0.0447676
2025-05-23 02:58:21,492 - root - INFO - Step: 590 | Loss: 9.39 | Tokens per second: 2186.77 | Training tokens per second (%): 88.75 | MFU (%): 2.72 | TFLOPs: 26.86 | Fwd time: 0.0312639 | Bck time: 0.0452132
2025-05-23 02:58:22,088 - root - INFO - Step: 595 | Loss: 9.29 | Tokens per second: 2160.42 | Training tokens per second (%): 78.12 | MFU (%): 2.68 | TFLOPs: 26.53 | Fwd time: 0.0315590 | Bck time: 0.0455280
2025-05-23 02:58:22,684 - root - INFO - Step: 600 | Loss: 9.11 | Tokens per second: 2155.71 | Training tokens per second (%): 100.00 | MFU (%): 2.68 | TFLOPs: 26.48 | Fwd time: 0.0313741 | Bck time: 0.0457633
2025-05-23 02:58:40,692 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 02:58:40,694 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 02:58:41,293 - root - INFO - Step: 605 | Loss: 9.43 | Tokens per second: 68.79 | Training tokens per second (%): 90.23 | MFU (%): 0.09 | TFLOPs: 0.84 | Fwd time: 0.0300345 | Bck time: 0.0450113
2025-05-23 02:58:41,888 - root - INFO - Step: 610 | Loss: 10.17 | Tokens per second: 2162.23 | Training tokens per second (%): 72.66 | MFU (%): 2.69 | TFLOPs: 26.56 | Fwd time: 0.0321530 | Bck time: 0.0458072
2025-05-23 02:58:42,479 - root - INFO - Step: 615 | Loss: 9.24 | Tokens per second: 2177.13 | Training tokens per second (%): 100.00 | MFU (%): 2.70 | TFLOPs: 26.74 | Fwd time: 0.0306601 | Bck time: 0.0461668
2025-05-23 02:58:43,072 - root - INFO - Step: 620 | Loss: 9.03 | Tokens per second: 2170.01 | Training tokens per second (%): 87.34 | MFU (%): 2.69 | TFLOPs: 26.65 | Fwd time: 0.0316925 | Bck time: 0.0454965
2025-05-23 02:58:43,668 - root - INFO - Step: 625 | Loss: 9.02 | Tokens per second: 2158.48 | Training tokens per second (%): 100.00 | MFU (%): 2.68 | TFLOPs: 26.51 | Fwd time: 0.0315710 | Bck time: 0.0455519
2025-05-23 02:58:44,262 - root - INFO - Step: 630 | Loss: 9.09 | Tokens per second: 2164.93 | Training tokens per second (%): 100.00 | MFU (%): 2.69 | TFLOPs: 26.59 | Fwd time: 0.0320663 | Bck time: 0.0446516
2025-05-23 02:58:44,864 - root - INFO - Step: 635 | Loss: 9.35 | Tokens per second: 2134.98 | Training tokens per second (%): 100.00 | MFU (%): 2.65 | TFLOPs: 26.22 | Fwd time: 0.0306616 | Bck time: 0.0448578
2025-05-23 02:58:45,452 - root - INFO - Step: 640 | Loss: 9.33 | Tokens per second: 2187.23 | Training tokens per second (%): 91.09 | MFU (%): 2.72 | TFLOPs: 26.86 | Fwd time: 0.0322957 | Bck time: 0.0446706
2025-05-23 02:58:46,045 - root - INFO - Step: 645 | Loss: 9.16 | Tokens per second: 2171.85 | Training tokens per second (%): 97.03 | MFU (%): 2.70 | TFLOPs: 26.67 | Fwd time: 0.0312619 | Bck time: 0.0447911
2025-05-23 02:58:46,645 - root - INFO - Step: 650 | Loss: 8.91 | Tokens per second: 2141.57 | Training tokens per second (%): 100.00 | MFU (%): 2.66 | TFLOPs: 26.30 | Fwd time: 0.0308390 | Bck time: 0.0452531
2025-05-23 02:58:47,246 - root - INFO - Step: 655 | Loss: 9.34 | Tokens per second: 2140.15 | Training tokens per second (%): 95.00 | MFU (%): 2.66 | TFLOPs: 26.28 | Fwd time: 0.0311098 | Bck time: 0.0450958
2025-05-23 02:58:47,833 - root - INFO - Step: 660 | Loss: 9.36 | Tokens per second: 2192.95 | Training tokens per second (%): 93.28 | MFU (%): 2.72 | TFLOPs: 26.93 | Fwd time: 0.0313839 | Bck time: 0.0448413
2025-05-23 02:58:48,435 - root - INFO - Step: 665 | Loss: 9.20 | Tokens per second: 2136.60 | Training tokens per second (%): 94.61 | MFU (%): 2.65 | TFLOPs: 26.24 | Fwd time: 0.0312430 | Bck time: 0.0456625
2025-05-23 02:58:49,038 - root - INFO - Step: 670 | Loss: 9.00 | Tokens per second: 2131.49 | Training tokens per second (%): 100.00 | MFU (%): 2.65 | TFLOPs: 26.18 | Fwd time: 0.0325263 | Bck time: 0.0457980
2025-05-23 02:58:49,635 - root - INFO - Step: 675 | Loss: 8.69 | Tokens per second: 2155.53 | Training tokens per second (%): 86.95 | MFU (%): 2.68 | TFLOPs: 26.47 | Fwd time: 0.0327830 | Bck time: 0.0444633
2025-05-23 02:58:50,223 - root - INFO - Step: 680 | Loss: 9.32 | Tokens per second: 2187.53 | Training tokens per second (%): 90.23 | MFU (%): 2.72 | TFLOPs: 26.87 | Fwd time: 0.0302775 | Bck time: 0.0452548
2025-05-23 02:58:50,809 - root - INFO - Step: 685 | Loss: 9.45 | Tokens per second: 2194.09 | Training tokens per second (%): 94.22 | MFU (%): 2.72 | TFLOPs: 26.95 | Fwd time: 0.0305573 | Bck time: 0.0453935
2025-05-23 02:58:51,396 - root - INFO - Step: 690 | Loss: 9.08 | Tokens per second: 2189.32 | Training tokens per second (%): 92.73 | MFU (%): 2.72 | TFLOPs: 26.89 | Fwd time: 0.0311714 | Bck time: 0.0462147
2025-05-23 02:58:52,000 - root - INFO - Step: 695 | Loss: 9.29 | Tokens per second: 2130.47 | Training tokens per second (%): 97.89 | MFU (%): 2.65 | TFLOPs: 26.17 | Fwd time: 0.0299220 | Bck time: 0.0460218
2025-05-23 02:58:52,608 - root - INFO - Step: 700 | Loss: 8.81 | Tokens per second: 2115.94 | Training tokens per second (%): 97.42 | MFU (%): 2.63 | TFLOPs: 25.99 | Fwd time: 0.0330593 | Bck time: 0.0458470
2025-05-23 02:59:10,260 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 02:59:10,269 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 02:59:10,928 - root - INFO - Step: 705 | Loss: 9.43 | Tokens per second: 69.88 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.86 | Fwd time: 0.0299050 | Bck time: 0.0465992
2025-05-23 02:59:11,565 - root - INFO - Step: 710 | Loss: 9.31 | Tokens per second: 2018.43 | Training tokens per second (%): 100.00 | MFU (%): 2.51 | TFLOPs: 24.79 | Fwd time: 0.0343929 | Bck time: 0.0477960
2025-05-23 02:59:12,194 - root - INFO - Step: 715 | Loss: 9.01 | Tokens per second: 2044.65 | Training tokens per second (%): 89.22 | MFU (%): 2.54 | TFLOPs: 25.11 | Fwd time: 0.0329360 | Bck time: 0.0475602
2025-05-23 02:59:12,814 - root - INFO - Step: 720 | Loss: 8.10 | Tokens per second: 2076.28 | Training tokens per second (%): 91.64 | MFU (%): 2.58 | TFLOPs: 25.50 | Fwd time: 0.0345632 | Bck time: 0.0473202
2025-05-23 02:59:13,413 - root - INFO - Step: 725 | Loss: 8.94 | Tokens per second: 2146.04 | Training tokens per second (%): 90.31 | MFU (%): 2.67 | TFLOPs: 26.36 | Fwd time: 0.0326789 | Bck time: 0.0455213
2025-05-23 02:59:14,011 - root - INFO - Step: 730 | Loss: 9.65 | Tokens per second: 2151.08 | Training tokens per second (%): 93.44 | MFU (%): 2.67 | TFLOPs: 26.42 | Fwd time: 0.0329064 | Bck time: 0.0445092
2025-05-23 02:59:14,611 - root - INFO - Step: 735 | Loss: 8.96 | Tokens per second: 2145.43 | Training tokens per second (%): 78.20 | MFU (%): 2.66 | TFLOPs: 26.35 | Fwd time: 0.0318457 | Bck time: 0.0455773
2025-05-23 02:59:15,212 - root - INFO - Step: 740 | Loss: 9.47 | Tokens per second: 2140.42 | Training tokens per second (%): 99.92 | MFU (%): 2.66 | TFLOPs: 26.29 | Fwd time: 0.0301022 | Bck time: 0.0445997
2025-05-23 02:59:15,795 - root - INFO - Step: 745 | Loss: 9.36 | Tokens per second: 2204.98 | Training tokens per second (%): 78.75 | MFU (%): 2.74 | TFLOPs: 27.08 | Fwd time: 0.0304497 | Bck time: 0.0454295
2025-05-23 02:59:16,381 - root - INFO - Step: 750 | Loss: 9.68 | Tokens per second: 2195.75 | Training tokens per second (%): 100.00 | MFU (%): 2.73 | TFLOPs: 26.97 | Fwd time: 0.0301146 | Bck time: 0.0454278
2025-05-23 02:59:16,964 - root - INFO - Step: 755 | Loss: 9.37 | Tokens per second: 2205.80 | Training tokens per second (%): 100.00 | MFU (%): 2.74 | TFLOPs: 27.09 | Fwd time: 0.0300104 | Bck time: 0.0451337
2025-05-23 02:59:17,553 - root - INFO - Step: 760 | Loss: 9.74 | Tokens per second: 2184.81 | Training tokens per second (%): 100.00 | MFU (%): 2.71 | TFLOPs: 26.83 | Fwd time: 0.0309803 | Bck time: 0.0456914
2025-05-23 02:59:18,158 - root - INFO - Step: 765 | Loss: 9.23 | Tokens per second: 2124.76 | Training tokens per second (%): 100.00 | MFU (%): 2.64 | TFLOPs: 26.10 | Fwd time: 0.0285138 | Bck time: 0.0457599
2025-05-23 02:59:18,747 - root - INFO - Step: 770 | Loss: 8.74 | Tokens per second: 2182.36 | Training tokens per second (%): 100.00 | MFU (%): 2.71 | TFLOPs: 26.80 | Fwd time: 0.0318949 | Bck time: 0.0444125
2025-05-23 02:59:19,349 - root - INFO - Step: 775 | Loss: 8.86 | Tokens per second: 2136.44 | Training tokens per second (%): 90.39 | MFU (%): 2.65 | TFLOPs: 26.24 | Fwd time: 0.0288268 | Bck time: 0.0455572
2025-05-23 02:59:19,941 - root - INFO - Step: 780 | Loss: 9.79 | Tokens per second: 2172.48 | Training tokens per second (%): 99.45 | MFU (%): 2.70 | TFLOPs: 26.68 | Fwd time: 0.0321050 | Bck time: 0.0457166
2025-05-23 02:59:20,537 - root - INFO - Step: 785 | Loss: 8.76 | Tokens per second: 2160.53 | Training tokens per second (%): 100.00 | MFU (%): 2.68 | TFLOPs: 26.54 | Fwd time: 0.0300021 | Bck time: 0.0460929
2025-05-23 02:59:21,135 - root - INFO - Step: 790 | Loss: 9.42 | Tokens per second: 2150.15 | Training tokens per second (%): 100.00 | MFU (%): 2.67 | TFLOPs: 26.41 | Fwd time: 0.0310600 | Bck time: 0.0464370
2025-05-23 02:59:21,742 - root - INFO - Step: 795 | Loss: 8.43 | Tokens per second: 2117.06 | Training tokens per second (%): 100.00 | MFU (%): 2.63 | TFLOPs: 26.00 | Fwd time: 0.0309416 | Bck time: 0.0453396
2025-05-23 02:59:22,329 - root - INFO - Step: 800 | Loss: 8.77 | Tokens per second: 2194.18 | Training tokens per second (%): 89.14 | MFU (%): 2.72 | TFLOPs: 26.95 | Fwd time: 0.0304083 | Bck time: 0.0437634
2025-05-23 02:59:40,357 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 02:59:40,359 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 02:59:40,955 - root - INFO - Step: 805 | Loss: 8.86 | Tokens per second: 68.73 | Training tokens per second (%): 98.98 | MFU (%): 0.09 | TFLOPs: 0.84 | Fwd time: 0.0306601 | Bck time: 0.0445016
2025-05-23 02:59:41,540 - root - INFO - Step: 810 | Loss: 9.15 | Tokens per second: 2201.72 | Training tokens per second (%): 91.17 | MFU (%): 2.73 | TFLOPs: 27.04 | Fwd time: 0.0305314 | Bck time: 0.0449349
2025-05-23 02:59:42,126 - root - INFO - Step: 815 | Loss: 9.43 | Tokens per second: 2194.87 | Training tokens per second (%): 96.72 | MFU (%): 2.73 | TFLOPs: 26.96 | Fwd time: 0.0289682 | Bck time: 0.0420829
2025-05-23 02:59:42,715 - root - INFO - Step: 820 | Loss: 9.19 | Tokens per second: 2182.22 | Training tokens per second (%): 90.00 | MFU (%): 2.71 | TFLOPs: 26.80 | Fwd time: 0.0308536 | Bck time: 0.0442030
2025-05-23 02:59:43,303 - root - INFO - Step: 825 | Loss: 9.11 | Tokens per second: 2186.92 | Training tokens per second (%): 100.00 | MFU (%): 2.72 | TFLOPs: 26.86 | Fwd time: 0.0294337 | Bck time: 0.0453670
2025-05-23 02:59:43,890 - root - INFO - Step: 830 | Loss: 8.91 | Tokens per second: 2191.43 | Training tokens per second (%): 92.11 | MFU (%): 2.72 | TFLOPs: 26.91 | Fwd time: 0.0313417 | Bck time: 0.0447196
2025-05-23 02:59:44,471 - root - INFO - Step: 835 | Loss: 9.07 | Tokens per second: 2214.23 | Training tokens per second (%): 98.59 | MFU (%): 2.75 | TFLOPs: 27.19 | Fwd time: 0.0306364 | Bck time: 0.0451088
2025-05-23 02:59:45,055 - root - INFO - Step: 840 | Loss: 9.28 | Tokens per second: 2205.07 | Training tokens per second (%): 89.61 | MFU (%): 2.74 | TFLOPs: 27.08 | Fwd time: 0.0313442 | Bck time: 0.0451720
2025-05-23 02:59:45,631 - root - INFO - Step: 845 | Loss: 8.93 | Tokens per second: 2232.99 | Training tokens per second (%): 100.00 | MFU (%): 2.77 | TFLOPs: 27.42 | Fwd time: 0.0308720 | Bck time: 0.0444208
2025-05-23 02:59:46,216 - root - INFO - Step: 850 | Loss: 8.80 | Tokens per second: 2196.38 | Training tokens per second (%): 95.47 | MFU (%): 2.73 | TFLOPs: 26.98 | Fwd time: 0.0317269 | Bck time: 0.0448887
2025-05-23 02:59:46,807 - root - INFO - Step: 855 | Loss: 8.88 | Tokens per second: 2175.99 | Training tokens per second (%): 100.00 | MFU (%): 2.70 | TFLOPs: 26.72 | Fwd time: 0.0306820 | Bck time: 0.0458187
2025-05-23 02:59:47,394 - root - INFO - Step: 860 | Loss: 9.10 | Tokens per second: 2194.36 | Training tokens per second (%): 82.66 | MFU (%): 2.73 | TFLOPs: 26.95 | Fwd time: 0.0318253 | Bck time: 0.0446119
2025-05-23 02:59:47,978 - root - INFO - Step: 865 | Loss: 8.51 | Tokens per second: 2200.67 | Training tokens per second (%): 99.38 | MFU (%): 2.73 | TFLOPs: 27.03 | Fwd time: 0.0307227 | Bck time: 0.0452478
2025-05-23 02:59:48,564 - root - INFO - Step: 870 | Loss: 8.75 | Tokens per second: 2193.95 | Training tokens per second (%): 100.00 | MFU (%): 2.72 | TFLOPs: 26.95 | Fwd time: 0.0303036 | Bck time: 0.0447437
2025-05-23 02:59:49,155 - root - INFO - Step: 875 | Loss: 8.73 | Tokens per second: 2178.63 | Training tokens per second (%): 90.55 | MFU (%): 2.71 | TFLOPs: 26.76 | Fwd time: 0.0311551 | Bck time: 0.0453359
2025-05-23 02:59:49,740 - root - INFO - Step: 880 | Loss: 9.47 | Tokens per second: 2197.93 | Training tokens per second (%): 100.00 | MFU (%): 2.73 | TFLOPs: 26.99 | Fwd time: 0.0312328 | Bck time: 0.0454448
2025-05-23 02:59:50,331 - root - INFO - Step: 885 | Loss: 8.47 | Tokens per second: 2175.36 | Training tokens per second (%): 96.41 | MFU (%): 2.70 | TFLOPs: 26.72 | Fwd time: 0.0311059 | Bck time: 0.0448901
2025-05-23 02:59:50,918 - root - INFO - Step: 890 | Loss: 9.13 | Tokens per second: 2191.28 | Training tokens per second (%): 100.00 | MFU (%): 2.72 | TFLOPs: 26.91 | Fwd time: 0.0311927 | Bck time: 0.0449198
2025-05-23 02:59:51,506 - root - INFO - Step: 895 | Loss: 9.38 | Tokens per second: 2187.68 | Training tokens per second (%): 97.11 | MFU (%): 2.72 | TFLOPs: 26.87 | Fwd time: 0.0313909 | Bck time: 0.0450623
2025-05-23 02:59:52,101 - root - INFO - Step: 900 | Loss: 9.05 | Tokens per second: 2164.11 | Training tokens per second (%): 90.39 | MFU (%): 2.69 | TFLOPs: 26.58 | Fwd time: 0.0318890 | Bck time: 0.0446709
2025-05-23 03:00:09,570 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 03:00:09,571 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 03:00:10,169 - root - INFO - Step: 905 | Loss: 9.41 | Tokens per second: 70.85 | Training tokens per second (%): 89.92 | MFU (%): 0.09 | TFLOPs: 0.87 | Fwd time: 0.0311568 | Bck time: 0.0441241
2025-05-23 03:00:10,755 - root - INFO - Step: 910 | Loss: 8.46 | Tokens per second: 2193.73 | Training tokens per second (%): 100.00 | MFU (%): 2.72 | TFLOPs: 26.94 | Fwd time: 0.0316248 | Bck time: 0.0446889
2025-05-23 03:00:11,344 - root - INFO - Step: 915 | Loss: 8.85 | Tokens per second: 2184.57 | Training tokens per second (%): 95.70 | MFU (%): 2.71 | TFLOPs: 26.83 | Fwd time: 0.0305197 | Bck time: 0.0448011
2025-05-23 03:00:11,935 - root - INFO - Step: 920 | Loss: 8.86 | Tokens per second: 2178.20 | Training tokens per second (%): 100.00 | MFU (%): 2.70 | TFLOPs: 26.75 | Fwd time: 0.0320394 | Bck time: 0.0452422
2025-05-23 03:00:12,532 - root - INFO - Step: 925 | Loss: 8.68 | Tokens per second: 2152.46 | Training tokens per second (%): 86.56 | MFU (%): 2.67 | TFLOPs: 26.44 | Fwd time: 0.0319491 | Bck time: 0.0453164
2025-05-23 03:00:13,128 - root - INFO - Step: 930 | Loss: 9.15 | Tokens per second: 2158.84 | Training tokens per second (%): 89.38 | MFU (%): 2.68 | TFLOPs: 26.51 | Fwd time: 0.0309504 | Bck time: 0.0456826
2025-05-23 03:00:13,717 - root - INFO - Step: 935 | Loss: 9.08 | Tokens per second: 2182.03 | Training tokens per second (%): 100.00 | MFU (%): 2.71 | TFLOPs: 26.80 | Fwd time: 0.0308446 | Bck time: 0.0439799
2025-05-23 03:00:14,308 - root - INFO - Step: 940 | Loss: 8.01 | Tokens per second: 2177.65 | Training tokens per second (%): 100.00 | MFU (%): 2.70 | TFLOPs: 26.75 | Fwd time: 0.0314053 | Bck time: 0.0447010
2025-05-23 03:00:14,904 - root - INFO - Step: 945 | Loss: 8.89 | Tokens per second: 2159.25 | Training tokens per second (%): 100.00 | MFU (%): 2.68 | TFLOPs: 26.52 | Fwd time: 0.0308902 | Bck time: 0.0443725
2025-05-23 03:00:15,510 - root - INFO - Step: 950 | Loss: 8.37 | Tokens per second: 2121.95 | Training tokens per second (%): 87.50 | MFU (%): 2.64 | TFLOPs: 26.06 | Fwd time: 0.0338441 | Bck time: 0.0455017
2025-05-23 03:00:16,108 - root - INFO - Step: 955 | Loss: 8.46 | Tokens per second: 2149.28 | Training tokens per second (%): 92.42 | MFU (%): 2.67 | TFLOPs: 26.40 | Fwd time: 0.0318550 | Bck time: 0.0460283
2025-05-23 03:00:16,712 - root - INFO - Step: 960 | Loss: 9.53 | Tokens per second: 2127.92 | Training tokens per second (%): 93.05 | MFU (%): 2.64 | TFLOPs: 26.13 | Fwd time: 0.0321438 | Bck time: 0.0463731
2025-05-23 03:00:17,307 - root - INFO - Step: 965 | Loss: 9.00 | Tokens per second: 2161.61 | Training tokens per second (%): 92.97 | MFU (%): 2.68 | TFLOPs: 26.55 | Fwd time: 0.0310597 | Bck time: 0.0456230
2025-05-23 03:00:17,901 - root - INFO - Step: 970 | Loss: 8.94 | Tokens per second: 2168.90 | Training tokens per second (%): 96.33 | MFU (%): 2.69 | TFLOPs: 26.64 | Fwd time: 0.0318925 | Bck time: 0.0447207
2025-05-23 03:00:18,489 - root - INFO - Step: 975 | Loss: 8.49 | Tokens per second: 2187.44 | Training tokens per second (%): 92.97 | MFU (%): 2.72 | TFLOPs: 26.87 | Fwd time: 0.0303550 | Bck time: 0.0449573
2025-05-23 03:00:19,100 - root - INFO - Step: 980 | Loss: 9.11 | Tokens per second: 2103.34 | Training tokens per second (%): 100.00 | MFU (%): 2.61 | TFLOPs: 25.83 | Fwd time: 0.0321772 | Bck time: 0.0447115
2025-05-23 03:00:19,685 - root - INFO - Step: 985 | Loss: 8.77 | Tokens per second: 2197.82 | Training tokens per second (%): 100.00 | MFU (%): 2.73 | TFLOPs: 26.99 | Fwd time: 0.0303978 | Bck time: 0.0446713
2025-05-23 03:00:20,275 - root - INFO - Step: 990 | Loss: 9.08 | Tokens per second: 2178.96 | Training tokens per second (%): 96.09 | MFU (%): 2.71 | TFLOPs: 26.76 | Fwd time: 0.0316060 | Bck time: 0.0453474
2025-05-23 03:00:20,878 - root - INFO - Step: 995 | Loss: 9.24 | Tokens per second: 2134.18 | Training tokens per second (%): 93.20 | MFU (%): 2.65 | TFLOPs: 26.21 | Fwd time: 0.0315247 | Bck time: 0.0459662
2025-05-23 03:00:21,477 - root - INFO - Step: 1000 | Loss: 8.55 | Tokens per second: 2147.73 | Training tokens per second (%): 100.00 | MFU (%): 2.67 | TFLOPs: 26.38 | Fwd time: 0.0327684 | Bck time: 0.0455905
2025-05-23 03:00:40,607 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 03:00:40,609 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
total_size: 6845503780, bsize: 6845503780, ratio: 2.0
6845503780 2 False
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 321.3198184967041 ms
CPU copy took 16281.896114349365 ms
---------------------- [PERF] Single Checkpoint time is 16.623992443084717 sec, average is 16.623988151550293
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 284.08098220825195 ms
CPU copy took 16732.73754119873 ms
---------------------- [PERF] Single Checkpoint time is 17.03743624687195 sec, average is 16.830710411071777
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 284.7726345062256 ms
CPU copy took 19764.458894729614 ms
---------------------- [PERF] Single Checkpoint time is 20.06975817680359 sec, average is 17.03743267059326
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 320.50132751464844 ms
CPU copy took 15237.84589767456 ms
---------------------- [PERF] Single Checkpoint time is 15.578941345214844 sec, average is 16.830710411071777
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 284.6794128417969 ms
CPU copy took 15045.776844024658 ms
---------------------- [PERF] Single Checkpoint time is 15.35107970237732 sec, average is 16.623988151550293
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 284.70492362976074 ms
CPU copy took 16647.308111190796 ms
---------------------- [PERF] Single Checkpoint time is 16.952632665634155 sec, average is 16.78830850124359
---- exit
PR_ADDR_DATA is 0x4014c0410000, PR_ADDR is 0x4014c0190000, PEER_CHECK_ADDR is 0x4014c0210000
--------------- init enqueue: 0
--------------- init enqueue: 1
Call dram.alloc, num_batches is 2, batch_size_floats is 6845503780
------------------------- is_distributed is 0, rank is 0
Parall_iter 0, Write new metadata at address 0x4014c0310000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 12, parall_iter is 0, num_threads is 1, last counter is 0, curr_counter is 1
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x4014c0410000, curr_pr_arr is 0x4014c0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x4014c0410000!
Thread ID: 1, savenvm_thread_nd took 16171.179246 ms
Thread ID: 1, set_cpu took 0.104413 ms
Threads took 16171.513732 ms
MSYNC 27382015120 TOOK 102.706152 ms
CAS was successful! new counter is 1, is_distributed is 0
******** checkp_info saved in 0x4014c0310000, curr_checkpoint is 0x4014c0310000
0, 1
Parall_iter 1, Write new metadata at address 0x4014c0390000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 72, parall_iter is 1, num_threads is 1, last counter is 1, curr_counter is 2
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401b205a0000, curr_pr_arr is 0x401b205a0000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401b205a0000!
Thread ID: 2, savenvm_thread_nd took 16650.459138 ms
Thread ID: 2, set_cpu took 0.083485 ms
Threads took 16650.719353 ms
MSYNC 27382015120 TOOK 75.841181 ms
CAS was successful! new counter is 2, is_distributed is 0
******** checkp_info saved in 0x4014c0390000, curr_checkpoint is 0x4014c0390000
1, 2
Parall_iter 0, Write new metadata at address 0x4014c0310000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 21, parall_iter is 0, num_threads is 1, last counter is 2, curr_counter is 3
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x4014c0410000, curr_pr_arr is 0x4014c0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x4014c0410000!
Thread ID: 1, savenvm_thread_nd took 19701.626307 ms
Thread ID: 1, set_cpu took 0.088286 ms
Threads took 19701.900026 ms
MSYNC 27382015120 TOOK 56.140327 ms
CAS was successful! new counter is 3, is_distributed is 0
******** checkp_info saved in 0x4014c0310000, curr_checkpoint is 0x4014c0310000
0, 3
Parall_iter 1, Write new metadata at address 0x4014c0390000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 97, parall_iter is 1, num_threads is 1, last counter is 3, curr_counter is 4
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401b205a0000, curr_pr_arr is 0x401b205a0000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401b205a0000!
Thread ID: 2, savenvm_thread_nd took 15193.630477 ms
Thread ID: 2, set_cpu took 0.098620 ms
Threads took 15193.923491 ms
MSYNC 27382015120 TOOK 37.354930 ms
CAS was successful! new counter is 4, is_distributed is 0
******** checkp_info saved in 0x4014c0390000, curr_checkpoint is 0x4014c0390000
1, 4
Parall_iter 0, Write new metadata at address 0x4014c0310000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 54, parall_iter is 0, num_threads is 1, last counter is 4, curr_counter is 5
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x4014c0410000, curr_pr_arr is 0x4014c0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x4014c0410000!
Thread ID: 1, savenvm_thread_nd took 14559.117331 ms
Thread ID: 1, set_cpu took 0.083581 ms
Threads took 14559.382410 ms
MSYNC 27382015120 TOOK 479.955805 ms
CAS was successful! new counter is 5, is_distributed is 0
******** checkp_info saved in 0x4014c0310000, curr_checkpoint is 0x4014c0310000
0, 5
Parall_iter 1, Write new metadata at address 0x4014c0390000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 119, parall_iter is 1, num_threads is 1, last counter is 5, curr_counter is 6
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401b205a0000, curr_pr_arr is 0x401b205a0000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401b205a0000!
Thread ID: 2, savenvm_thread_nd took 16574.915359 ms
Thread ID: 2, set_cpu took 0.092797 ms
Threads took 16575.196469 ms
MSYNC 27382015120 TOOK 66.498065 ms
CAS was successful! new counter is 6, is_distributed is 0
******** checkp_info saved in 0x4014c0390000, curr_checkpoint is 0x4014c0390000
1, 6
2025-05-23 03:00:50,505 - root - INFO - Training completed
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
0, 3, 0
1, 4, 3
max_piter is 1
Writing offset is 39792, parall_iter_offset is 6845513728
data_offset is 27384676352
