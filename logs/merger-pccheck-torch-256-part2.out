2025-05-22 17:58:02,221 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=256, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=1000, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, seed=4, checkpoint_dir='/iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts', loss_file='/iopsstor/scratch/cscs/bkundu/lsai-merger/results/bf16/loss-pccheck-torch-256-part2.csv', checkpoint_freq=100, max_async=1, warmup=3, load_checkpoint=True, non_blocking=False)
2025-05-22 17:58:02,226 - root - INFO - Random state checkpoint loaded from /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-22 17:58:02,226 - root - INFO - Training will resume from step: 400
2025-05-22 17:58:02,226 - root - INFO - Setting up DataLoaders...
2025-05-22 17:58:03,630 - root - INFO - Setting up Model...
2025-05-22 17:58:08,251 - root - INFO - Loading checkpoint model, optimizer + scheduler
/iopsstor/scratch/cscs/bkundu/lsai-merger/LSAI-Checkpointing/training/utils.py:85: UserWarning: The given buffer is not writable, and PyTorch does not support non-writable tensors. This means you can write to the underlying (supposedly non-writable) buffer using the tensor. You may want to copy the buffer to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at /opt/pytorch/pytorch/torch/csrc/utils/tensor_new.cpp:1561.)
  data = torch.frombuffer(payload, dtype=torch.float32)
2025-05-22 17:58:09,588 - root - INFO - Checkpoint loaded from /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/checkpoint_pccheck.pt
2025-05-22 17:58:09,594 - root - INFO - Loaded optimizer, scheduler checkpoint at step 400 in 1.34 seconds
Model size: 97534208, Optimizer size: 195068708, Total size: 292602916
BSIZE IS 292602916
At checkpoint, bsize is 292602916
2025-05-22 17:58:14,824 - root - INFO - Checkpointing warmup done
2025-05-22 17:58:14,826 - root - INFO - ------------------------------------------------------------Starting training!
2025-05-22 17:58:15,611 - root - INFO - Step: 405 | Loss: 11.75 | Tokens per second: 1630.80 | Training tokens per second (%): 87.97 | MFU (%): 0.07 | TFLOPs: 0.67 | Fwd time: 0.0322607 | Bck time: 0.0437193
2025-05-22 17:58:16,161 - root - INFO - Step: 410 | Loss: 11.73 | Tokens per second: 2327.28 | Training tokens per second (%): 100.00 | MFU (%): 0.10 | TFLOPs: 0.95 | Fwd time: 0.0312535 | Bck time: 0.0439032
2025-05-22 17:58:16,724 - root - INFO - Step: 415 | Loss: 11.79 | Tokens per second: 2276.43 | Training tokens per second (%): 93.98 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0315179 | Bck time: 0.0443410
2025-05-22 17:58:17,286 - root - INFO - Step: 420 | Loss: 11.82 | Tokens per second: 2276.57 | Training tokens per second (%): 91.80 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0326410 | Bck time: 0.0446649
2025-05-22 17:58:17,846 - root - INFO - Step: 425 | Loss: 11.73 | Tokens per second: 2287.54 | Training tokens per second (%): 96.25 | MFU (%): 0.09 | TFLOPs: 0.94 | Fwd time: 0.0322427 | Bck time: 0.0442382
2025-05-22 17:58:18,400 - root - INFO - Step: 430 | Loss: 11.82 | Tokens per second: 2311.47 | Training tokens per second (%): 100.00 | MFU (%): 0.10 | TFLOPs: 0.95 | Fwd time: 0.0311465 | Bck time: 0.0449467
2025-05-22 17:58:18,977 - root - INFO - Step: 435 | Loss: 11.75 | Tokens per second: 2219.81 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.91 | Fwd time: 0.0315276 | Bck time: 0.0448018
2025-05-22 17:58:19,536 - root - INFO - Step: 440 | Loss: 11.73 | Tokens per second: 2294.81 | Training tokens per second (%): 93.52 | MFU (%): 0.09 | TFLOPs: 0.94 | Fwd time: 0.0314094 | Bck time: 0.0446430
2025-05-22 17:58:20,098 - root - INFO - Step: 445 | Loss: 11.70 | Tokens per second: 2275.39 | Training tokens per second (%): 96.88 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0311798 | Bck time: 0.0448769
2025-05-22 17:58:20,660 - root - INFO - Step: 450 | Loss: 11.75 | Tokens per second: 2280.93 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0304839 | Bck time: 0.0450203
2025-05-22 17:58:21,229 - root - INFO - Step: 455 | Loss: 11.77 | Tokens per second: 2252.06 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0321121 | Bck time: 0.0443589
2025-05-22 17:58:21,790 - root - INFO - Step: 460 | Loss: 11.73 | Tokens per second: 2283.01 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0324059 | Bck time: 0.0441786
2025-05-22 17:58:22,351 - root - INFO - Step: 465 | Loss: 11.71 | Tokens per second: 2280.15 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0311539 | Bck time: 0.0448055
2025-05-22 17:58:22,914 - root - INFO - Step: 470 | Loss: 11.66 | Tokens per second: 2274.96 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0316103 | Bck time: 0.0445042
2025-05-22 17:58:23,479 - root - INFO - Step: 475 | Loss: 11.77 | Tokens per second: 2269.79 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0313794 | Bck time: 0.0441104
2025-05-22 17:58:24,037 - root - INFO - Step: 480 | Loss: 11.75 | Tokens per second: 2292.02 | Training tokens per second (%): 90.31 | MFU (%): 0.09 | TFLOPs: 0.94 | Fwd time: 0.0313652 | Bck time: 0.0448793
2025-05-22 17:58:24,594 - root - INFO - Step: 485 | Loss: 11.80 | Tokens per second: 2302.42 | Training tokens per second (%): 95.62 | MFU (%): 0.10 | TFLOPs: 0.94 | Fwd time: 0.0321421 | Bck time: 0.0438223
2025-05-22 17:58:25,145 - root - INFO - Step: 490 | Loss: 11.78 | Tokens per second: 2321.55 | Training tokens per second (%): 93.59 | MFU (%): 0.10 | TFLOPs: 0.95 | Fwd time: 0.0322327 | Bck time: 0.0438103
2025-05-22 17:58:25,713 - root - INFO - Step: 495 | Loss: 11.83 | Tokens per second: 2253.98 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0322811 | Bck time: 0.0438941
2025-05-22 17:58:26,274 - root - INFO - Step: 500 | Loss: 11.74 | Tokens per second: 2285.85 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.94 | Fwd time: 0.0312613 | Bck time: 0.0439955
2025-05-22 17:58:26,672 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-22 17:58:26,678 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-22 17:58:27,285 - root - INFO - Step: 505 | Loss: 11.77 | Tokens per second: 1266.71 | Training tokens per second (%): 96.17 | MFU (%): 0.05 | TFLOPs: 0.52 | Fwd time: 0.0322714 | Bck time: 0.0443661
2025-05-22 17:58:27,844 - root - INFO - Step: 510 | Loss: 11.81 | Tokens per second: 2290.27 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.94 | Fwd time: 0.0333869 | Bck time: 0.0441079
2025-05-22 17:58:28,404 - root - INFO - Step: 515 | Loss: 11.61 | Tokens per second: 2287.02 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.94 | Fwd time: 0.0315699 | Bck time: 0.0438004
2025-05-22 17:58:28,967 - root - INFO - Step: 520 | Loss: 11.76 | Tokens per second: 2274.57 | Training tokens per second (%): 88.91 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0319702 | Bck time: 0.0450438
2025-05-22 17:58:29,530 - root - INFO - Step: 525 | Loss: 11.76 | Tokens per second: 2276.46 | Training tokens per second (%): 91.64 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0317046 | Bck time: 0.0446020
2025-05-22 17:58:30,091 - root - INFO - Step: 530 | Loss: 11.72 | Tokens per second: 2283.59 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0316880 | Bck time: 0.0437165
2025-05-22 17:58:30,671 - root - INFO - Step: 535 | Loss: 11.70 | Tokens per second: 2205.93 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.90 | Fwd time: 0.0314085 | Bck time: 0.0443245
2025-05-22 17:58:31,246 - root - INFO - Step: 540 | Loss: 11.53 | Tokens per second: 2228.14 | Training tokens per second (%): 99.14 | MFU (%): 0.09 | TFLOPs: 0.91 | Fwd time: 0.0314463 | Bck time: 0.0443496
2025-05-22 17:58:31,817 - root - INFO - Step: 545 | Loss: 11.82 | Tokens per second: 2240.90 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0323394 | Bck time: 0.0444465
2025-05-22 17:58:32,377 - root - INFO - Step: 550 | Loss: 11.79 | Tokens per second: 2290.32 | Training tokens per second (%): 67.89 | MFU (%): 0.09 | TFLOPs: 0.94 | Fwd time: 0.0316766 | Bck time: 0.0453143
2025-05-22 17:58:32,935 - root - INFO - Step: 555 | Loss: 11.83 | Tokens per second: 2294.99 | Training tokens per second (%): 87.27 | MFU (%): 0.09 | TFLOPs: 0.94 | Fwd time: 0.0312897 | Bck time: 0.0443934
2025-05-22 17:58:33,497 - root - INFO - Step: 560 | Loss: 11.81 | Tokens per second: 2277.74 | Training tokens per second (%): 92.34 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0320429 | Bck time: 0.0435307
2025-05-22 17:58:34,048 - root - INFO - Step: 565 | Loss: 11.68 | Tokens per second: 2325.25 | Training tokens per second (%): 76.02 | MFU (%): 0.10 | TFLOPs: 0.95 | Fwd time: 0.0323310 | Bck time: 0.0440006
2025-05-22 17:58:34,602 - root - INFO - Step: 570 | Loss: 11.76 | Tokens per second: 2309.34 | Training tokens per second (%): 95.78 | MFU (%): 0.10 | TFLOPs: 0.94 | Fwd time: 0.0321359 | Bck time: 0.0444684
2025-05-22 17:58:35,160 - root - INFO - Step: 575 | Loss: 11.67 | Tokens per second: 2295.06 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.94 | Fwd time: 0.0317639 | Bck time: 0.0437947
2025-05-22 17:58:35,710 - root - INFO - Step: 580 | Loss: 11.64 | Tokens per second: 2331.00 | Training tokens per second (%): 81.41 | MFU (%): 0.10 | TFLOPs: 0.95 | Fwd time: 0.0312652 | Bck time: 0.0441131
2025-05-22 17:58:36,267 - root - INFO - Step: 585 | Loss: 11.83 | Tokens per second: 2299.91 | Training tokens per second (%): 94.22 | MFU (%): 0.10 | TFLOPs: 0.94 | Fwd time: 0.0316295 | Bck time: 0.0441142
2025-05-22 17:58:36,826 - root - INFO - Step: 590 | Loss: 11.74 | Tokens per second: 2290.66 | Training tokens per second (%): 88.75 | MFU (%): 0.09 | TFLOPs: 0.94 | Fwd time: 0.0319608 | Bck time: 0.0439962
2025-05-22 17:58:37,382 - root - INFO - Step: 595 | Loss: 11.77 | Tokens per second: 2301.51 | Training tokens per second (%): 78.12 | MFU (%): 0.10 | TFLOPs: 0.94 | Fwd time: 0.0315145 | Bck time: 0.0443457
2025-05-22 17:58:37,939 - root - INFO - Step: 600 | Loss: 11.65 | Tokens per second: 2302.82 | Training tokens per second (%): 100.00 | MFU (%): 0.10 | TFLOPs: 0.94 | Fwd time: 0.0317236 | Bck time: 0.0448013
2025-05-22 17:58:38,360 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-22 17:58:38,363 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-22 17:58:38,982 - root - INFO - Step: 605 | Loss: 11.69 | Tokens per second: 1227.51 | Training tokens per second (%): 90.23 | MFU (%): 0.05 | TFLOPs: 0.50 | Fwd time: 0.0314709 | Bck time: 0.0446582
2025-05-22 17:58:39,547 - root - INFO - Step: 610 | Loss: 11.83 | Tokens per second: 2265.94 | Training tokens per second (%): 72.66 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0324394 | Bck time: 0.0452094
2025-05-22 17:58:40,113 - root - INFO - Step: 615 | Loss: 11.78 | Tokens per second: 2264.79 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0312046 | Bck time: 0.0438823
2025-05-22 17:58:40,673 - root - INFO - Step: 620 | Loss: 11.72 | Tokens per second: 2284.35 | Training tokens per second (%): 87.34 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0313618 | Bck time: 0.0445166
2025-05-22 17:58:41,241 - root - INFO - Step: 625 | Loss: 11.73 | Tokens per second: 2257.54 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0334823 | Bck time: 0.0451392
2025-05-22 17:58:41,816 - root - INFO - Step: 630 | Loss: 11.74 | Tokens per second: 2227.43 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.91 | Fwd time: 0.0334433 | Bck time: 0.0445341
2025-05-22 17:58:42,397 - root - INFO - Step: 635 | Loss: 11.73 | Tokens per second: 2204.33 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.90 | Fwd time: 0.0329745 | Bck time: 0.0451361
2025-05-22 17:58:42,969 - root - INFO - Step: 640 | Loss: 11.67 | Tokens per second: 2236.31 | Training tokens per second (%): 91.09 | MFU (%): 0.09 | TFLOPs: 0.91 | Fwd time: 0.0333591 | Bck time: 0.0439827
2025-05-22 17:58:43,543 - root - INFO - Step: 645 | Loss: 11.76 | Tokens per second: 2230.69 | Training tokens per second (%): 97.03 | MFU (%): 0.09 | TFLOPs: 0.91 | Fwd time: 0.0333164 | Bck time: 0.0442667
2025-05-22 17:58:44,130 - root - INFO - Step: 650 | Loss: 11.65 | Tokens per second: 2182.57 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.89 | Fwd time: 0.0334377 | Bck time: 0.0446569
2025-05-22 17:58:44,714 - root - INFO - Step: 655 | Loss: 11.79 | Tokens per second: 2192.32 | Training tokens per second (%): 95.00 | MFU (%): 0.09 | TFLOPs: 0.90 | Fwd time: 0.0335441 | Bck time: 0.0442207
2025-05-22 17:58:45,289 - root - INFO - Step: 660 | Loss: 11.80 | Tokens per second: 2229.69 | Training tokens per second (%): 93.28 | MFU (%): 0.09 | TFLOPs: 0.91 | Fwd time: 0.0338310 | Bck time: 0.0446063
2025-05-22 17:58:45,876 - root - INFO - Step: 665 | Loss: 11.82 | Tokens per second: 2181.59 | Training tokens per second (%): 94.61 | MFU (%): 0.09 | TFLOPs: 0.89 | Fwd time: 0.0332525 | Bck time: 0.0445722
2025-05-22 17:58:46,448 - root - INFO - Step: 670 | Loss: 11.66 | Tokens per second: 2236.21 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.91 | Fwd time: 0.0340360 | Bck time: 0.0434587
2025-05-22 17:58:47,018 - root - INFO - Step: 675 | Loss: 11.65 | Tokens per second: 2249.92 | Training tokens per second (%): 86.95 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0332431 | Bck time: 0.0451565
2025-05-22 17:58:47,591 - root - INFO - Step: 680 | Loss: 11.76 | Tokens per second: 2235.43 | Training tokens per second (%): 90.23 | MFU (%): 0.09 | TFLOPs: 0.91 | Fwd time: 0.0325696 | Bck time: 0.0448872
2025-05-22 17:58:48,148 - root - INFO - Step: 685 | Loss: 11.71 | Tokens per second: 2298.76 | Training tokens per second (%): 94.22 | MFU (%): 0.10 | TFLOPs: 0.94 | Fwd time: 0.0323159 | Bck time: 0.0444129
2025-05-22 17:58:48,704 - root - INFO - Step: 690 | Loss: 11.75 | Tokens per second: 2301.13 | Training tokens per second (%): 92.73 | MFU (%): 0.10 | TFLOPs: 0.94 | Fwd time: 0.0321773 | Bck time: 0.0443951
2025-05-22 17:58:49,287 - root - INFO - Step: 695 | Loss: 11.76 | Tokens per second: 2200.03 | Training tokens per second (%): 97.89 | MFU (%): 0.09 | TFLOPs: 0.90 | Fwd time: 0.0320674 | Bck time: 0.0446598
2025-05-22 17:58:49,846 - root - INFO - Step: 700 | Loss: 11.55 | Tokens per second: 2287.22 | Training tokens per second (%): 97.42 | MFU (%): 0.09 | TFLOPs: 0.94 | Fwd time: 0.0321519 | Bck time: 0.0441119
2025-05-22 17:58:50,270 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-22 17:58:50,271 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-22 17:58:50,888 - root - INFO - Step: 705 | Loss: 11.77 | Tokens per second: 1229.36 | Training tokens per second (%): 100.00 | MFU (%): 0.05 | TFLOPs: 0.50 | Fwd time: 0.0369286 | Bck time: 0.0451056
2025-05-22 17:58:51,460 - root - INFO - Step: 710 | Loss: 11.72 | Tokens per second: 2237.50 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0316588 | Bck time: 0.0445251
2025-05-22 17:58:52,023 - root - INFO - Step: 715 | Loss: 11.62 | Tokens per second: 2278.04 | Training tokens per second (%): 89.22 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0316362 | Bck time: 0.0414360
2025-05-22 17:58:52,587 - root - INFO - Step: 720 | Loss: 11.61 | Tokens per second: 2270.80 | Training tokens per second (%): 91.64 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0327575 | Bck time: 0.0437177
2025-05-22 17:58:53,148 - root - INFO - Step: 725 | Loss: 11.70 | Tokens per second: 2281.47 | Training tokens per second (%): 90.31 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0332582 | Bck time: 0.0443844
2025-05-22 17:58:53,712 - root - INFO - Step: 730 | Loss: 11.69 | Tokens per second: 2270.14 | Training tokens per second (%): 93.44 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0335166 | Bck time: 0.0440043
2025-05-22 17:58:54,281 - root - INFO - Step: 735 | Loss: 11.63 | Tokens per second: 2250.92 | Training tokens per second (%): 78.20 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0329361 | Bck time: 0.0447244
2025-05-22 17:58:54,855 - root - INFO - Step: 740 | Loss: 11.69 | Tokens per second: 2231.35 | Training tokens per second (%): 99.92 | MFU (%): 0.09 | TFLOPs: 0.91 | Fwd time: 0.0324611 | Bck time: 0.0438949
2025-05-22 17:58:55,424 - root - INFO - Step: 745 | Loss: 11.73 | Tokens per second: 2252.38 | Training tokens per second (%): 78.75 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0335551 | Bck time: 0.0436595
2025-05-22 17:58:55,997 - root - INFO - Step: 750 | Loss: 11.76 | Tokens per second: 2233.29 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.91 | Fwd time: 0.0333000 | Bck time: 0.0448331
2025-05-22 17:58:56,566 - root - INFO - Step: 755 | Loss: 11.77 | Tokens per second: 2251.80 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0332818 | Bck time: 0.0446440
2025-05-22 17:58:57,128 - root - INFO - Step: 760 | Loss: 11.84 | Tokens per second: 2277.82 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0308305 | Bck time: 0.0444978
2025-05-22 17:58:57,703 - root - INFO - Step: 765 | Loss: 11.69 | Tokens per second: 2227.19 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.91 | Fwd time: 0.0315741 | Bck time: 0.0447446
2025-05-22 17:58:58,251 - root - INFO - Step: 770 | Loss: 11.70 | Tokens per second: 2340.51 | Training tokens per second (%): 100.00 | MFU (%): 0.10 | TFLOPs: 0.96 | Fwd time: 0.0305579 | Bck time: 0.0446100
2025-05-22 17:58:58,813 - root - INFO - Step: 775 | Loss: 11.69 | Tokens per second: 2275.83 | Training tokens per second (%): 90.39 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0316544 | Bck time: 0.0445115
2025-05-22 17:58:59,372 - root - INFO - Step: 780 | Loss: 11.75 | Tokens per second: 2291.69 | Training tokens per second (%): 99.45 | MFU (%): 0.09 | TFLOPs: 0.94 | Fwd time: 0.0322804 | Bck time: 0.0438104
2025-05-22 17:58:59,931 - root - INFO - Step: 785 | Loss: 11.65 | Tokens per second: 2293.52 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.94 | Fwd time: 0.0311971 | Bck time: 0.0438265
2025-05-22 17:59:00,494 - root - INFO - Step: 790 | Loss: 11.72 | Tokens per second: 2273.12 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0318931 | Bck time: 0.0443512
2025-05-22 17:59:01,063 - root - INFO - Step: 795 | Loss: 11.65 | Tokens per second: 2249.45 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0317107 | Bck time: 0.0434784
2025-05-22 17:59:01,629 - root - INFO - Step: 800 | Loss: 11.62 | Tokens per second: 2264.18 | Training tokens per second (%): 89.14 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0318617 | Bck time: 0.0446528
2025-05-22 17:59:02,059 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-22 17:59:02,060 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-22 17:59:02,692 - root - INFO - Step: 805 | Loss: 11.54 | Tokens per second: 1204.19 | Training tokens per second (%): 98.98 | MFU (%): 0.05 | TFLOPs: 0.49 | Fwd time: 0.0338419 | Bck time: 0.0448605
2025-05-22 17:59:03,275 - root - INFO - Step: 810 | Loss: 11.71 | Tokens per second: 2198.24 | Training tokens per second (%): 91.17 | MFU (%): 0.09 | TFLOPs: 0.90 | Fwd time: 0.0332053 | Bck time: 0.0454479
2025-05-22 17:59:03,847 - root - INFO - Step: 815 | Loss: 11.76 | Tokens per second: 2237.63 | Training tokens per second (%): 96.72 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0320894 | Bck time: 0.0448618
2025-05-22 17:59:04,414 - root - INFO - Step: 820 | Loss: 11.62 | Tokens per second: 2259.44 | Training tokens per second (%): 90.00 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0317820 | Bck time: 0.0459507
2025-05-22 17:59:04,986 - root - INFO - Step: 825 | Loss: 11.59 | Tokens per second: 2240.78 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0310611 | Bck time: 0.0450311
2025-05-22 17:59:05,557 - root - INFO - Step: 830 | Loss: 11.63 | Tokens per second: 2240.08 | Training tokens per second (%): 92.11 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0327399 | Bck time: 0.0448810
2025-05-22 17:59:06,117 - root - INFO - Step: 835 | Loss: 11.67 | Tokens per second: 2289.11 | Training tokens per second (%): 98.59 | MFU (%): 0.09 | TFLOPs: 0.94 | Fwd time: 0.0320549 | Bck time: 0.0438725
2025-05-22 17:59:06,682 - root - INFO - Step: 840 | Loss: 11.69 | Tokens per second: 2265.45 | Training tokens per second (%): 89.61 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0326133 | Bck time: 0.0442285
2025-05-22 17:59:07,247 - root - INFO - Step: 845 | Loss: 11.64 | Tokens per second: 2267.93 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0325722 | Bck time: 0.0443485
2025-05-22 17:59:07,812 - root - INFO - Step: 850 | Loss: 11.53 | Tokens per second: 2266.09 | Training tokens per second (%): 95.47 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0316528 | Bck time: 0.0441373
2025-05-22 17:59:08,381 - root - INFO - Step: 855 | Loss: 11.62 | Tokens per second: 2250.45 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0312683 | Bck time: 0.0443827
2025-05-22 17:59:08,950 - root - INFO - Step: 860 | Loss: 11.73 | Tokens per second: 2253.31 | Training tokens per second (%): 82.66 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0331330 | Bck time: 0.0439521
2025-05-22 17:59:09,512 - root - INFO - Step: 865 | Loss: 11.56 | Tokens per second: 2278.37 | Training tokens per second (%): 99.37 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0322306 | Bck time: 0.0445539
2025-05-22 17:59:10,079 - root - INFO - Step: 870 | Loss: 11.66 | Tokens per second: 2259.72 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0325858 | Bck time: 0.0439242
2025-05-22 17:59:10,643 - root - INFO - Step: 875 | Loss: 11.51 | Tokens per second: 2268.59 | Training tokens per second (%): 90.55 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0323369 | Bck time: 0.0448813
2025-05-22 17:59:11,213 - root - INFO - Step: 880 | Loss: 11.84 | Tokens per second: 2249.09 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0328639 | Bck time: 0.0451092
2025-05-22 17:59:11,784 - root - INFO - Step: 885 | Loss: 11.61 | Tokens per second: 2239.98 | Training tokens per second (%): 96.41 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0314740 | Bck time: 0.0444294
2025-05-22 17:59:12,349 - root - INFO - Step: 890 | Loss: 11.74 | Tokens per second: 2269.36 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0311422 | Bck time: 0.0449988
2025-05-22 17:59:12,908 - root - INFO - Step: 895 | Loss: 11.76 | Tokens per second: 2291.23 | Training tokens per second (%): 97.11 | MFU (%): 0.09 | TFLOPs: 0.94 | Fwd time: 0.0316854 | Bck time: 0.0437581
2025-05-22 17:59:13,474 - root - INFO - Step: 900 | Loss: 11.58 | Tokens per second: 2259.82 | Training tokens per second (%): 90.39 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0327748 | Bck time: 0.0448575
2025-05-22 17:59:13,899 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-22 17:59:13,901 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-22 17:59:14,516 - root - INFO - Step: 905 | Loss: 11.80 | Tokens per second: 1229.16 | Training tokens per second (%): 89.92 | MFU (%): 0.05 | TFLOPs: 0.50 | Fwd time: 0.0323696 | Bck time: 0.0452777
2025-05-22 17:59:15,093 - root - INFO - Step: 910 | Loss: 11.55 | Tokens per second: 2219.84 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.91 | Fwd time: 0.0321702 | Bck time: 0.0448505
2025-05-22 17:59:15,657 - root - INFO - Step: 915 | Loss: 11.59 | Tokens per second: 2270.02 | Training tokens per second (%): 95.70 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0317376 | Bck time: 0.0449325
2025-05-22 17:59:16,226 - root - INFO - Step: 920 | Loss: 11.63 | Tokens per second: 2252.60 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0326264 | Bck time: 0.0447829
2025-05-22 17:59:16,789 - root - INFO - Step: 925 | Loss: 11.62 | Tokens per second: 2274.86 | Training tokens per second (%): 86.56 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0319358 | Bck time: 0.0444485
2025-05-22 17:59:17,364 - root - INFO - Step: 930 | Loss: 11.71 | Tokens per second: 2224.95 | Training tokens per second (%): 89.38 | MFU (%): 0.09 | TFLOPs: 0.91 | Fwd time: 0.0325885 | Bck time: 0.0451447
2025-05-22 17:59:17,929 - root - INFO - Step: 935 | Loss: 11.63 | Tokens per second: 2268.88 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0320069 | Bck time: 0.0440242
2025-05-22 17:59:18,497 - root - INFO - Step: 940 | Loss: 11.64 | Tokens per second: 2253.98 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0327348 | Bck time: 0.0441743
2025-05-22 17:59:19,066 - root - INFO - Step: 945 | Loss: 11.63 | Tokens per second: 2251.41 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0318071 | Bck time: 0.0443943
2025-05-22 17:59:19,654 - root - INFO - Step: 950 | Loss: 11.65 | Tokens per second: 2177.57 | Training tokens per second (%): 87.50 | MFU (%): 0.09 | TFLOPs: 0.89 | Fwd time: 0.0331679 | Bck time: 0.0449585
2025-05-22 17:59:20,224 - root - INFO - Step: 955 | Loss: 11.47 | Tokens per second: 2248.47 | Training tokens per second (%): 92.42 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0323279 | Bck time: 0.0445940
2025-05-22 17:59:20,797 - root - INFO - Step: 960 | Loss: 11.79 | Tokens per second: 2235.43 | Training tokens per second (%): 93.05 | MFU (%): 0.09 | TFLOPs: 0.91 | Fwd time: 0.0318675 | Bck time: 0.0452947
2025-05-22 17:59:21,363 - root - INFO - Step: 965 | Loss: 11.66 | Tokens per second: 2262.70 | Training tokens per second (%): 92.97 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0316884 | Bck time: 0.0442760
2025-05-22 17:59:21,926 - root - INFO - Step: 970 | Loss: 11.64 | Tokens per second: 2275.00 | Training tokens per second (%): 96.33 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0322688 | Bck time: 0.0442325
2025-05-22 17:59:22,491 - root - INFO - Step: 975 | Loss: 11.56 | Tokens per second: 2265.44 | Training tokens per second (%): 92.97 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0321918 | Bck time: 0.0447515
2025-05-22 17:59:23,092 - root - INFO - Step: 980 | Loss: 11.69 | Tokens per second: 2132.14 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.87 | Fwd time: 0.0334182 | Bck time: 0.0450810
2025-05-22 17:59:23,658 - root - INFO - Step: 985 | Loss: 11.66 | Tokens per second: 2262.68 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.93 | Fwd time: 0.0297055 | Bck time: 0.0419943
2025-05-22 17:59:24,208 - root - INFO - Step: 990 | Loss: 11.68 | Tokens per second: 2326.25 | Training tokens per second (%): 96.09 | MFU (%): 0.10 | TFLOPs: 0.95 | Fwd time: 0.0323076 | Bck time: 0.0428281
2025-05-22 17:59:24,785 - root - INFO - Step: 995 | Loss: 11.78 | Tokens per second: 2220.94 | Training tokens per second (%): 93.20 | MFU (%): 0.09 | TFLOPs: 0.91 | Fwd time: 0.0316656 | Bck time: 0.0440375
2025-05-22 17:59:25,353 - root - INFO - Step: 1000 | Loss: 11.54 | Tokens per second: 2252.57 | Training tokens per second (%): 100.00 | MFU (%): 0.09 | TFLOPs: 0.92 | Fwd time: 0.0323787 | Bck time: 0.0443818
2025-05-22 17:59:25,780 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-22 17:59:25,784 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
total_size: 292602916, bsize: 292602916, ratio: 2.0
292602916 2 False
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 7.160663604736328 ms
CPU copy took 705.9886455535889 ms
---------------------- [PERF] Single Checkpoint time is 0.7329459190368652 sec, average is 0.7329425811767578
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 7.099390029907227 ms
CPU copy took 601.8545627593994 ms
---------------------- [PERF] Single Checkpoint time is 0.6369316577911377 sec, average is 0.6849359273910522
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 7.099390029907227 ms
CPU copy took 538.820743560791 ms
---------------------- [PERF] Single Checkpoint time is 0.5738725662231445 sec, average is 0.6369292736053467
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 7.029533386230469 ms
CPU copy took 445.85251808166504 ms
---------------------- [PERF] Single Checkpoint time is 0.4730348587036133 sec, average is 0.6053999662399292
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 7.02214241027832 ms
CPU copy took 513.1301879882812 ms
---------------------- [PERF] Single Checkpoint time is 0.5481700897216797 sec, average is 0.5738706588745117
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 7.004976272583008 ms
CPU copy took 476.7951965332031 ms
---------------------- [PERF] Single Checkpoint time is 0.5040040016174316 sec, average is 0.5610194206237793
---- exit
PR_ADDR_DATA is 0x4004a5ec0000, PR_ADDR is 0x4004a5c40000, PEER_CHECK_ADDR is 0x4004a5cc0000
--------------- init enqueue: 0
--------------- init enqueue: 1
Call dram.alloc, num_batches is 2, batch_size_floats is 292602916
------------------------- is_distributed is 0, rank is 0
Parall_iter 0, Write new metadata at address 0x4004a5dc0000
------------------------- savenvmNew, is_distributed is 0, total_size is 292602916
At savenvmNew, tid is 54, parall_iter is 0, num_threads is 1, last counter is 0, curr_counter is 1
Writing offset is 61296, parall_iter_offset is 0
start_pr_arr is 0x4004a5ec0000, curr_pr_arr is 0x4004a5ec0000, batch_size is 292602916, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 292602916
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 292602916, start addr is 0x4004a5ec0000!
Thread ID: 1, savenvm_thread_nd took 629.852343 ms
Thread ID: 1, set_cpu took 0.095004 ms
Threads took 647.538750 ms
MSYNC 1170411664 TOOK 52.792669 ms
CAS was successful! new counter is 1, is_distributed is 0
******** checkp_info saved in 0x4004a5dc0000, curr_checkpoint is 0x4004a5dc0000
0, 1
Parall_iter 1, Write new metadata at address 0x4004a5e40000
------------------------- savenvmNew, is_distributed is 0, total_size is 292602916
At savenvmNew, tid is 98, parall_iter is 1, num_threads is 1, last counter is 1, curr_counter is 2
Writing offset is 61296, parall_iter_offset is 292618240
start_pr_arr is 0x4004ebb00000, curr_pr_arr is 0x4004ebb00000, batch_size is 292602916, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 292602916
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 292602916, start addr is 0x4004ebb00000!
Thread ID: 2, savenvm_thread_nd took 518.393138 ms
Thread ID: 2, set_cpu took 0.090301 ms
Threads took 538.443395 ms
MSYNC 1170411664 TOOK 57.788553 ms
CAS was successful! new counter is 2, is_distributed is 0
******** checkp_info saved in 0x4004a5e40000, curr_checkpoint is 0x4004a5e40000
1, 2
Parall_iter 0, Write new metadata at address 0x4004a5dc0000
------------------------- savenvmNew, is_distributed is 0, total_size is 292602916
At savenvmNew, tid is 122, parall_iter is 0, num_threads is 1, last counter is 2, curr_counter is 3
Writing offset is 61296, parall_iter_offset is 0
start_pr_arr is 0x4004a5ec0000, curr_pr_arr is 0x4004a5ec0000, batch_size is 292602916, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 292602916
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 292602916, start addr is 0x4004a5ec0000!
Thread ID: 1, savenvm_thread_nd took 378.036823 ms
Thread ID: 1, set_cpu took 0.092989 ms
Threads took 398.089353 ms
MSYNC 1170411664 TOOK 135.235475 ms
CAS was successful! new counter is 3, is_distributed is 0
******** checkp_info saved in 0x4004a5dc0000, curr_checkpoint is 0x4004a5dc0000
0, 3
Parall_iter 1, Write new metadata at address 0x4004a5e40000
------------------------- savenvmNew, is_distributed is 0, total_size is 292602916
At savenvmNew, tid is 33, parall_iter is 1, num_threads is 1, last counter is 3, curr_counter is 4
Writing offset is 61296, parall_iter_offset is 292618240
start_pr_arr is 0x4004ebb00000, curr_pr_arr is 0x4004ebb00000, batch_size is 292602916, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 292602916
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 292602916, start addr is 0x4004ebb00000!
Thread ID: 2, savenvm_thread_nd took 375.138111 ms
Thread ID: 2, set_cpu took 0.082973 ms
Threads took 393.025438 ms
MSYNC 1170411664 TOOK 47.170982 ms
CAS was successful! new counter is 4, is_distributed is 0
******** checkp_info saved in 0x4004a5e40000, curr_checkpoint is 0x4004a5e40000
1, 4
Parall_iter 0, Write new metadata at address 0x4004a5dc0000
------------------------- savenvmNew, is_distributed is 0, total_size is 292602916
At savenvmNew, tid is 58, parall_iter is 0, num_threads is 1, last counter is 4, curr_counter is 5
Writing offset is 61296, parall_iter_offset is 0
start_pr_arr is 0x4004a5ec0000, curr_pr_arr is 0x4004a5ec0000, batch_size is 292602916, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 292602916
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 292602916, start addr is 0x4004a5ec0000!
Thread ID: 1, savenvm_thread_nd took 375.624525 ms
Thread ID: 1, set_cpu took 0.080125 ms
Threads took 395.683646 ms
MSYNC 1170411664 TOOK 111.978004 ms
CAS was successful! new counter is 5, is_distributed is 0
******** checkp_info saved in 0x4004a5dc0000, curr_checkpoint is 0x4004a5dc0000
0, 5
Parall_iter 1, Write new metadata at address 0x4004a5e40000
------------------------- savenvmNew, is_distributed is 0, total_size is 292602916
At savenvmNew, tid is 83, parall_iter is 1, num_threads is 1, last counter is 5, curr_counter is 6
Writing offset is 61296, parall_iter_offset is 292618240
start_pr_arr is 0x4004ebb00000, curr_pr_arr is 0x4004ebb00000, batch_size is 292602916, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 292602916
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 292602916, start addr is 0x4004ebb00000!
Thread ID: 2, savenvm_thread_nd took 369.967991 ms
Thread ID: 2, set_cpu took 0.082077 ms
Threads took 387.928692 ms
MSYNC 1170411664 TOOK 88.394241 ms
CAS was successful! new counter is 6, is_distributed is 0
******** checkp_info saved in 0x4004a5e40000, curr_checkpoint is 0x4004a5e40000
1, 6
2025-05-22 17:59:26,562 - root - INFO - Training completed
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
0, 3, 0
1, 4, 3
max_piter is 1
Writing offset is 61296, parall_iter_offset is 292618240
data_offset is 1173094400
