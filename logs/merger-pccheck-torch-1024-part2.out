2025-05-23 01:10:08,046 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=1024, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=1000, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, seed=4, checkpoint_dir='/iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts', loss_file='/iopsstor/scratch/cscs/bkundu/lsai-merger/results/bf16/loss-pccheck-torch-1024-part2.csv', checkpoint_freq=100, max_async=1, warmup=3, load_checkpoint=True, non_blocking=False)
2025-05-23 01:10:08,051 - root - INFO - Random state checkpoint loaded from /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:10:08,051 - root - INFO - Training will resume from step: 400
2025-05-23 01:10:08,051 - root - INFO - Setting up DataLoaders...
2025-05-23 01:10:08,783 - root - INFO - Setting up Model...
2025-05-23 01:10:16,811 - root - INFO - Loading checkpoint model, optimizer + scheduler
/iopsstor/scratch/cscs/bkundu/lsai-merger/LSAI-Checkpointing/training/utils.py:85: UserWarning: The given buffer is not writable, and PyTorch does not support non-writable tensors. This means you can write to the underlying (supposedly non-writable) buffer using the tensor. You may want to copy the buffer to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at /opt/pytorch/pytorch/torch/csrc/utils/tensor_new.cpp:1561.)
  data = torch.frombuffer(payload, dtype=torch.float32)
2025-05-23 01:10:19,634 - root - INFO - Checkpoint loaded from /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/checkpoint_pccheck.pt
2025-05-23 01:10:19,648 - root - INFO - Loaded optimizer, scheduler checkpoint at step 400 in 2.83 seconds
Model size: 755041280, Optimizer size: 1510082852, Total size: 2265124132
BSIZE IS 2265124132
At checkpoint, bsize is 2265124132
2025-05-23 01:10:26,347 - root - INFO - Checkpointing warmup done
2025-05-23 01:10:26,351 - root - INFO - ------------------------------------------------------------Starting training!
2025-05-23 01:10:27,175 - root - INFO - Step: 405 | Loss: 10.28 | Tokens per second: 6220.30 | Training tokens per second (%): 53.48 | MFU (%): 2.60 | TFLOPs: 25.67 | Fwd time: 0.0317222 | Bck time: 0.0451407
2025-05-23 01:10:27,757 - root - INFO - Step: 410 | Loss: 10.27 | Tokens per second: 8820.25 | Training tokens per second (%): 70.70 | MFU (%): 3.68 | TFLOPs: 36.41 | Fwd time: 0.0311840 | Bck time: 0.0453919
2025-05-23 01:10:28,342 - root - INFO - Step: 415 | Loss: 10.19 | Tokens per second: 8775.44 | Training tokens per second (%): 74.12 | MFU (%): 3.66 | TFLOPs: 36.22 | Fwd time: 0.0308572 | Bck time: 0.0454038
2025-05-23 01:10:28,922 - root - INFO - Step: 420 | Loss: 10.37 | Tokens per second: 8854.11 | Training tokens per second (%): 46.97 | MFU (%): 3.70 | TFLOPs: 36.55 | Fwd time: 0.0316871 | Bck time: 0.0457408
2025-05-23 01:10:29,601 - root - INFO - Step: 425 | Loss: 10.13 | Tokens per second: 7551.28 | Training tokens per second (%): 40.94 | MFU (%): 3.15 | TFLOPs: 31.17 | Fwd time: 0.0308524 | Bck time: 0.0445709
2025-05-23 01:10:30,184 - root - INFO - Step: 430 | Loss: 10.56 | Tokens per second: 8802.25 | Training tokens per second (%): 71.68 | MFU (%): 3.67 | TFLOPs: 36.33 | Fwd time: 0.0311940 | Bck time: 0.0457438
2025-05-23 01:10:30,783 - root - INFO - Step: 435 | Loss: 10.19 | Tokens per second: 8572.41 | Training tokens per second (%): 74.38 | MFU (%): 3.58 | TFLOPs: 35.38 | Fwd time: 0.0314906 | Bck time: 0.0452073
2025-05-23 01:10:31,364 - root - INFO - Step: 440 | Loss: 10.11 | Tokens per second: 8827.97 | Training tokens per second (%): 59.88 | MFU (%): 3.68 | TFLOPs: 36.44 | Fwd time: 0.0315674 | Bck time: 0.0453311
2025-05-23 01:10:31,942 - root - INFO - Step: 445 | Loss: 10.21 | Tokens per second: 8885.98 | Training tokens per second (%): 68.91 | MFU (%): 3.71 | TFLOPs: 36.68 | Fwd time: 0.0313120 | Bck time: 0.0449435
2025-05-23 01:10:32,519 - root - INFO - Step: 450 | Loss: 10.02 | Tokens per second: 8903.79 | Training tokens per second (%): 77.27 | MFU (%): 3.72 | TFLOPs: 36.75 | Fwd time: 0.0313255 | Bck time: 0.0439528
2025-05-23 01:10:33,111 - root - INFO - Step: 455 | Loss: 9.88 | Tokens per second: 8662.93 | Training tokens per second (%): 76.52 | MFU (%): 3.62 | TFLOPs: 35.76 | Fwd time: 0.0320346 | Bck time: 0.0458161
2025-05-23 01:10:33,691 - root - INFO - Step: 460 | Loss: 10.20 | Tokens per second: 8842.33 | Training tokens per second (%): 76.35 | MFU (%): 3.69 | TFLOPs: 36.50 | Fwd time: 0.0318246 | Bck time: 0.0454009
2025-05-23 01:10:34,271 - root - INFO - Step: 465 | Loss: 9.95 | Tokens per second: 8858.73 | Training tokens per second (%): 67.70 | MFU (%): 3.70 | TFLOPs: 36.57 | Fwd time: 0.0310528 | Bck time: 0.0454211
2025-05-23 01:10:34,856 - root - INFO - Step: 470 | Loss: 9.87 | Tokens per second: 8778.35 | Training tokens per second (%): 68.83 | MFU (%): 3.66 | TFLOPs: 36.23 | Fwd time: 0.0321725 | Bck time: 0.0452459
2025-05-23 01:10:35,441 - root - INFO - Step: 475 | Loss: 10.18 | Tokens per second: 8761.87 | Training tokens per second (%): 66.56 | MFU (%): 3.66 | TFLOPs: 36.17 | Fwd time: 0.0320927 | Bck time: 0.0448814
2025-05-23 01:10:36,025 - root - INFO - Step: 480 | Loss: 10.02 | Tokens per second: 8800.87 | Training tokens per second (%): 73.26 | MFU (%): 3.67 | TFLOPs: 36.33 | Fwd time: 0.0317183 | Bck time: 0.0451692
2025-05-23 01:10:36,604 - root - INFO - Step: 485 | Loss: 10.25 | Tokens per second: 8850.27 | Training tokens per second (%): 48.54 | MFU (%): 3.69 | TFLOPs: 36.53 | Fwd time: 0.0315183 | Bck time: 0.0457346
2025-05-23 01:10:37,182 - root - INFO - Step: 490 | Loss: 10.21 | Tokens per second: 8881.12 | Training tokens per second (%): 54.59 | MFU (%): 3.71 | TFLOPs: 36.66 | Fwd time: 0.0314743 | Bck time: 0.0464515
2025-05-23 01:10:37,774 - root - INFO - Step: 495 | Loss: 10.39 | Tokens per second: 8670.98 | Training tokens per second (%): 46.95 | MFU (%): 3.62 | TFLOPs: 35.79 | Fwd time: 0.0313711 | Bck time: 0.0462707
2025-05-23 01:10:38,362 - root - INFO - Step: 500 | Loss: 10.43 | Tokens per second: 8727.76 | Training tokens per second (%): 87.85 | MFU (%): 3.64 | TFLOPs: 36.02 | Fwd time: 0.0315677 | Bck time: 0.0464530
2025-05-23 01:10:43,652 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:10:43,654 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 01:10:44,260 - root - INFO - Step: 505 | Loss: 10.04 | Tokens per second: 868.35 | Training tokens per second (%): 53.85 | MFU (%): 0.36 | TFLOPs: 3.58 | Fwd time: 0.0309930 | Bck time: 0.0455171
2025-05-23 01:10:44,840 - root - INFO - Step: 510 | Loss: 10.32 | Tokens per second: 8846.65 | Training tokens per second (%): 58.40 | MFU (%): 3.69 | TFLOPs: 36.52 | Fwd time: 0.0313631 | Bck time: 0.0460559
2025-05-23 01:10:45,420 - root - INFO - Step: 515 | Loss: 9.51 | Tokens per second: 8857.94 | Training tokens per second (%): 51.07 | MFU (%): 3.70 | TFLOPs: 36.56 | Fwd time: 0.0311931 | Bck time: 0.0456730
2025-05-23 01:10:45,996 - root - INFO - Step: 520 | Loss: 10.02 | Tokens per second: 8912.94 | Training tokens per second (%): 67.07 | MFU (%): 3.72 | TFLOPs: 36.79 | Fwd time: 0.0319044 | Bck time: 0.0445739
2025-05-23 01:10:46,574 - root - INFO - Step: 525 | Loss: 9.77 | Tokens per second: 8879.03 | Training tokens per second (%): 65.33 | MFU (%): 3.71 | TFLOPs: 36.65 | Fwd time: 0.0310253 | Bck time: 0.0447135
2025-05-23 01:10:47,154 - root - INFO - Step: 530 | Loss: 10.01 | Tokens per second: 8838.77 | Training tokens per second (%): 81.27 | MFU (%): 3.69 | TFLOPs: 36.48 | Fwd time: 0.0311640 | Bck time: 0.0452312
2025-05-23 01:10:47,758 - root - INFO - Step: 535 | Loss: 10.21 | Tokens per second: 8497.32 | Training tokens per second (%): 84.04 | MFU (%): 3.55 | TFLOPs: 35.07 | Fwd time: 0.0313654 | Bck time: 0.0452678
2025-05-23 01:10:48,353 - root - INFO - Step: 540 | Loss: 9.11 | Tokens per second: 8624.81 | Training tokens per second (%): 53.63 | MFU (%): 3.60 | TFLOPs: 35.60 | Fwd time: 0.0320918 | Bck time: 0.0455906
2025-05-23 01:10:48,943 - root - INFO - Step: 545 | Loss: 10.19 | Tokens per second: 8705.51 | Training tokens per second (%): 82.29 | MFU (%): 3.63 | TFLOPs: 35.93 | Fwd time: 0.0312792 | Bck time: 0.0459455
2025-05-23 01:10:49,518 - root - INFO - Step: 550 | Loss: 10.27 | Tokens per second: 8921.23 | Training tokens per second (%): 33.73 | MFU (%): 3.72 | TFLOPs: 36.82 | Fwd time: 0.0311459 | Bck time: 0.0455887
2025-05-23 01:10:50,094 - root - INFO - Step: 555 | Loss: 11.09 | Tokens per second: 8917.83 | Training tokens per second (%): 51.64 | MFU (%): 3.72 | TFLOPs: 36.81 | Fwd time: 0.0310734 | Bck time: 0.0449099
2025-05-23 01:10:50,671 - root - INFO - Step: 560 | Loss: 10.51 | Tokens per second: 8886.27 | Training tokens per second (%): 71.05 | MFU (%): 3.71 | TFLOPs: 36.68 | Fwd time: 0.0310471 | Bck time: 0.0451927
2025-05-23 01:10:51,246 - root - INFO - Step: 565 | Loss: 10.15 | Tokens per second: 8929.72 | Training tokens per second (%): 43.40 | MFU (%): 3.73 | TFLOPs: 36.86 | Fwd time: 0.0318683 | Bck time: 0.0452391
2025-05-23 01:10:51,824 - root - INFO - Step: 570 | Loss: 10.47 | Tokens per second: 8885.24 | Training tokens per second (%): 39.67 | MFU (%): 3.71 | TFLOPs: 36.67 | Fwd time: 0.0309245 | Bck time: 0.0455581
2025-05-23 01:10:52,398 - root - INFO - Step: 575 | Loss: 9.97 | Tokens per second: 8936.63 | Training tokens per second (%): 47.83 | MFU (%): 3.73 | TFLOPs: 36.89 | Fwd time: 0.0310274 | Bck time: 0.0454904
2025-05-23 01:10:52,973 - root - INFO - Step: 580 | Loss: 10.02 | Tokens per second: 8928.53 | Training tokens per second (%): 29.63 | MFU (%): 3.73 | TFLOPs: 36.85 | Fwd time: 0.0316434 | Bck time: 0.0453925
2025-05-23 01:10:53,552 - root - INFO - Step: 585 | Loss: 9.85 | Tokens per second: 8861.83 | Training tokens per second (%): 45.20 | MFU (%): 3.70 | TFLOPs: 36.58 | Fwd time: 0.0313934 | Bck time: 0.0459780
2025-05-23 01:10:54,129 - root - INFO - Step: 590 | Loss: 10.04 | Tokens per second: 8895.71 | Training tokens per second (%): 64.39 | MFU (%): 3.71 | TFLOPs: 36.72 | Fwd time: 0.0310529 | Bck time: 0.0455535
2025-05-23 01:10:54,703 - root - INFO - Step: 595 | Loss: 10.10 | Tokens per second: 8940.46 | Training tokens per second (%): 47.64 | MFU (%): 3.73 | TFLOPs: 36.90 | Fwd time: 0.0311610 | Bck time: 0.0462236
2025-05-23 01:10:55,277 - root - INFO - Step: 600 | Loss: 10.08 | Tokens per second: 8939.67 | Training tokens per second (%): 45.84 | MFU (%): 3.73 | TFLOPs: 36.90 | Fwd time: 0.0318115 | Bck time: 0.0449955
2025-05-23 01:11:00,184 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:11:00,188 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 01:11:00,805 - root - INFO - Step: 605 | Loss: 10.02 | Tokens per second: 926.43 | Training tokens per second (%): 47.93 | MFU (%): 0.39 | TFLOPs: 3.82 | Fwd time: 0.0311965 | Bck time: 0.0457938
2025-05-23 01:11:01,379 - root - INFO - Step: 610 | Loss: 10.72 | Tokens per second: 8954.89 | Training tokens per second (%): 40.45 | MFU (%): 3.74 | TFLOPs: 36.96 | Fwd time: 0.0315031 | Bck time: 0.0459431
2025-05-23 01:11:01,953 - root - INFO - Step: 615 | Loss: 10.02 | Tokens per second: 8939.53 | Training tokens per second (%): 69.37 | MFU (%): 3.73 | TFLOPs: 36.90 | Fwd time: 0.0307172 | Bck time: 0.0449864
2025-05-23 01:11:02,527 - root - INFO - Step: 620 | Loss: 9.73 | Tokens per second: 8946.81 | Training tokens per second (%): 54.59 | MFU (%): 3.73 | TFLOPs: 36.93 | Fwd time: 0.0308834 | Bck time: 0.0458636
2025-05-23 01:11:03,106 - root - INFO - Step: 625 | Loss: 10.10 | Tokens per second: 8852.19 | Training tokens per second (%): 60.74 | MFU (%): 3.69 | TFLOPs: 36.54 | Fwd time: 0.0309856 | Bck time: 0.0455112
2025-05-23 01:11:03,680 - root - INFO - Step: 630 | Loss: 10.10 | Tokens per second: 8944.69 | Training tokens per second (%): 55.82 | MFU (%): 3.73 | TFLOPs: 36.92 | Fwd time: 0.0312726 | Bck time: 0.0455761
2025-05-23 01:11:04,277 - root - INFO - Step: 635 | Loss: 10.24 | Tokens per second: 8606.04 | Training tokens per second (%): 75.61 | MFU (%): 3.59 | TFLOPs: 35.52 | Fwd time: 0.0319696 | Bck time: 0.0462300
2025-05-23 01:11:04,855 - root - INFO - Step: 640 | Loss: 10.17 | Tokens per second: 8867.50 | Training tokens per second (%): 61.74 | MFU (%): 3.70 | TFLOPs: 36.60 | Fwd time: 0.0330688 | Bck time: 0.0425606
2025-05-23 01:11:05,442 - root - INFO - Step: 645 | Loss: 10.11 | Tokens per second: 8754.81 | Training tokens per second (%): 45.98 | MFU (%): 3.65 | TFLOPs: 36.14 | Fwd time: 0.0324785 | Bck time: 0.0447673
2025-05-23 01:11:06,041 - root - INFO - Step: 650 | Loss: 9.91 | Tokens per second: 8557.88 | Training tokens per second (%): 80.64 | MFU (%): 3.57 | TFLOPs: 35.32 | Fwd time: 0.0328390 | Bck time: 0.0452505
2025-05-23 01:11:06,630 - root - INFO - Step: 655 | Loss: 10.17 | Tokens per second: 8711.10 | Training tokens per second (%): 48.71 | MFU (%): 3.64 | TFLOPs: 35.96 | Fwd time: 0.0315599 | Bck time: 0.0454006
2025-05-23 01:11:07,212 - root - INFO - Step: 660 | Loss: 10.07 | Tokens per second: 8830.70 | Training tokens per second (%): 51.99 | MFU (%): 3.69 | TFLOPs: 36.45 | Fwd time: 0.0322588 | Bck time: 0.0456393
2025-05-23 01:11:07,813 - root - INFO - Step: 665 | Loss: 10.03 | Tokens per second: 8530.70 | Training tokens per second (%): 70.82 | MFU (%): 3.56 | TFLOPs: 35.21 | Fwd time: 0.0320698 | Bck time: 0.0459780
2025-05-23 01:11:08,396 - root - INFO - Step: 670 | Loss: 9.85 | Tokens per second: 8814.46 | Training tokens per second (%): 67.19 | MFU (%): 3.68 | TFLOPs: 36.38 | Fwd time: 0.0325596 | Bck time: 0.0446364
2025-05-23 01:11:08,978 - root - INFO - Step: 675 | Loss: 9.79 | Tokens per second: 8806.78 | Training tokens per second (%): 37.05 | MFU (%): 3.68 | TFLOPs: 36.35 | Fwd time: 0.0317719 | Bck time: 0.0456830
2025-05-23 01:11:09,571 - root - INFO - Step: 680 | Loss: 9.89 | Tokens per second: 8659.89 | Training tokens per second (%): 64.96 | MFU (%): 3.61 | TFLOPs: 35.74 | Fwd time: 0.0328810 | Bck time: 0.0455509
2025-05-23 01:11:10,159 - root - INFO - Step: 685 | Loss: 10.25 | Tokens per second: 8725.12 | Training tokens per second (%): 64.36 | MFU (%): 3.64 | TFLOPs: 36.01 | Fwd time: 0.0323835 | Bck time: 0.0452558
2025-05-23 01:11:10,743 - root - INFO - Step: 690 | Loss: 10.01 | Tokens per second: 8794.39 | Training tokens per second (%): 29.28 | MFU (%): 3.67 | TFLOPs: 36.30 | Fwd time: 0.0312599 | Bck time: 0.0466203
2025-05-23 01:11:11,341 - root - INFO - Step: 695 | Loss: 10.02 | Tokens per second: 8574.63 | Training tokens per second (%): 79.20 | MFU (%): 3.58 | TFLOPs: 35.39 | Fwd time: 0.0311665 | Bck time: 0.0455944
2025-05-23 01:11:11,924 - root - INFO - Step: 700 | Loss: 9.63 | Tokens per second: 8803.90 | Training tokens per second (%): 59.45 | MFU (%): 3.67 | TFLOPs: 36.34 | Fwd time: 0.0319610 | Bck time: 0.0455503
2025-05-23 01:11:16,043 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:11:16,045 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 01:11:16,662 - root - INFO - Step: 705 | Loss: 9.94 | Tokens per second: 1080.95 | Training tokens per second (%): 70.08 | MFU (%): 0.45 | TFLOPs: 4.46 | Fwd time: 0.0330891 | Bck time: 0.0444764
2025-05-23 01:11:17,246 - root - INFO - Step: 710 | Loss: 9.95 | Tokens per second: 8797.48 | Training tokens per second (%): 100.00 | MFU (%): 3.67 | TFLOPs: 36.31 | Fwd time: 0.0322374 | Bck time: 0.0450107
2025-05-23 01:11:17,829 - root - INFO - Step: 715 | Loss: 9.69 | Tokens per second: 8807.44 | Training tokens per second (%): 56.64 | MFU (%): 3.68 | TFLOPs: 36.35 | Fwd time: 0.0310990 | Bck time: 0.0443681
2025-05-23 01:11:18,407 - root - INFO - Step: 720 | Loss: 9.51 | Tokens per second: 8878.50 | Training tokens per second (%): 46.68 | MFU (%): 3.71 | TFLOPs: 36.65 | Fwd time: 0.0322410 | Bck time: 0.0456356
2025-05-23 01:11:18,984 - root - INFO - Step: 725 | Loss: 9.88 | Tokens per second: 8883.53 | Training tokens per second (%): 39.39 | MFU (%): 3.71 | TFLOPs: 36.67 | Fwd time: 0.0317365 | Bck time: 0.0459084
2025-05-23 01:11:19,563 - root - INFO - Step: 730 | Loss: 10.25 | Tokens per second: 8871.65 | Training tokens per second (%): 45.06 | MFU (%): 3.70 | TFLOPs: 36.62 | Fwd time: 0.0313666 | Bck time: 0.0458352
2025-05-23 01:11:20,142 - root - INFO - Step: 735 | Loss: 9.85 | Tokens per second: 8868.22 | Training tokens per second (%): 37.15 | MFU (%): 3.70 | TFLOPs: 36.60 | Fwd time: 0.0318833 | Bck time: 0.0448948
2025-05-23 01:11:20,726 - root - INFO - Step: 740 | Loss: 10.28 | Tokens per second: 8784.71 | Training tokens per second (%): 56.19 | MFU (%): 3.67 | TFLOPs: 36.26 | Fwd time: 0.0318911 | Bck time: 0.0454517
2025-05-23 01:11:21,304 - root - INFO - Step: 745 | Loss: 10.18 | Tokens per second: 8880.34 | Training tokens per second (%): 35.76 | MFU (%): 3.71 | TFLOPs: 36.65 | Fwd time: 0.0314997 | Bck time: 0.0446297
2025-05-23 01:11:21,884 - root - INFO - Step: 750 | Loss: 10.09 | Tokens per second: 8850.71 | Training tokens per second (%): 72.73 | MFU (%): 3.69 | TFLOPs: 36.53 | Fwd time: 0.0318831 | Bck time: 0.0456033
2025-05-23 01:11:22,462 - root - INFO - Step: 755 | Loss: 10.02 | Tokens per second: 8877.82 | Training tokens per second (%): 69.63 | MFU (%): 3.71 | TFLOPs: 36.64 | Fwd time: 0.0309957 | Bck time: 0.0446383
2025-05-23 01:11:23,046 - root - INFO - Step: 760 | Loss: 10.18 | Tokens per second: 8786.12 | Training tokens per second (%): 87.03 | MFU (%): 3.67 | TFLOPs: 36.27 | Fwd time: 0.0308662 | Bck time: 0.0446083
2025-05-23 01:11:23,641 - root - INFO - Step: 765 | Loss: 9.78 | Tokens per second: 8633.55 | Training tokens per second (%): 96.66 | MFU (%): 3.60 | TFLOPs: 35.64 | Fwd time: 0.0309136 | Bck time: 0.0453143
2025-05-23 01:11:24,220 - root - INFO - Step: 770 | Loss: 9.78 | Tokens per second: 8852.90 | Training tokens per second (%): 65.63 | MFU (%): 3.69 | TFLOPs: 36.54 | Fwd time: 0.0322791 | Bck time: 0.0454898
2025-05-23 01:11:24,805 - root - INFO - Step: 775 | Loss: 9.95 | Tokens per second: 8773.45 | Training tokens per second (%): 54.79 | MFU (%): 3.66 | TFLOPs: 36.21 | Fwd time: 0.0309701 | Bck time: 0.0449996
2025-05-23 01:11:25,388 - root - INFO - Step: 780 | Loss: 10.48 | Tokens per second: 8806.34 | Training tokens per second (%): 48.96 | MFU (%): 3.68 | TFLOPs: 36.35 | Fwd time: 0.0321875 | Bck time: 0.0463086
2025-05-23 01:11:25,974 - root - INFO - Step: 785 | Loss: 9.75 | Tokens per second: 8767.14 | Training tokens per second (%): 67.97 | MFU (%): 3.66 | TFLOPs: 36.19 | Fwd time: 0.0315313 | Bck time: 0.0464304
2025-05-23 01:11:26,558 - root - INFO - Step: 790 | Loss: 10.08 | Tokens per second: 8789.52 | Training tokens per second (%): 64.88 | MFU (%): 3.67 | TFLOPs: 36.28 | Fwd time: 0.0319386 | Bck time: 0.0455377
2025-05-23 01:11:27,161 - root - INFO - Step: 795 | Loss: 9.71 | Tokens per second: 8507.90 | Training tokens per second (%): 76.72 | MFU (%): 3.55 | TFLOPs: 35.12 | Fwd time: 0.0326140 | Bck time: 0.0457447
2025-05-23 01:11:27,742 - root - INFO - Step: 800 | Loss: 9.67 | Tokens per second: 8828.98 | Training tokens per second (%): 70.10 | MFU (%): 3.68 | TFLOPs: 36.44 | Fwd time: 0.0322085 | Bck time: 0.0436706
2025-05-23 01:11:31,792 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:11:31,797 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 01:11:32,412 - root - INFO - Step: 805 | Loss: 9.85 | Tokens per second: 1096.81 | Training tokens per second (%): 82.40 | MFU (%): 0.46 | TFLOPs: 4.53 | Fwd time: 0.0319561 | Bck time: 0.0444769
2025-05-23 01:11:32,991 - root - INFO - Step: 810 | Loss: 9.75 | Tokens per second: 8864.02 | Training tokens per second (%): 67.11 | MFU (%): 3.70 | TFLOPs: 36.59 | Fwd time: 0.0317967 | Bck time: 0.0448775
2025-05-23 01:11:33,571 - root - INFO - Step: 815 | Loss: 10.26 | Tokens per second: 8848.82 | Training tokens per second (%): 62.75 | MFU (%): 3.69 | TFLOPs: 36.52 | Fwd time: 0.0314410 | Bck time: 0.0448738
2025-05-23 01:11:34,148 - root - INFO - Step: 820 | Loss: 9.88 | Tokens per second: 8884.80 | Training tokens per second (%): 61.56 | MFU (%): 3.71 | TFLOPs: 36.67 | Fwd time: 0.0322786 | Bck time: 0.0443260
2025-05-23 01:11:34,733 - root - INFO - Step: 825 | Loss: 9.84 | Tokens per second: 8777.16 | Training tokens per second (%): 89.63 | MFU (%): 3.66 | TFLOPs: 36.23 | Fwd time: 0.0316557 | Bck time: 0.0450874
2025-05-23 01:11:35,310 - root - INFO - Step: 830 | Loss: 9.74 | Tokens per second: 8891.57 | Training tokens per second (%): 68.81 | MFU (%): 3.71 | TFLOPs: 36.70 | Fwd time: 0.0316094 | Bck time: 0.0450215
2025-05-23 01:11:35,883 - root - INFO - Step: 835 | Loss: 10.06 | Tokens per second: 8967.51 | Training tokens per second (%): 37.79 | MFU (%): 3.74 | TFLOPs: 37.01 | Fwd time: 0.0312197 | Bck time: 0.0448329
2025-05-23 01:11:36,458 - root - INFO - Step: 840 | Loss: 9.95 | Tokens per second: 8925.91 | Training tokens per second (%): 35.92 | MFU (%): 3.73 | TFLOPs: 36.84 | Fwd time: 0.0317603 | Bck time: 0.0448769
2025-05-23 01:11:37,039 - root - INFO - Step: 845 | Loss: 10.12 | Tokens per second: 8837.49 | Training tokens per second (%): 57.68 | MFU (%): 3.69 | TFLOPs: 36.48 | Fwd time: 0.0320831 | Bck time: 0.0452306
2025-05-23 01:11:37,612 - root - INFO - Step: 850 | Loss: 9.94 | Tokens per second: 8951.43 | Training tokens per second (%): 57.05 | MFU (%): 3.74 | TFLOPs: 36.95 | Fwd time: 0.0318862 | Bck time: 0.0445885
2025-05-23 01:11:38,191 - root - INFO - Step: 855 | Loss: 9.85 | Tokens per second: 8860.81 | Training tokens per second (%): 84.08 | MFU (%): 3.70 | TFLOPs: 36.57 | Fwd time: 0.0314474 | Bck time: 0.0451412
2025-05-23 01:11:38,767 - root - INFO - Step: 860 | Loss: 10.06 | Tokens per second: 8908.63 | Training tokens per second (%): 34.51 | MFU (%): 3.72 | TFLOPs: 36.77 | Fwd time: 0.0321346 | Bck time: 0.0447409
2025-05-23 01:11:39,345 - root - INFO - Step: 865 | Loss: 9.53 | Tokens per second: 8882.44 | Training tokens per second (%): 59.63 | MFU (%): 3.71 | TFLOPs: 36.66 | Fwd time: 0.0312807 | Bck time: 0.0449561
2025-05-23 01:11:39,927 - root - INFO - Step: 870 | Loss: 9.82 | Tokens per second: 8819.30 | Training tokens per second (%): 70.31 | MFU (%): 3.68 | TFLOPs: 36.40 | Fwd time: 0.0322597 | Bck time: 0.0459449
2025-05-23 01:11:40,504 - root - INFO - Step: 875 | Loss: 9.71 | Tokens per second: 8898.92 | Training tokens per second (%): 49.41 | MFU (%): 3.71 | TFLOPs: 36.73 | Fwd time: 0.0318879 | Bck time: 0.0444116
2025-05-23 01:11:41,084 - root - INFO - Step: 880 | Loss: 10.25 | Tokens per second: 8853.07 | Training tokens per second (%): 61.56 | MFU (%): 3.69 | TFLOPs: 36.54 | Fwd time: 0.0323117 | Bck time: 0.0451326
2025-05-23 01:11:41,668 - root - INFO - Step: 885 | Loss: 9.57 | Tokens per second: 8789.68 | Training tokens per second (%): 71.84 | MFU (%): 3.67 | TFLOPs: 36.28 | Fwd time: 0.0319717 | Bck time: 0.0451611
2025-05-23 01:11:42,251 - root - INFO - Step: 890 | Loss: 9.76 | Tokens per second: 8798.03 | Training tokens per second (%): 73.14 | MFU (%): 3.67 | TFLOPs: 36.31 | Fwd time: 0.0319459 | Bck time: 0.0459628
2025-05-23 01:11:42,829 - root - INFO - Step: 895 | Loss: 10.19 | Tokens per second: 8876.39 | Training tokens per second (%): 50.63 | MFU (%): 3.70 | TFLOPs: 36.64 | Fwd time: 0.0315333 | Bck time: 0.0454601
2025-05-23 01:11:43,408 - root - INFO - Step: 900 | Loss: 9.85 | Tokens per second: 8871.62 | Training tokens per second (%): 46.68 | MFU (%): 3.70 | TFLOPs: 36.62 | Fwd time: 0.0318342 | Bck time: 0.0450264
2025-05-23 01:11:47,510 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:11:47,515 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 01:11:48,135 - root - INFO - Step: 905 | Loss: 10.36 | Tokens per second: 1083.53 | Training tokens per second (%): 42.01 | MFU (%): 0.45 | TFLOPs: 4.47 | Fwd time: 0.0313314 | Bck time: 0.0458222
2025-05-23 01:11:48,717 - root - INFO - Step: 910 | Loss: 9.64 | Tokens per second: 8806.66 | Training tokens per second (%): 82.42 | MFU (%): 3.68 | TFLOPs: 36.35 | Fwd time: 0.0323573 | Bck time: 0.0451615
2025-05-23 01:11:49,294 - root - INFO - Step: 915 | Loss: 9.82 | Tokens per second: 8901.57 | Training tokens per second (%): 49.36 | MFU (%): 3.72 | TFLOPs: 36.74 | Fwd time: 0.0305191 | Bck time: 0.0450885
2025-05-23 01:11:49,872 - root - INFO - Step: 920 | Loss: 9.78 | Tokens per second: 8885.95 | Training tokens per second (%): 76.00 | MFU (%): 3.71 | TFLOPs: 36.68 | Fwd time: 0.0319948 | Bck time: 0.0448871
2025-05-23 01:11:50,446 - root - INFO - Step: 925 | Loss: 9.63 | Tokens per second: 8930.81 | Training tokens per second (%): 40.98 | MFU (%): 3.73 | TFLOPs: 36.86 | Fwd time: 0.0315481 | Bck time: 0.0448635
2025-05-23 01:11:51,027 - root - INFO - Step: 930 | Loss: 9.80 | Tokens per second: 8843.58 | Training tokens per second (%): 71.88 | MFU (%): 3.69 | TFLOPs: 36.50 | Fwd time: 0.0318232 | Bck time: 0.0452776
2025-05-23 01:11:51,595 - root - INFO - Step: 935 | Loss: 9.99 | Tokens per second: 9030.62 | Training tokens per second (%): 54.55 | MFU (%): 3.77 | TFLOPs: 37.27 | Fwd time: 0.0313765 | Bck time: 0.0442655
2025-05-23 01:11:52,174 - root - INFO - Step: 940 | Loss: 9.89 | Tokens per second: 8871.42 | Training tokens per second (%): 78.89 | MFU (%): 3.70 | TFLOPs: 36.62 | Fwd time: 0.0317519 | Bck time: 0.0449999
2025-05-23 01:11:52,759 - root - INFO - Step: 945 | Loss: 9.73 | Tokens per second: 8770.90 | Training tokens per second (%): 52.44 | MFU (%): 3.66 | TFLOPs: 36.20 | Fwd time: 0.0317811 | Bck time: 0.0457817
2025-05-23 01:11:53,363 - root - INFO - Step: 950 | Loss: 9.25 | Tokens per second: 8487.54 | Training tokens per second (%): 81.87 | MFU (%): 3.54 | TFLOPs: 35.03 | Fwd time: 0.0328464 | Bck time: 0.0454343
2025-05-23 01:11:53,947 - root - INFO - Step: 955 | Loss: 9.30 | Tokens per second: 8786.78 | Training tokens per second (%): 55.59 | MFU (%): 3.67 | TFLOPs: 36.27 | Fwd time: 0.0319997 | Bck time: 0.0454436
2025-05-23 01:11:54,532 - root - INFO - Step: 960 | Loss: 10.02 | Tokens per second: 8783.20 | Training tokens per second (%): 76.97 | MFU (%): 3.67 | TFLOPs: 36.25 | Fwd time: 0.0318771 | Bck time: 0.0450275
2025-05-23 01:11:55,114 - root - INFO - Step: 965 | Loss: 9.90 | Tokens per second: 8821.49 | Training tokens per second (%): 55.33 | MFU (%): 3.68 | TFLOPs: 36.41 | Fwd time: 0.0313633 | Bck time: 0.0451497
2025-05-23 01:11:55,692 - root - INFO - Step: 970 | Loss: 9.89 | Tokens per second: 8876.26 | Training tokens per second (%): 36.58 | MFU (%): 3.70 | TFLOPs: 36.64 | Fwd time: 0.0319240 | Bck time: 0.0450179
2025-05-23 01:11:56,270 - root - INFO - Step: 975 | Loss: 9.48 | Tokens per second: 8879.67 | Training tokens per second (%): 60.94 | MFU (%): 3.71 | TFLOPs: 36.65 | Fwd time: 0.0315786 | Bck time: 0.0450622
2025-05-23 01:11:56,875 - root - INFO - Step: 980 | Loss: 10.12 | Tokens per second: 8476.04 | Training tokens per second (%): 76.52 | MFU (%): 3.54 | TFLOPs: 34.99 | Fwd time: 0.0327842 | Bck time: 0.0447149
2025-05-23 01:11:57,453 - root - INFO - Step: 985 | Loss: 9.66 | Tokens per second: 8882.87 | Training tokens per second (%): 63.61 | MFU (%): 3.71 | TFLOPs: 36.66 | Fwd time: 0.0320653 | Bck time: 0.0454563
2025-05-23 01:11:58,032 - root - INFO - Step: 990 | Loss: 10.06 | Tokens per second: 8865.55 | Training tokens per second (%): 48.40 | MFU (%): 3.70 | TFLOPs: 36.59 | Fwd time: 0.0320627 | Bck time: 0.0448119
2025-05-23 01:11:58,624 - root - INFO - Step: 995 | Loss: 10.03 | Tokens per second: 8669.92 | Training tokens per second (%): 66.09 | MFU (%): 3.62 | TFLOPs: 35.79 | Fwd time: 0.0322203 | Bck time: 0.0451223
2025-05-23 01:11:59,196 - root - INFO - Step: 1000 | Loss: 9.44 | Tokens per second: 8968.27 | Training tokens per second (%): 72.13 | MFU (%): 3.74 | TFLOPs: 37.02 | Fwd time: 0.0318716 | Bck time: 0.0443480
2025-05-23 01:12:03,252 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:12:03,255 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
total_size: 2265124132, bsize: 2265124132, ratio: 2.0
2265124132 2 False
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 58.71844291687012 ms
CPU copy took 5193.026542663574 ms
---------------------- [PERF] Single Checkpoint time is 5.2773942947387695 sec, average is 5.277391195297241
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 58.6705207824707 ms
CPU copy took 5403.494596481323 ms
---------------------- [PERF] Single Checkpoint time is 5.482679843902588 sec, average is 5.380033493041992
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 58.66241455078125 ms
CPU copy took 3620.7752227783203 ms
---------------------- [PERF] Single Checkpoint time is 3.700005054473877 sec, average is 5.277391195297241
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 58.67815017700195 ms
CPU copy took 3453.6852836608887 ms
---------------------- [PERF] Single Checkpoint time is 3.532975912094116 sec, average is 4.488697052001953
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 58.672189712524414 ms
CPU copy took 3465.8305644989014 ms
---------------------- [PERF] Single Checkpoint time is 3.545109272003174 sec, average is 3.700002908706665
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 58.678627014160156 ms
CPU copy took 3544.8672771453857 ms
---------------------- [PERF] Single Checkpoint time is 3.629178047180176 sec, average is 3.664589524269104
---- exit
PR_ADDR_DATA is 0x400a3c350000, PR_ADDR is 0x400a3c0d0000, PEER_CHECK_ADDR is 0x400a3c150000
--------------- init enqueue: 0
--------------- init enqueue: 1
Call dram.alloc, num_batches is 2, batch_size_floats is 2265124132
------------------------- is_distributed is 0, rank is 0
Parall_iter 0, Write new metadata at address 0x400a3c250000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 24, parall_iter is 0, num_threads is 1, last counter is 0, curr_counter is 1
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400a3c350000, curr_pr_arr is 0x400a3c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x400a3c350000!
Thread ID: 1, savenvm_thread_nd took 5100.319458 ms
Thread ID: 1, set_cpu took 0.078621 ms
Threads took 5100.647606 ms
MSYNC 9060496528 TOOK 86.257228 ms
CAS was successful! new counter is 1, is_distributed is 0
******** checkp_info saved in 0x400a3c250000, curr_checkpoint is 0x400a3c250000
0, 1
Parall_iter 1, Write new metadata at address 0x400a3c2d0000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 92, parall_iter is 1, num_threads is 1, last counter is 1, curr_counter is 2
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400c58420000, curr_pr_arr is 0x400c58420000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x400c58420000!
Thread ID: 2, savenvm_thread_nd took 5306.089391 ms
Thread ID: 2, set_cpu took 0.072861 ms
Threads took 5306.310055 ms
MSYNC 9060496528 TOOK 91.241316 ms
CAS was successful! new counter is 2, is_distributed is 0
******** checkp_info saved in 0x400a3c2d0000, curr_checkpoint is 0x400a3c2d0000
1, 2
Parall_iter 0, Write new metadata at address 0x400a3c250000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 115, parall_iter is 0, num_threads is 1, last counter is 2, curr_counter is 3
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400a3c350000, curr_pr_arr is 0x400a3c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x400a3c350000!
Thread ID: 1, savenvm_thread_nd took 2744.470861 ms
Thread ID: 1, set_cpu took 0.091005 ms
Threads took 2744.746148 ms
MSYNC 9060496528 TOOK 870.357584 ms
CAS was successful! new counter is 3, is_distributed is 0
******** checkp_info saved in 0x400a3c250000, curr_checkpoint is 0x400a3c250000
0, 3
Parall_iter 1, Write new metadata at address 0x400a3c2d0000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 52, parall_iter is 1, num_threads is 1, last counter is 3, curr_counter is 4
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400c58420000, curr_pr_arr is 0x400c58420000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x400c58420000!
Thread ID: 2, savenvm_thread_nd took 2648.568123 ms
Thread ID: 2, set_cpu took 0.076605 ms
Threads took 2648.842737 ms
MSYNC 9060496528 TOOK 798.431795 ms
CAS was successful! new counter is 4, is_distributed is 0
******** checkp_info saved in 0x400a3c2d0000, curr_checkpoint is 0x400a3c2d0000
1, 4
Parall_iter 0, Write new metadata at address 0x400a3c250000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 79, parall_iter is 0, num_threads is 1, last counter is 4, curr_counter is 5
Writing offset is 52080, parall_iter_offset is 0
start_pr_arr is 0x400a3c350000, curr_pr_arr is 0x400a3c350000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 2265124132, start addr is 0x400a3c350000!
Thread ID: 1, savenvm_thread_nd took 2652.398971 ms
Thread ID: 1, set_cpu took 0.066941 ms
Threads took 2652.662545 ms
MSYNC 9060496528 TOOK 806.135629 ms
CAS was successful! new counter is 5, is_distributed is 0
******** checkp_info saved in 0x400a3c250000, curr_checkpoint is 0x400a3c250000
0, 5
Parall_iter 1, Write new metadata at address 0x400a3c2d0000
------------------------- savenvmNew, is_distributed is 0, total_size is 2265124132
At savenvmNew, tid is 125, parall_iter is 1, num_threads is 1, last counter is 5, curr_counter is 6
Writing offset is 52080, parall_iter_offset is 2265137152
start_pr_arr is 0x400c58420000, curr_pr_arr is 0x400c58420000, batch_size is 2265124132, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 2265124132
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 2265124132, start addr is 0x400c58420000!
Thread ID: 2, savenvm_thread_nd took 2731.332394 ms
Thread ID: 2, set_cpu took 0.080285 ms
Threads took 2731.584994 ms
MSYNC 9060496528 TOOK 806.762232 ms
CAS was successful! new counter is 6, is_distributed is 0
******** checkp_info saved in 0x400a3c2d0000, curr_checkpoint is 0x400a3c2d0000
1, 6
2025-05-23 01:12:04,288 - root - INFO - Training completed
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
0, 3, 0
1, 4, 3
max_piter is 1
Writing offset is 52080, parall_iter_offset is 2265137152
data_offset is 9063170048
