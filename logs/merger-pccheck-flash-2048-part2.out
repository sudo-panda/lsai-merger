2025-05-23 00:47:04,386 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=2048, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=1000, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, seed=4, checkpoint_dir='/iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts', loss_file='/iopsstor/scratch/cscs/bkundu/lsai-merger/results/bf16/loss-pccheck-flash-2048-part2.csv', checkpoint_freq=100, max_async=1, warmup=3, load_checkpoint=True, non_blocking=False)
2025-05-23 00:47:04,414 - root - INFO - Random state checkpoint loaded from /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 00:47:04,414 - root - INFO - Training will resume from step: 400
2025-05-23 00:47:04,414 - root - INFO - Setting up DataLoaders...
2025-05-23 00:47:07,365 - root - INFO - Setting up Model...
2025-05-23 00:47:23,037 - root - INFO - Loading checkpoint model, optimizer + scheduler
/iopsstor/scratch/cscs/bkundu/lsai-merger/LSAI-Checkpointing/training/utils.py:85: UserWarning: The given buffer is not writable, and PyTorch does not support non-writable tensors. This means you can write to the underlying (supposedly non-writable) buffer using the tensor. You may want to copy the buffer to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at /opt/pytorch/pytorch/torch/csrc/utils/tensor_new.cpp:1561.)
  data = torch.frombuffer(payload, dtype=torch.float32)
2025-05-23 00:47:29,995 - root - INFO - Checkpoint loaded from /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/checkpoint_pccheck.pt
2025-05-23 00:47:30,021 - root - INFO - Loaded optimizer, scheduler checkpoint at step 400 in 6.96 seconds
Model size: 2281834496, Optimizer size: 4563669284, Total size: 6845503780
BSIZE IS 6845503780
At checkpoint, bsize is 6845503780
2025-05-23 00:47:41,669 - root - INFO - Checkpointing warmup done
2025-05-23 00:47:41,673 - root - INFO - ------------------------------------------------------------Starting training!
2025-05-23 00:47:43,791 - root - INFO - Step: 405 | Loss: 10.99 | Tokens per second: 4840.48 | Training tokens per second (%): 26.74 | MFU (%): 6.70 | TFLOPs: 66.27 | Fwd time: 0.0359277 | Bck time: 0.0562001
2025-05-23 00:47:44,471 - root - INFO - Step: 410 | Loss: 11.13 | Tokens per second: 15120.33 | Training tokens per second (%): 35.83 | MFU (%): 20.93 | TFLOPs: 207.01 | Fwd time: 0.0355990 | Bck time: 0.0553034
2025-05-23 00:47:45,154 - root - INFO - Step: 415 | Loss: 11.17 | Tokens per second: 15069.21 | Training tokens per second (%): 54.84 | MFU (%): 20.86 | TFLOPs: 206.31 | Fwd time: 0.0362399 | Bck time: 0.0560190
2025-05-23 00:47:45,835 - root - INFO - Step: 420 | Loss: 10.87 | Tokens per second: 15094.28 | Training tokens per second (%): 26.02 | MFU (%): 20.90 | TFLOPs: 206.66 | Fwd time: 0.0357048 | Bck time: 0.0554728
2025-05-23 00:47:46,516 - root - INFO - Step: 425 | Loss: 10.99 | Tokens per second: 15096.93 | Training tokens per second (%): 20.47 | MFU (%): 20.90 | TFLOPs: 206.69 | Fwd time: 0.0357235 | Bck time: 0.0556995
2025-05-23 00:47:47,196 - root - INFO - Step: 430 | Loss: 11.22 | Tokens per second: 15122.95 | Training tokens per second (%): 46.42 | MFU (%): 20.94 | TFLOPs: 207.05 | Fwd time: 0.0354086 | Bck time: 0.0555873
2025-05-23 00:47:47,893 - root - INFO - Step: 435 | Loss: 10.81 | Tokens per second: 14757.30 | Training tokens per second (%): 57.19 | MFU (%): 20.43 | TFLOPs: 202.04 | Fwd time: 0.0355869 | Bck time: 0.0549490
2025-05-23 00:47:48,571 - root - INFO - Step: 440 | Loss: 10.79 | Tokens per second: 15157.20 | Training tokens per second (%): 29.94 | MFU (%): 20.98 | TFLOPs: 207.52 | Fwd time: 0.0356754 | Bck time: 0.0553126
2025-05-23 00:47:49,254 - root - INFO - Step: 445 | Loss: 10.43 | Tokens per second: 15062.47 | Training tokens per second (%): 48.73 | MFU (%): 20.85 | TFLOPs: 206.22 | Fwd time: 0.0357045 | Bck time: 0.0549849
2025-05-23 00:47:49,933 - root - INFO - Step: 450 | Loss: 10.93 | Tokens per second: 15150.54 | Training tokens per second (%): 50.03 | MFU (%): 20.97 | TFLOPs: 207.43 | Fwd time: 0.0358962 | Bck time: 0.0548554
2025-05-23 00:47:50,621 - root - INFO - Step: 455 | Loss: 10.38 | Tokens per second: 14931.64 | Training tokens per second (%): 59.03 | MFU (%): 20.67 | TFLOPs: 204.43 | Fwd time: 0.0363128 | Bck time: 0.0551080
2025-05-23 00:47:51,302 - root - INFO - Step: 460 | Loss: 10.88 | Tokens per second: 15115.66 | Training tokens per second (%): 40.87 | MFU (%): 20.93 | TFLOPs: 206.95 | Fwd time: 0.0358513 | Bck time: 0.0553206
2025-05-23 00:47:51,986 - root - INFO - Step: 465 | Loss: 10.66 | Tokens per second: 15024.30 | Training tokens per second (%): 49.50 | MFU (%): 20.80 | TFLOPs: 205.70 | Fwd time: 0.0354082 | Bck time: 0.0554234
2025-05-23 00:47:52,669 - root - INFO - Step: 470 | Loss: 10.65 | Tokens per second: 15068.00 | Training tokens per second (%): 46.00 | MFU (%): 20.86 | TFLOPs: 206.30 | Fwd time: 0.0357112 | Bck time: 0.0546189
2025-05-23 00:47:53,355 - root - INFO - Step: 475 | Loss: 11.08 | Tokens per second: 14991.49 | Training tokens per second (%): 53.28 | MFU (%): 20.75 | TFLOPs: 205.25 | Fwd time: 0.0358486 | Bck time: 0.0558003
2025-05-23 00:47:54,032 - root - INFO - Step: 480 | Loss: 10.28 | Tokens per second: 15173.42 | Training tokens per second (%): 46.63 | MFU (%): 21.00 | TFLOPs: 207.74 | Fwd time: 0.0357625 | Bck time: 0.0552160
2025-05-23 00:47:54,710 - root - INFO - Step: 485 | Loss: 10.96 | Tokens per second: 15164.36 | Training tokens per second (%): 24.27 | MFU (%): 20.99 | TFLOPs: 207.62 | Fwd time: 0.0356605 | Bck time: 0.0556918
2025-05-23 00:47:55,394 - root - INFO - Step: 490 | Loss: 11.16 | Tokens per second: 15049.10 | Training tokens per second (%): 31.86 | MFU (%): 20.83 | TFLOPs: 206.04 | Fwd time: 0.0355039 | Bck time: 0.0550027
2025-05-23 00:47:56,085 - root - INFO - Step: 495 | Loss: 11.03 | Tokens per second: 14884.62 | Training tokens per second (%): 33.48 | MFU (%): 20.61 | TFLOPs: 203.79 | Fwd time: 0.0359881 | Bck time: 0.0556292
2025-05-23 00:47:56,769 - root - INFO - Step: 500 | Loss: 11.12 | Tokens per second: 15021.79 | Training tokens per second (%): 55.93 | MFU (%): 20.80 | TFLOPs: 205.66 | Fwd time: 0.0363973 | Bck time: 0.0556169
2025-05-23 00:48:12,312 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 00:48:12,313 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 00:48:13,002 - root - INFO - Step: 505 | Loss: 10.62 | Tokens per second: 630.92 | Training tokens per second (%): 32.19 | MFU (%): 0.87 | TFLOPs: 8.64 | Fwd time: 0.0345751 | Bck time: 0.0546939
2025-05-23 00:48:13,675 - root - INFO - Step: 510 | Loss: 10.91 | Tokens per second: 15281.64 | Training tokens per second (%): 33.70 | MFU (%): 21.15 | TFLOPs: 209.22 | Fwd time: 0.0352591 | Bck time: 0.0547118
2025-05-23 00:48:14,353 - root - INFO - Step: 515 | Loss: 9.92 | Tokens per second: 15184.07 | Training tokens per second (%): 35.54 | MFU (%): 21.02 | TFLOPs: 207.89 | Fwd time: 0.0352482 | Bck time: 0.0556540
2025-05-23 00:48:15,029 - root - INFO - Step: 520 | Loss: 10.49 | Tokens per second: 15214.39 | Training tokens per second (%): 36.02 | MFU (%): 21.06 | TFLOPs: 208.30 | Fwd time: 0.0354950 | Bck time: 0.0555252
2025-05-23 00:48:15,707 - root - INFO - Step: 525 | Loss: 10.54 | Tokens per second: 15160.11 | Training tokens per second (%): 43.12 | MFU (%): 20.99 | TFLOPs: 207.56 | Fwd time: 0.0347420 | Bck time: 0.0548011
2025-05-23 00:48:16,383 - root - INFO - Step: 530 | Loss: 10.72 | Tokens per second: 15219.08 | Training tokens per second (%): 52.23 | MFU (%): 21.07 | TFLOPs: 208.36 | Fwd time: 0.0356800 | Bck time: 0.0548150
2025-05-23 00:48:17,078 - root - INFO - Step: 535 | Loss: 10.81 | Tokens per second: 14780.69 | Training tokens per second (%): 62.50 | MFU (%): 20.46 | TFLOPs: 202.36 | Fwd time: 0.0356660 | Bck time: 0.0544942
2025-05-23 00:48:17,768 - root - INFO - Step: 540 | Loss: 9.44 | Tokens per second: 14913.43 | Training tokens per second (%): 36.82 | MFU (%): 20.65 | TFLOPs: 204.18 | Fwd time: 0.0363262 | Bck time: 0.0541704
2025-05-23 00:48:18,452 - root - INFO - Step: 545 | Loss: 10.46 | Tokens per second: 15025.12 | Training tokens per second (%): 57.97 | MFU (%): 20.80 | TFLOPs: 205.71 | Fwd time: 0.0359207 | Bck time: 0.0547549
2025-05-23 00:48:19,128 - root - INFO - Step: 550 | Loss: 10.78 | Tokens per second: 15211.21 | Training tokens per second (%): 21.77 | MFU (%): 21.06 | TFLOPs: 208.26 | Fwd time: 0.0354747 | Bck time: 0.0550562
2025-05-23 00:48:19,804 - root - INFO - Step: 555 | Loss: 11.42 | Tokens per second: 15209.14 | Training tokens per second (%): 27.19 | MFU (%): 21.05 | TFLOPs: 208.23 | Fwd time: 0.0357538 | Bck time: 0.0546818
2025-05-23 00:48:20,480 - root - INFO - Step: 560 | Loss: 10.94 | Tokens per second: 15222.41 | Training tokens per second (%): 42.37 | MFU (%): 21.07 | TFLOPs: 208.41 | Fwd time: 0.0351468 | Bck time: 0.0549856
2025-05-23 00:48:21,154 - root - INFO - Step: 565 | Loss: 10.76 | Tokens per second: 15264.30 | Training tokens per second (%): 21.70 | MFU (%): 21.13 | TFLOPs: 208.98 | Fwd time: 0.0354308 | Bck time: 0.0546500
2025-05-23 00:48:21,826 - root - INFO - Step: 570 | Loss: 10.94 | Tokens per second: 15288.57 | Training tokens per second (%): 19.83 | MFU (%): 21.16 | TFLOPs: 209.32 | Fwd time: 0.0361124 | Bck time: 0.0538464
2025-05-23 00:48:22,501 - root - INFO - Step: 575 | Loss: 10.45 | Tokens per second: 15254.87 | Training tokens per second (%): 23.92 | MFU (%): 21.12 | TFLOPs: 208.85 | Fwd time: 0.0353209 | Bck time: 0.0552321
2025-05-23 00:48:23,178 - root - INFO - Step: 580 | Loss: 11.12 | Tokens per second: 15172.40 | Training tokens per second (%): 14.81 | MFU (%): 21.00 | TFLOPs: 207.73 | Fwd time: 0.0356083 | Bck time: 0.0549162
2025-05-23 00:48:23,857 - root - INFO - Step: 585 | Loss: 10.21 | Tokens per second: 15153.55 | Training tokens per second (%): 32.60 | MFU (%): 20.98 | TFLOPs: 207.47 | Fwd time: 0.0354553 | Bck time: 0.0551632
2025-05-23 00:48:24,527 - root - INFO - Step: 590 | Loss: 10.60 | Tokens per second: 15352.93 | Training tokens per second (%): 32.20 | MFU (%): 21.25 | TFLOPs: 210.20 | Fwd time: 0.0344890 | Bck time: 0.0524958
2025-05-23 00:48:25,200 - root - INFO - Step: 595 | Loss: 10.83 | Tokens per second: 15277.64 | Training tokens per second (%): 23.82 | MFU (%): 21.15 | TFLOPs: 209.17 | Fwd time: 0.0353561 | Bck time: 0.0545421
2025-05-23 00:48:25,877 - root - INFO - Step: 600 | Loss: 10.48 | Tokens per second: 15176.88 | Training tokens per second (%): 22.92 | MFU (%): 21.01 | TFLOPs: 207.79 | Fwd time: 0.0358251 | Bck time: 0.0553893
2025-05-23 00:48:41,667 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 00:48:41,669 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 00:48:42,489 - root - INFO - Step: 605 | Loss: 10.73 | Tokens per second: 616.53 | Training tokens per second (%): 33.96 | MFU (%): 0.85 | TFLOPs: 8.44 | Fwd time: 0.0455090 | Bck time: 0.0554301
2025-05-23 00:48:43,178 - root - INFO - Step: 610 | Loss: 11.13 | Tokens per second: 14930.67 | Training tokens per second (%): 30.22 | MFU (%): 20.67 | TFLOPs: 204.42 | Fwd time: 0.0356117 | Bck time: 0.0547148
2025-05-23 00:48:45,117 - root - INFO - Step: 615 | Loss: 10.58 | Tokens per second: 5290.86 | Training tokens per second (%): 44.69 | MFU (%): 7.32 | TFLOPs: 72.44 | Fwd time: 0.2837816 | Bck time: 0.2819286
2025-05-23 00:48:48,178 - root - INFO - Step: 620 | Loss: 10.03 | Tokens per second: 3348.30 | Training tokens per second (%): 29.02 | MFU (%): 4.64 | TFLOPs: 45.84 | Fwd time: 0.2859376 | Bck time: 0.2705069
2025-05-23 00:48:51,333 - root - INFO - Step: 625 | Loss: 10.49 | Tokens per second: 3248.94 | Training tokens per second (%): 40.37 | MFU (%): 4.50 | TFLOPs: 44.48 | Fwd time: 0.2767320 | Bck time: 0.3084018
2025-05-23 00:48:54,524 - root - INFO - Step: 630 | Loss: 10.44 | Tokens per second: 3211.74 | Training tokens per second (%): 27.91 | MFU (%): 4.45 | TFLOPs: 43.97 | Fwd time: 0.3038499 | Bck time: 0.2715266
2025-05-23 00:48:57,344 - root - INFO - Step: 635 | Loss: 10.77 | Tokens per second: 3635.11 | Training tokens per second (%): 52.14 | MFU (%): 5.03 | TFLOPs: 49.77 | Fwd time: 0.1435191 | Bck time: 0.0573509
2025-05-23 00:48:58,027 - root - INFO - Step: 640 | Loss: 10.60 | Tokens per second: 15050.87 | Training tokens per second (%): 30.87 | MFU (%): 20.84 | TFLOPs: 206.06 | Fwd time: 0.0357602 | Bck time: 0.0557978
2025-05-23 00:48:58,705 - root - INFO - Step: 645 | Loss: 10.34 | Tokens per second: 15160.08 | Training tokens per second (%): 31.95 | MFU (%): 20.99 | TFLOPs: 207.56 | Fwd time: 0.0352060 | Bck time: 0.0553577
2025-05-23 00:48:59,387 - root - INFO - Step: 650 | Loss: 9.99 | Tokens per second: 15098.35 | Training tokens per second (%): 62.01 | MFU (%): 20.90 | TFLOPs: 206.71 | Fwd time: 0.0359114 | Bck time: 0.0548363
2025-05-23 00:49:00,071 - root - INFO - Step: 655 | Loss: 10.33 | Tokens per second: 15029.66 | Training tokens per second (%): 34.36 | MFU (%): 20.81 | TFLOPs: 205.77 | Fwd time: 0.0353923 | Bck time: 0.0545803
2025-05-23 00:49:00,745 - root - INFO - Step: 660 | Loss: 10.31 | Tokens per second: 15261.86 | Training tokens per second (%): 26.00 | MFU (%): 21.13 | TFLOPs: 208.95 | Fwd time: 0.0360695 | Bck time: 0.0548540
2025-05-23 00:49:01,432 - root - INFO - Step: 665 | Loss: 10.37 | Tokens per second: 14967.38 | Training tokens per second (%): 50.09 | MFU (%): 20.72 | TFLOPs: 204.92 | Fwd time: 0.0355308 | Bck time: 0.0547842
2025-05-23 00:49:02,106 - root - INFO - Step: 670 | Loss: 9.47 | Tokens per second: 15252.21 | Training tokens per second (%): 36.77 | MFU (%): 21.11 | TFLOPs: 208.82 | Fwd time: 0.0358035 | Bck time: 0.0550474
2025-05-23 00:49:02,786 - root - INFO - Step: 675 | Loss: 9.73 | Tokens per second: 15118.61 | Training tokens per second (%): 18.53 | MFU (%): 20.93 | TFLOPs: 206.99 | Fwd time: 0.0356578 | Bck time: 0.0546550
2025-05-23 00:49:03,464 - root - INFO - Step: 680 | Loss: 10.01 | Tokens per second: 15178.67 | Training tokens per second (%): 42.48 | MFU (%): 21.01 | TFLOPs: 207.81 | Fwd time: 0.0356109 | Bck time: 0.0548048
2025-05-23 00:49:04,140 - root - INFO - Step: 685 | Loss: 10.47 | Tokens per second: 15213.41 | Training tokens per second (%): 39.21 | MFU (%): 21.06 | TFLOPs: 208.29 | Fwd time: 0.0352919 | Bck time: 0.0550098
2025-05-23 00:49:04,808 - root - INFO - Step: 690 | Loss: 9.75 | Tokens per second: 15390.06 | Training tokens per second (%): 14.64 | MFU (%): 21.30 | TFLOPs: 210.71 | Fwd time: 0.0357739 | Bck time: 0.0532892
2025-05-23 00:49:05,500 - root - INFO - Step: 695 | Loss: 10.22 | Tokens per second: 14851.08 | Training tokens per second (%): 69.60 | MFU (%): 20.56 | TFLOPs: 203.33 | Fwd time: 0.0358957 | Bck time: 0.0542884
2025-05-23 00:49:06,173 - root - INFO - Step: 700 | Loss: 9.85 | Tokens per second: 15287.60 | Training tokens per second (%): 38.46 | MFU (%): 21.16 | TFLOPs: 209.30 | Fwd time: 0.0352845 | Bck time: 0.0545115
2025-05-23 00:49:22,048 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 00:49:22,050 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 00:49:24,849 - root - INFO - Step: 705 | Loss: 10.08 | Tokens per second: 548.40 | Training tokens per second (%): 41.45 | MFU (%): 0.76 | TFLOPs: 7.51 | Fwd time: 0.0344071 | Bck time: 0.0577322
2025-05-23 00:49:25,525 - root - INFO - Step: 710 | Loss: 10.11 | Tokens per second: 15196.77 | Training tokens per second (%): 65.75 | MFU (%): 21.04 | TFLOPs: 208.06 | Fwd time: 0.0356682 | Bck time: 0.0548582
2025-05-23 00:49:26,206 - root - INFO - Step: 715 | Loss: 9.73 | Tokens per second: 15109.97 | Training tokens per second (%): 38.32 | MFU (%): 20.92 | TFLOPs: 206.87 | Fwd time: 0.0355259 | Bck time: 0.0548112
2025-05-23 00:49:26,874 - root - INFO - Step: 720 | Loss: 8.52 | Tokens per second: 15394.67 | Training tokens per second (%): 23.34 | MFU (%): 21.31 | TFLOPs: 210.77 | Fwd time: 0.0354650 | Bck time: 0.0540867
2025-05-23 00:49:27,542 - root - INFO - Step: 725 | Loss: 9.83 | Tokens per second: 15407.71 | Training tokens per second (%): 19.70 | MFU (%): 21.33 | TFLOPs: 210.95 | Fwd time: 0.0352168 | Bck time: 0.0545440
2025-05-23 00:49:28,216 - root - INFO - Step: 730 | Loss: 9.93 | Tokens per second: 15253.70 | Training tokens per second (%): 22.53 | MFU (%): 21.12 | TFLOPs: 208.84 | Fwd time: 0.0354542 | Bck time: 0.0545469
2025-05-23 00:49:28,887 - root - INFO - Step: 735 | Loss: 9.65 | Tokens per second: 15326.08 | Training tokens per second (%): 18.57 | MFU (%): 21.22 | TFLOPs: 209.83 | Fwd time: 0.0348391 | Bck time: 0.0550312
2025-05-23 00:49:29,565 - root - INFO - Step: 740 | Loss: 10.06 | Tokens per second: 15170.16 | Training tokens per second (%): 38.10 | MFU (%): 21.00 | TFLOPs: 207.69 | Fwd time: 0.0361489 | Bck time: 0.0543836
2025-05-23 00:49:30,235 - root - INFO - Step: 745 | Loss: 9.76 | Tokens per second: 15347.65 | Training tokens per second (%): 19.01 | MFU (%): 21.25 | TFLOPs: 210.12 | Fwd time: 0.0349719 | Bck time: 0.0543491
2025-05-23 00:49:30,908 - root - INFO - Step: 750 | Loss: 9.48 | Tokens per second: 15283.63 | Training tokens per second (%): 38.02 | MFU (%): 21.16 | TFLOPs: 209.25 | Fwd time: 0.0358474 | Bck time: 0.0546891
2025-05-23 00:49:31,579 - root - INFO - Step: 755 | Loss: 9.39 | Tokens per second: 15322.10 | Training tokens per second (%): 39.84 | MFU (%): 21.21 | TFLOPs: 209.77 | Fwd time: 0.0352888 | Bck time: 0.0542402
2025-05-23 00:49:32,254 - root - INFO - Step: 760 | Loss: 9.52 | Tokens per second: 15231.23 | Training tokens per second (%): 66.40 | MFU (%): 21.09 | TFLOPs: 208.53 | Fwd time: 0.0355787 | Bck time: 0.0550199
2025-05-23 00:49:32,937 - root - INFO - Step: 765 | Loss: 9.29 | Tokens per second: 15066.54 | Training tokens per second (%): 71.65 | MFU (%): 20.86 | TFLOPs: 206.28 | Fwd time: 0.0358729 | Bck time: 0.0545578
2025-05-23 00:49:33,606 - root - INFO - Step: 770 | Loss: 8.94 | Tokens per second: 15355.14 | Training tokens per second (%): 37.12 | MFU (%): 21.26 | TFLOPs: 210.23 | Fwd time: 0.0356770 | Bck time: 0.0540790
2025-05-23 00:49:34,285 - root - INFO - Step: 775 | Loss: 8.85 | Tokens per second: 15152.87 | Training tokens per second (%): 39.87 | MFU (%): 20.98 | TFLOPs: 207.46 | Fwd time: 0.0362989 | Bck time: 0.0552927
2025-05-23 00:49:34,956 - root - INFO - Step: 780 | Loss: 9.87 | Tokens per second: 15321.07 | Training tokens per second (%): 24.48 | MFU (%): 21.21 | TFLOPs: 209.76 | Fwd time: 0.0353392 | Bck time: 0.0548605
2025-05-23 00:49:35,630 - root - INFO - Step: 785 | Loss: 9.02 | Tokens per second: 15257.34 | Training tokens per second (%): 34.96 | MFU (%): 21.12 | TFLOPs: 208.89 | Fwd time: 0.0357326 | Bck time: 0.0546455
2025-05-23 00:49:36,296 - root - INFO - Step: 790 | Loss: 9.04 | Tokens per second: 15445.68 | Training tokens per second (%): 37.27 | MFU (%): 21.38 | TFLOPs: 211.47 | Fwd time: 0.0359289 | Bck time: 0.0543265
2025-05-23 00:49:36,985 - root - INFO - Step: 795 | Loss: 8.50 | Tokens per second: 14935.39 | Training tokens per second (%): 58.36 | MFU (%): 20.68 | TFLOPs: 204.48 | Fwd time: 0.0356703 | Bck time: 0.0552001
2025-05-23 00:49:37,665 - root - INFO - Step: 800 | Loss: 8.76 | Tokens per second: 15120.99 | Training tokens per second (%): 46.09 | MFU (%): 20.93 | TFLOPs: 207.02 | Fwd time: 0.0357690 | Bck time: 0.0551117
2025-05-23 00:49:53,142 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 00:49:53,144 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 00:49:53,838 - root - INFO - Step: 805 | Loss: 8.88 | Tokens per second: 633.26 | Training tokens per second (%): 56.74 | MFU (%): 0.88 | TFLOPs: 8.67 | Fwd time: 0.0367068 | Bck time: 0.0539839
2025-05-23 00:49:54,513 - root - INFO - Step: 810 | Loss: 8.71 | Tokens per second: 15227.16 | Training tokens per second (%): 34.25 | MFU (%): 21.08 | TFLOPs: 208.48 | Fwd time: 0.0368516 | Bck time: 0.0539215
2025-05-23 00:49:55,198 - root - INFO - Step: 815 | Loss: 9.40 | Tokens per second: 15013.61 | Training tokens per second (%): 42.13 | MFU (%): 20.78 | TFLOPs: 205.55 | Fwd time: 0.0368369 | Bck time: 0.0541478
2025-05-23 00:49:55,880 - root - INFO - Step: 820 | Loss: 8.60 | Tokens per second: 15073.41 | Training tokens per second (%): 37.11 | MFU (%): 20.87 | TFLOPs: 206.37 | Fwd time: 0.0368609 | Bck time: 0.0552237
2025-05-23 00:49:56,568 - root - INFO - Step: 825 | Loss: 8.86 | Tokens per second: 14963.15 | Training tokens per second (%): 64.04 | MFU (%): 20.71 | TFLOPs: 204.86 | Fwd time: 0.0362649 | Bck time: 0.0553027
2025-05-23 00:49:57,248 - root - INFO - Step: 830 | Loss: 8.85 | Tokens per second: 15113.60 | Training tokens per second (%): 38.42 | MFU (%): 20.92 | TFLOPs: 206.92 | Fwd time: 0.0367068 | Bck time: 0.0550690
2025-05-23 00:49:57,933 - root - INFO - Step: 835 | Loss: 8.92 | Tokens per second: 15022.03 | Training tokens per second (%): 18.90 | MFU (%): 20.80 | TFLOPs: 205.67 | Fwd time: 0.0355622 | Bck time: 0.0558551
2025-05-23 00:49:58,615 - root - INFO - Step: 840 | Loss: 8.87 | Tokens per second: 15069.18 | Training tokens per second (%): 17.96 | MFU (%): 20.86 | TFLOPs: 206.31 | Fwd time: 0.0360370 | Bck time: 0.0549146
2025-05-23 00:49:59,298 - root - INFO - Step: 845 | Loss: 9.12 | Tokens per second: 15049.87 | Training tokens per second (%): 28.84 | MFU (%): 20.83 | TFLOPs: 206.05 | Fwd time: 0.0367695 | Bck time: 0.0551931
2025-05-23 00:49:59,983 - root - INFO - Step: 850 | Loss: 8.50 | Tokens per second: 15012.12 | Training tokens per second (%): 28.53 | MFU (%): 20.78 | TFLOPs: 205.53 | Fwd time: 0.0363132 | Bck time: 0.0554157
2025-05-23 00:50:00,670 - root - INFO - Step: 855 | Loss: 8.85 | Tokens per second: 14968.29 | Training tokens per second (%): 60.01 | MFU (%): 20.72 | TFLOPs: 204.93 | Fwd time: 0.0361469 | Bck time: 0.0550862
2025-05-23 00:50:01,353 - root - INFO - Step: 860 | Loss: 8.92 | Tokens per second: 15050.62 | Training tokens per second (%): 17.26 | MFU (%): 20.83 | TFLOPs: 206.06 | Fwd time: 0.0369027 | Bck time: 0.0540438
2025-05-23 00:50:02,034 - root - INFO - Step: 865 | Loss: 8.21 | Tokens per second: 15117.74 | Training tokens per second (%): 30.07 | MFU (%): 20.93 | TFLOPs: 206.98 | Fwd time: 0.0358506 | Bck time: 0.0547497
2025-05-23 00:50:02,716 - root - INFO - Step: 870 | Loss: 8.58 | Tokens per second: 15071.05 | Training tokens per second (%): 44.47 | MFU (%): 20.86 | TFLOPs: 206.34 | Fwd time: 0.0368380 | Bck time: 0.0543165
2025-05-23 00:50:03,399 - root - INFO - Step: 875 | Loss: 8.54 | Tokens per second: 15052.91 | Training tokens per second (%): 27.70 | MFU (%): 20.84 | TFLOPs: 206.09 | Fwd time: 0.0364747 | Bck time: 0.0546810
2025-05-23 00:50:04,082 - root - INFO - Step: 880 | Loss: 9.17 | Tokens per second: 15055.66 | Training tokens per second (%): 30.81 | MFU (%): 20.84 | TFLOPs: 206.13 | Fwd time: 0.0369536 | Bck time: 0.0546083
2025-05-23 00:50:04,767 - root - INFO - Step: 885 | Loss: 8.28 | Tokens per second: 15022.21 | Training tokens per second (%): 55.39 | MFU (%): 20.80 | TFLOPs: 205.67 | Fwd time: 0.0363160 | Bck time: 0.0550934
2025-05-23 00:50:05,450 - root - INFO - Step: 890 | Loss: 8.40 | Tokens per second: 15051.68 | Training tokens per second (%): 46.77 | MFU (%): 20.84 | TFLOPs: 206.07 | Fwd time: 0.0366407 | Bck time: 0.0542355
2025-05-23 00:50:06,130 - root - INFO - Step: 895 | Loss: 9.03 | Tokens per second: 15115.95 | Training tokens per second (%): 25.31 | MFU (%): 20.93 | TFLOPs: 206.95 | Fwd time: 0.0366771 | Bck time: 0.0546229
2025-05-23 00:50:06,810 - root - INFO - Step: 900 | Loss: 8.74 | Tokens per second: 15121.84 | Training tokens per second (%): 28.43 | MFU (%): 20.93 | TFLOPs: 207.03 | Fwd time: 0.0367601 | Bck time: 0.0548021
2025-05-23 00:50:22,604 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 00:50:22,606 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 00:50:23,290 - root - INFO - Step: 905 | Loss: 8.99 | Tokens per second: 621.48 | Training tokens per second (%): 23.78 | MFU (%): 0.86 | TFLOPs: 8.51 | Fwd time: 0.0357060 | Bck time: 0.0541618
2025-05-23 00:50:23,966 - root - INFO - Step: 910 | Loss: 8.26 | Tokens per second: 15206.61 | Training tokens per second (%): 52.56 | MFU (%): 21.05 | TFLOPs: 208.19 | Fwd time: 0.0358512 | Bck time: 0.0548646
2025-05-23 00:50:24,642 - root - INFO - Step: 915 | Loss: 8.67 | Tokens per second: 15220.30 | Training tokens per second (%): 24.68 | MFU (%): 21.07 | TFLOPs: 208.38 | Fwd time: 0.0356548 | Bck time: 0.0546020
2025-05-23 00:50:25,319 - root - INFO - Step: 920 | Loss: 8.41 | Tokens per second: 15198.78 | Training tokens per second (%): 38.97 | MFU (%): 21.04 | TFLOPs: 208.09 | Fwd time: 0.0366343 | Bck time: 0.0552966
2025-05-23 00:50:25,998 - root - INFO - Step: 925 | Loss: 8.21 | Tokens per second: 15143.76 | Training tokens per second (%): 20.49 | MFU (%): 20.96 | TFLOPs: 207.33 | Fwd time: 0.0362437 | Bck time: 0.0548659
2025-05-23 00:50:27,209 - root - INFO - Step: 930 | Loss: 8.30 | Tokens per second: 8475.16 | Training tokens per second (%): 45.94 | MFU (%): 11.73 | TFLOPs: 116.03 | Fwd time: 0.0354570 | Bck time: 0.0550881
2025-05-23 00:50:27,886 - root - INFO - Step: 935 | Loss: 8.79 | Tokens per second: 15186.26 | Training tokens per second (%): 27.28 | MFU (%): 21.02 | TFLOPs: 207.92 | Fwd time: 0.0355615 | Bck time: 0.0552516
2025-05-23 00:50:28,560 - root - INFO - Step: 940 | Loss: 8.42 | Tokens per second: 15265.02 | Training tokens per second (%): 40.39 | MFU (%): 21.13 | TFLOPs: 208.99 | Fwd time: 0.0361809 | Bck time: 0.0547378
2025-05-23 00:50:29,242 - root - INFO - Step: 945 | Loss: 8.65 | Tokens per second: 15058.87 | Training tokens per second (%): 36.22 | MFU (%): 20.85 | TFLOPs: 206.17 | Fwd time: 0.0356722 | Bck time: 0.0548658
2025-05-23 00:50:29,938 - root - INFO - Step: 950 | Loss: 8.11 | Tokens per second: 14778.49 | Training tokens per second (%): 68.71 | MFU (%): 20.46 | TFLOPs: 202.33 | Fwd time: 0.0361414 | Bck time: 0.0549182
2025-05-23 00:50:30,616 - root - INFO - Step: 955 | Loss: 8.13 | Tokens per second: 15171.20 | Training tokens per second (%): 28.65 | MFU (%): 21.00 | TFLOPs: 207.71 | Fwd time: 0.0357547 | Bck time: 0.0550152
2025-05-23 00:50:31,295 - root - INFO - Step: 960 | Loss: 8.59 | Tokens per second: 15140.28 | Training tokens per second (%): 66.72 | MFU (%): 20.96 | TFLOPs: 207.29 | Fwd time: 0.0360852 | Bck time: 0.0547931
2025-05-23 00:50:31,975 - root - INFO - Step: 965 | Loss: 8.62 | Tokens per second: 15128.53 | Training tokens per second (%): 29.86 | MFU (%): 20.94 | TFLOPs: 207.12 | Fwd time: 0.0357370 | Bck time: 0.0548515
2025-05-23 00:50:32,655 - root - INFO - Step: 970 | Loss: 8.51 | Tokens per second: 15121.11 | Training tokens per second (%): 18.29 | MFU (%): 20.93 | TFLOPs: 207.02 | Fwd time: 0.0363180 | Bck time: 0.0550076
2025-05-23 00:50:33,340 - root - INFO - Step: 975 | Loss: 7.96 | Tokens per second: 15021.32 | Training tokens per second (%): 30.81 | MFU (%): 20.79 | TFLOPs: 205.66 | Fwd time: 0.0365298 | Bck time: 0.0548440
2025-05-23 00:50:34,032 - root - INFO - Step: 980 | Loss: 8.94 | Tokens per second: 14848.48 | Training tokens per second (%): 59.73 | MFU (%): 20.56 | TFLOPs: 203.29 | Fwd time: 0.0350275 | Bck time: 0.0542569
2025-05-23 00:50:34,703 - root - INFO - Step: 985 | Loss: 8.27 | Tokens per second: 15330.77 | Training tokens per second (%): 32.12 | MFU (%): 21.22 | TFLOPs: 209.89 | Fwd time: 0.0356981 | Bck time: 0.0552155
2025-05-23 00:50:35,376 - root - INFO - Step: 990 | Loss: 8.72 | Tokens per second: 15277.28 | Training tokens per second (%): 24.20 | MFU (%): 21.15 | TFLOPs: 209.16 | Fwd time: 0.0354895 | Bck time: 0.0542492
2025-05-23 00:50:36,060 - root - INFO - Step: 995 | Loss: 8.63 | Tokens per second: 15027.04 | Training tokens per second (%): 53.05 | MFU (%): 20.80 | TFLOPs: 205.74 | Fwd time: 0.0351698 | Bck time: 0.0550855
2025-05-23 00:50:36,733 - root - INFO - Step: 1000 | Loss: 7.94 | Tokens per second: 15301.43 | Training tokens per second (%): 36.98 | MFU (%): 21.18 | TFLOPs: 209.49 | Fwd time: 0.0366225 | Bck time: 0.0545145
2025-05-23 00:50:53,280 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 00:50:53,282 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
total_size: 6845503780, bsize: 6845503780, ratio: 2.0
6845503780 2 False
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 321.31147384643555 ms
CPU copy took 13197.53098487854 ms
---------------------- [PERF] Single Checkpoint time is 13.539662837982178 sec, average is 13.539657831192017
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 281.90064430236816 ms
CPU copy took 12887.729167938232 ms
---------------------- [PERF] Single Checkpoint time is 13.190280437469482 sec, average is 13.364967584609985
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 318.41158866882324 ms
CPU copy took 12639.701128005981 ms
---------------------- [PERF] Single Checkpoint time is 12.978773593902588 sec, average is 13.190277338027954
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 318.3257579803467 ms
CPU copy took 12508.772373199463 ms
---------------------- [PERF] Single Checkpoint time is 12.852823972702026 sec, average is 13.084523677825928
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 282.4068069458008 ms
CPU copy took 12424.35359954834 ms
---------------------- [PERF] Single Checkpoint time is 12.72738242149353 sec, average is 12.978770017623901
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 282.57012367248535 ms
CPU copy took 14016.434907913208 ms
---------------------- [PERF] Single Checkpoint time is 14.319651126861572 sec, average is 13.084523677825928
---- exit
PR_ADDR_DATA is 0x4014e0410000, PR_ADDR is 0x4014e0190000, PEER_CHECK_ADDR is 0x4014e0210000
--------------- init enqueue: 0
--------------- init enqueue: 1
Call dram.alloc, num_batches is 2, batch_size_floats is 6845503780
------------------------- is_distributed is 0, rank is 0
Parall_iter 0, Write new metadata at address 0x4014e0310000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 72, parall_iter is 0, num_threads is 1, last counter is 0, curr_counter is 1
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x4014e0410000, curr_pr_arr is 0x4014e0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x4014e0410000!
Thread ID: 1, savenvm_thread_nd took 13111.857839 ms
Thread ID: 1, set_cpu took 0.093246 ms
Threads took 13112.243716 ms
MSYNC 27382015120 TOOK 78.398710 ms
CAS was successful! new counter is 1, is_distributed is 0
******** checkp_info saved in 0x4014e0310000, curr_checkpoint is 0x4014e0310000
0, 1
Parall_iter 1, Write new metadata at address 0x4014e0390000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 9, parall_iter is 1, num_threads is 1, last counter is 1, curr_counter is 2
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401b405a0000, curr_pr_arr is 0x401b405a0000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401b405a0000!
Thread ID: 2, savenvm_thread_nd took 12814.882350 ms
Thread ID: 2, set_cpu took 0.082846 ms
Threads took 12815.153543 ms
MSYNC 27382015120 TOOK 66.661205 ms
CAS was successful! new counter is 2, is_distributed is 0
******** checkp_info saved in 0x4014e0390000, curr_checkpoint is 0x4014e0390000
1, 2
Parall_iter 0, Write new metadata at address 0x4014e0310000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 113, parall_iter is 0, num_threads is 1, last counter is 2, curr_counter is 3
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x4014e0410000, curr_pr_arr is 0x4014e0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x4014e0410000!
Thread ID: 1, savenvm_thread_nd took 12606.440033 ms
Thread ID: 1, set_cpu took 0.086110 ms
Threads took 12606.739929 ms
MSYNC 27382015120 TOOK 25.221782 ms
CAS was successful! new counter is 3, is_distributed is 0
******** checkp_info saved in 0x4014e0310000, curr_checkpoint is 0x4014e0310000
0, 3
Parall_iter 1, Write new metadata at address 0x4014e0390000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 71, parall_iter is 1, num_threads is 1, last counter is 3, curr_counter is 4
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401b405a0000, curr_pr_arr is 0x401b405a0000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401b405a0000!
Thread ID: 2, savenvm_thread_nd took 12434.944755 ms
Thread ID: 2, set_cpu took 0.101309 ms
Threads took 12435.235211 ms
MSYNC 27382015120 TOOK 67.247813 ms
CAS was successful! new counter is 4, is_distributed is 0
******** checkp_info saved in 0x4014e0390000, curr_checkpoint is 0x4014e0390000
1, 4
Parall_iter 0, Write new metadata at address 0x4014e0310000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 5, parall_iter is 0, num_threads is 1, last counter is 4, curr_counter is 5
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x4014e0410000, curr_pr_arr is 0x4014e0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x4014e0410000!
Thread ID: 1, savenvm_thread_nd took 12353.545229 ms
Thread ID: 1, set_cpu took 0.088605 ms
Threads took 12353.825029 ms
MSYNC 27382015120 TOOK 64.649004 ms
CAS was successful! new counter is 5, is_distributed is 0
******** checkp_info saved in 0x4014e0310000, curr_checkpoint is 0x4014e0310000
0, 5
Parall_iter 1, Write new metadata at address 0x4014e0390000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 87, parall_iter is 1, num_threads is 1, last counter is 5, curr_counter is 6
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401b405a0000, curr_pr_arr is 0x401b405a0000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401b405a0000!
Thread ID: 2, savenvm_thread_nd took 13951.969690 ms
Thread ID: 2, set_cpu took 0.094334 ms
Threads took 13952.246835 ms
MSYNC 27382015120 TOOK 58.594677 ms
CAS was successful! new counter is 6, is_distributed is 0
******** checkp_info saved in 0x4014e0390000, curr_checkpoint is 0x4014e0390000
1, 6
2025-05-23 00:51:03,016 - root - INFO - Training completed
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
0, 3, 0
1, 4, 3
max_piter is 1
Writing offset is 39792, parall_iter_offset is 6845513728
data_offset is 27384676352
