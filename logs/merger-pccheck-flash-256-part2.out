2025-05-23 02:50:51,770 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=256, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=1000, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, seed=4, checkpoint_dir='/iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts', loss_file='/iopsstor/scratch/cscs/bkundu/lsai-merger/results/bf16/loss-pccheck-flash-256-part2.csv', checkpoint_freq=100, max_async=1, warmup=3, load_checkpoint=True, non_blocking=False)
2025-05-23 02:50:51,792 - root - INFO - Random state checkpoint loaded from /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 02:50:51,792 - root - INFO - Training will resume from step: 400
2025-05-23 02:50:51,792 - root - INFO - Setting up DataLoaders...
2025-05-23 02:50:57,574 - root - INFO - Setting up Model...
2025-05-23 02:51:13,124 - root - INFO - Loading checkpoint model, optimizer + scheduler
/iopsstor/scratch/cscs/bkundu/lsai-merger/LSAI-Checkpointing/training/utils.py:85: UserWarning: The given buffer is not writable, and PyTorch does not support non-writable tensors. This means you can write to the underlying (supposedly non-writable) buffer using the tensor. You may want to copy the buffer to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at /opt/pytorch/pytorch/torch/csrc/utils/tensor_new.cpp:1561.)
  data = torch.frombuffer(payload, dtype=torch.float32)
2025-05-23 02:51:20,516 - root - INFO - Checkpoint loaded from /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/checkpoint_pccheck.pt
2025-05-23 02:51:20,541 - root - INFO - Loaded optimizer, scheduler checkpoint at step 400 in 7.40 seconds
Model size: 2281834496, Optimizer size: 4563669284, Total size: 6845503780
BSIZE IS 6845503780
At checkpoint, bsize is 6845503780
2025-05-23 02:51:32,475 - root - INFO - Checkpointing warmup done
2025-05-23 02:51:32,478 - root - INFO - ------------------------------------------------------------Starting training!
2025-05-23 02:51:34,138 - root - INFO - Step: 405 | Loss: 11.20 | Tokens per second: 772.51 | Training tokens per second (%): 87.97 | MFU (%): 0.96 | TFLOPs: 9.49 | Fwd time: 0.0388059 | Bck time: 0.0538295
2025-05-23 02:51:34,843 - root - INFO - Step: 410 | Loss: 11.29 | Tokens per second: 1824.26 | Training tokens per second (%): 100.00 | MFU (%): 2.27 | TFLOPs: 22.41 | Fwd time: 0.0379006 | Bck time: 0.0542279
2025-05-23 02:51:35,542 - root - INFO - Step: 415 | Loss: 11.36 | Tokens per second: 1837.99 | Training tokens per second (%): 93.98 | MFU (%): 2.28 | TFLOPs: 22.57 | Fwd time: 0.0336360 | Bck time: 0.0534345
2025-05-23 02:51:36,227 - root - INFO - Step: 420 | Loss: 10.96 | Tokens per second: 1878.15 | Training tokens per second (%): 91.80 | MFU (%): 2.33 | TFLOPs: 23.07 | Fwd time: 0.0362448 | Bck time: 0.0530450
2025-05-23 02:51:36,910 - root - INFO - Step: 425 | Loss: 11.22 | Tokens per second: 1881.33 | Training tokens per second (%): 96.25 | MFU (%): 2.34 | TFLOPs: 23.11 | Fwd time: 0.0369760 | Bck time: 0.0531855
2025-05-23 02:51:37,611 - root - INFO - Step: 430 | Loss: 11.42 | Tokens per second: 1834.16 | Training tokens per second (%): 100.00 | MFU (%): 2.28 | TFLOPs: 22.53 | Fwd time: 0.0373296 | Bck time: 0.0531518
2025-05-23 02:51:38,298 - root - INFO - Step: 435 | Loss: 10.90 | Tokens per second: 1870.77 | Training tokens per second (%): 100.00 | MFU (%): 2.32 | TFLOPs: 22.98 | Fwd time: 0.0360305 | Bck time: 0.0528092
2025-05-23 02:51:38,967 - root - INFO - Step: 440 | Loss: 10.99 | Tokens per second: 1919.57 | Training tokens per second (%): 93.52 | MFU (%): 2.38 | TFLOPs: 23.58 | Fwd time: 0.0351851 | Bck time: 0.0530629
2025-05-23 02:51:39,669 - root - INFO - Step: 445 | Loss: 10.91 | Tokens per second: 1831.16 | Training tokens per second (%): 96.88 | MFU (%): 2.27 | TFLOPs: 22.49 | Fwd time: 0.0383116 | Bck time: 0.0538829
2025-05-23 02:51:40,365 - root - INFO - Step: 450 | Loss: 11.02 | Tokens per second: 1848.59 | Training tokens per second (%): 100.00 | MFU (%): 2.30 | TFLOPs: 22.70 | Fwd time: 0.0385880 | Bck time: 0.0521590
2025-05-23 02:51:41,052 - root - INFO - Step: 455 | Loss: 10.58 | Tokens per second: 1870.11 | Training tokens per second (%): 100.00 | MFU (%): 2.32 | TFLOPs: 22.97 | Fwd time: 0.0358232 | Bck time: 0.0527995
2025-05-23 02:51:41,732 - root - INFO - Step: 460 | Loss: 10.91 | Tokens per second: 1889.45 | Training tokens per second (%): 100.00 | MFU (%): 2.35 | TFLOPs: 23.21 | Fwd time: 0.0367193 | Bck time: 0.0533757
2025-05-23 02:51:42,415 - root - INFO - Step: 465 | Loss: 11.04 | Tokens per second: 1881.98 | Training tokens per second (%): 100.00 | MFU (%): 2.34 | TFLOPs: 23.11 | Fwd time: 0.0361987 | Bck time: 0.0537040
2025-05-23 02:51:43,099 - root - INFO - Step: 470 | Loss: 10.92 | Tokens per second: 1881.49 | Training tokens per second (%): 100.00 | MFU (%): 2.34 | TFLOPs: 23.11 | Fwd time: 0.0364355 | Bck time: 0.0529743
2025-05-23 02:51:43,784 - root - INFO - Step: 475 | Loss: 11.22 | Tokens per second: 1875.53 | Training tokens per second (%): 100.00 | MFU (%): 2.33 | TFLOPs: 23.03 | Fwd time: 0.0364758 | Bck time: 0.0528018
2025-05-23 02:51:44,466 - root - INFO - Step: 480 | Loss: 10.36 | Tokens per second: 1884.00 | Training tokens per second (%): 90.31 | MFU (%): 2.34 | TFLOPs: 23.14 | Fwd time: 0.0364175 | Bck time: 0.0524281
2025-05-23 02:51:45,139 - root - INFO - Step: 485 | Loss: 11.29 | Tokens per second: 1911.36 | Training tokens per second (%): 95.62 | MFU (%): 2.37 | TFLOPs: 23.47 | Fwd time: 0.0361849 | Bck time: 0.0540113
2025-05-23 02:51:45,818 - root - INFO - Step: 490 | Loss: 11.20 | Tokens per second: 1891.62 | Training tokens per second (%): 93.59 | MFU (%): 2.35 | TFLOPs: 23.23 | Fwd time: 0.0367901 | Bck time: 0.0527725
2025-05-23 02:51:46,493 - root - INFO - Step: 495 | Loss: 11.30 | Tokens per second: 1906.47 | Training tokens per second (%): 100.00 | MFU (%): 2.37 | TFLOPs: 23.41 | Fwd time: 0.0348724 | Bck time: 0.0528264
2025-05-23 02:51:47,228 - root - INFO - Step: 500 | Loss: 11.28 | Tokens per second: 1747.04 | Training tokens per second (%): 100.00 | MFU (%): 2.17 | TFLOPs: 21.46 | Fwd time: 0.0363957 | Bck time: 0.0534392
2025-05-23 02:52:05,477 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 02:52:05,481 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 02:52:06,287 - root - INFO - Step: 505 | Loss: 10.86 | Tokens per second: 67.17 | Training tokens per second (%): 96.17 | MFU (%): 0.08 | TFLOPs: 0.82 | Fwd time: 0.0371412 | Bck time: 0.0511858
2025-05-23 02:52:06,972 - root - INFO - Step: 510 | Loss: 11.17 | Tokens per second: 1876.49 | Training tokens per second (%): 100.00 | MFU (%): 2.33 | TFLOPs: 23.05 | Fwd time: 0.0374022 | Bck time: 0.0528650
2025-05-23 02:52:07,659 - root - INFO - Step: 515 | Loss: 9.91 | Tokens per second: 1870.90 | Training tokens per second (%): 100.00 | MFU (%): 2.32 | TFLOPs: 22.98 | Fwd time: 0.0370792 | Bck time: 0.0527616
2025-05-23 02:52:08,342 - root - INFO - Step: 520 | Loss: 10.68 | Tokens per second: 1882.18 | Training tokens per second (%): 88.91 | MFU (%): 2.34 | TFLOPs: 23.12 | Fwd time: 0.0369609 | Bck time: 0.0517032
2025-05-23 02:52:08,991 - root - INFO - Step: 525 | Loss: 10.77 | Tokens per second: 1981.55 | Training tokens per second (%): 91.64 | MFU (%): 2.46 | TFLOPs: 24.34 | Fwd time: 0.0348171 | Bck time: 0.0487682
2025-05-23 02:52:09,638 - root - INFO - Step: 530 | Loss: 11.14 | Tokens per second: 1987.51 | Training tokens per second (%): 100.00 | MFU (%): 2.47 | TFLOPs: 24.41 | Fwd time: 0.0362696 | Bck time: 0.0487288
2025-05-23 02:52:10,346 - root - INFO - Step: 535 | Loss: 10.82 | Tokens per second: 1816.19 | Training tokens per second (%): 100.00 | MFU (%): 2.26 | TFLOPs: 22.31 | Fwd time: 0.0376149 | Bck time: 0.0522093
2025-05-23 02:52:11,051 - root - INFO - Step: 540 | Loss: 9.43 | Tokens per second: 1822.67 | Training tokens per second (%): 99.14 | MFU (%): 2.26 | TFLOPs: 22.39 | Fwd time: 0.0343631 | Bck time: 0.0537045
2025-05-23 02:52:11,747 - root - INFO - Step: 545 | Loss: 10.93 | Tokens per second: 1846.30 | Training tokens per second (%): 100.00 | MFU (%): 2.29 | TFLOPs: 22.68 | Fwd time: 0.0375150 | Bck time: 0.0532722
2025-05-23 02:52:12,433 - root - INFO - Step: 550 | Loss: 11.03 | Tokens per second: 1872.24 | Training tokens per second (%): 67.89 | MFU (%): 2.33 | TFLOPs: 22.99 | Fwd time: 0.0370394 | Bck time: 0.0528718
2025-05-23 02:52:13,121 - root - INFO - Step: 555 | Loss: 11.22 | Tokens per second: 1869.20 | Training tokens per second (%): 87.27 | MFU (%): 2.32 | TFLOPs: 22.96 | Fwd time: 0.0373449 | Bck time: 0.0525733
2025-05-23 02:52:13,811 - root - INFO - Step: 560 | Loss: 11.23 | Tokens per second: 1863.76 | Training tokens per second (%): 92.34 | MFU (%): 2.31 | TFLOPs: 22.89 | Fwd time: 0.0365170 | Bck time: 0.0531767
2025-05-23 02:52:14,499 - root - INFO - Step: 565 | Loss: 10.87 | Tokens per second: 1867.24 | Training tokens per second (%): 76.02 | MFU (%): 2.32 | TFLOPs: 22.93 | Fwd time: 0.0379272 | Bck time: 0.0530730
2025-05-23 02:52:15,185 - root - INFO - Step: 570 | Loss: 11.24 | Tokens per second: 1873.25 | Training tokens per second (%): 95.78 | MFU (%): 2.33 | TFLOPs: 23.01 | Fwd time: 0.0374890 | Bck time: 0.0529457
2025-05-23 02:52:15,850 - root - INFO - Step: 575 | Loss: 10.79 | Tokens per second: 1932.87 | Training tokens per second (%): 100.00 | MFU (%): 2.40 | TFLOPs: 23.74 | Fwd time: 0.0367975 | Bck time: 0.0513857
2025-05-23 02:52:16,530 - root - INFO - Step: 580 | Loss: 11.45 | Tokens per second: 1890.67 | Training tokens per second (%): 81.41 | MFU (%): 2.35 | TFLOPs: 23.22 | Fwd time: 0.0375210 | Bck time: 0.0521029
2025-05-23 02:52:17,219 - root - INFO - Step: 585 | Loss: 10.29 | Tokens per second: 1867.72 | Training tokens per second (%): 94.22 | MFU (%): 2.32 | TFLOPs: 22.94 | Fwd time: 0.0364679 | Bck time: 0.0525968
2025-05-23 02:52:17,906 - root - INFO - Step: 590 | Loss: 10.99 | Tokens per second: 1869.70 | Training tokens per second (%): 88.75 | MFU (%): 2.32 | TFLOPs: 22.96 | Fwd time: 0.0380446 | Bck time: 0.0528394
2025-05-23 02:52:18,592 - root - INFO - Step: 595 | Loss: 11.12 | Tokens per second: 1873.98 | Training tokens per second (%): 78.12 | MFU (%): 2.33 | TFLOPs: 23.02 | Fwd time: 0.0355544 | Bck time: 0.0538885
2025-05-23 02:52:19,283 - root - INFO - Step: 600 | Loss: 10.61 | Tokens per second: 1860.25 | Training tokens per second (%): 100.00 | MFU (%): 2.31 | TFLOPs: 22.85 | Fwd time: 0.0377372 | Bck time: 0.0524949
2025-05-23 02:52:37,210 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 02:52:37,211 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 02:52:38,040 - root - INFO - Step: 605 | Loss: 11.07 | Tokens per second: 68.25 | Training tokens per second (%): 90.23 | MFU (%): 0.08 | TFLOPs: 0.84 | Fwd time: 0.0324575 | Bck time: 0.0521820
2025-05-23 02:52:38,713 - root - INFO - Step: 610 | Loss: 11.34 | Tokens per second: 1910.84 | Training tokens per second (%): 72.66 | MFU (%): 2.37 | TFLOPs: 23.47 | Fwd time: 0.0363281 | Bck time: 0.0527320
2025-05-23 02:52:39,397 - root - INFO - Step: 615 | Loss: 11.05 | Tokens per second: 1878.34 | Training tokens per second (%): 100.00 | MFU (%): 2.33 | TFLOPs: 23.07 | Fwd time: 0.0363139 | Bck time: 0.0529206
2025-05-23 02:52:40,077 - root - INFO - Step: 620 | Loss: 10.54 | Tokens per second: 1890.61 | Training tokens per second (%): 87.34 | MFU (%): 2.35 | TFLOPs: 23.22 | Fwd time: 0.0367333 | Bck time: 0.0515523
2025-05-23 02:52:40,761 - root - INFO - Step: 625 | Loss: 10.69 | Tokens per second: 1878.55 | Training tokens per second (%): 100.00 | MFU (%): 2.33 | TFLOPs: 23.07 | Fwd time: 0.0360576 | Bck time: 0.0527335
2025-05-23 02:52:41,442 - root - INFO - Step: 630 | Loss: 10.63 | Tokens per second: 1888.50 | Training tokens per second (%): 100.00 | MFU (%): 2.35 | TFLOPs: 23.19 | Fwd time: 0.0367041 | Bck time: 0.0524748
2025-05-23 02:52:42,130 - root - INFO - Step: 635 | Loss: 11.09 | Tokens per second: 1867.38 | Training tokens per second (%): 100.00 | MFU (%): 2.32 | TFLOPs: 22.93 | Fwd time: 0.0363114 | Bck time: 0.0531621
2025-05-23 02:52:42,810 - root - INFO - Step: 640 | Loss: 11.02 | Tokens per second: 1891.62 | Training tokens per second (%): 91.09 | MFU (%): 2.35 | TFLOPs: 23.23 | Fwd time: 0.0362824 | Bck time: 0.0524404
2025-05-23 02:52:43,487 - root - INFO - Step: 645 | Loss: 10.81 | Tokens per second: 1897.64 | Training tokens per second (%): 97.03 | MFU (%): 2.36 | TFLOPs: 23.31 | Fwd time: 0.0369379 | Bck time: 0.0530011
2025-05-23 02:52:44,177 - root - INFO - Step: 650 | Loss: 10.57 | Tokens per second: 1864.67 | Training tokens per second (%): 100.00 | MFU (%): 2.32 | TFLOPs: 22.90 | Fwd time: 0.0341494 | Bck time: 0.0531648
2025-05-23 02:52:44,869 - root - INFO - Step: 655 | Loss: 10.80 | Tokens per second: 1857.78 | Training tokens per second (%): 95.00 | MFU (%): 2.31 | TFLOPs: 22.82 | Fwd time: 0.0360251 | Bck time: 0.0522937
2025-05-23 02:52:45,552 - root - INFO - Step: 660 | Loss: 10.60 | Tokens per second: 1881.91 | Training tokens per second (%): 93.28 | MFU (%): 2.34 | TFLOPs: 23.11 | Fwd time: 0.0377876 | Bck time: 0.0521412
2025-05-23 02:52:46,249 - root - INFO - Step: 665 | Loss: 10.98 | Tokens per second: 1843.73 | Training tokens per second (%): 94.61 | MFU (%): 2.29 | TFLOPs: 22.64 | Fwd time: 0.0369093 | Bck time: 0.0534698
2025-05-23 02:52:46,936 - root - INFO - Step: 670 | Loss: 10.35 | Tokens per second: 1871.21 | Training tokens per second (%): 100.00 | MFU (%): 2.32 | TFLOPs: 22.98 | Fwd time: 0.0373531 | Bck time: 0.0525285
2025-05-23 02:52:47,618 - root - INFO - Step: 675 | Loss: 10.30 | Tokens per second: 1883.65 | Training tokens per second (%): 86.95 | MFU (%): 2.34 | TFLOPs: 23.13 | Fwd time: 0.0372528 | Bck time: 0.0523252
2025-05-23 02:52:48,300 - root - INFO - Step: 680 | Loss: 10.69 | Tokens per second: 1886.13 | Training tokens per second (%): 90.23 | MFU (%): 2.34 | TFLOPs: 23.16 | Fwd time: 0.0374590 | Bck time: 0.0528686
2025-05-23 02:52:48,983 - root - INFO - Step: 685 | Loss: 10.95 | Tokens per second: 1882.38 | Training tokens per second (%): 94.22 | MFU (%): 2.34 | TFLOPs: 23.12 | Fwd time: 0.0373175 | Bck time: 0.0527087
2025-05-23 02:52:49,669 - root - INFO - Step: 690 | Loss: 10.45 | Tokens per second: 1873.49 | Training tokens per second (%): 92.73 | MFU (%): 2.33 | TFLOPs: 23.01 | Fwd time: 0.0371081 | Bck time: 0.0527560
2025-05-23 02:52:50,374 - root - INFO - Step: 695 | Loss: 10.58 | Tokens per second: 1821.19 | Training tokens per second (%): 97.89 | MFU (%): 2.26 | TFLOPs: 22.37 | Fwd time: 0.0347629 | Bck time: 0.0521976
2025-05-23 02:52:51,059 - root - INFO - Step: 700 | Loss: 10.53 | Tokens per second: 1878.49 | Training tokens per second (%): 97.42 | MFU (%): 2.33 | TFLOPs: 23.07 | Fwd time: 0.0372249 | Bck time: 0.0527259
2025-05-23 02:53:06,028 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 02:53:06,031 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 02:53:06,733 - root - INFO - Step: 705 | Loss: 11.19 | Tokens per second: 81.68 | Training tokens per second (%): 100.00 | MFU (%): 0.10 | TFLOPs: 1.00 | Fwd time: 0.0368690 | Bck time: 0.0512259
2025-05-23 02:53:07,420 - root - INFO - Step: 710 | Loss: 10.94 | Tokens per second: 1872.49 | Training tokens per second (%): 100.00 | MFU (%): 2.33 | TFLOPs: 23.00 | Fwd time: 0.0375660 | Bck time: 0.0523311
2025-05-23 02:53:08,099 - root - INFO - Step: 715 | Loss: 10.70 | Tokens per second: 1891.21 | Training tokens per second (%): 89.22 | MFU (%): 2.35 | TFLOPs: 23.23 | Fwd time: 0.0362521 | Bck time: 0.0520343
2025-05-23 02:53:08,779 - root - INFO - Step: 720 | Loss: 9.28 | Tokens per second: 1891.34 | Training tokens per second (%): 91.64 | MFU (%): 2.35 | TFLOPs: 23.23 | Fwd time: 0.0364227 | Bck time: 0.0522202
2025-05-23 02:53:09,457 - root - INFO - Step: 725 | Loss: 10.63 | Tokens per second: 1895.53 | Training tokens per second (%): 90.31 | MFU (%): 2.35 | TFLOPs: 23.28 | Fwd time: 0.0355196 | Bck time: 0.0523398
2025-05-23 02:53:10,141 - root - INFO - Step: 730 | Loss: 10.65 | Tokens per second: 1880.53 | Training tokens per second (%): 93.44 | MFU (%): 2.34 | TFLOPs: 23.10 | Fwd time: 0.0368772 | Bck time: 0.0525291
2025-05-23 02:53:10,821 - root - INFO - Step: 735 | Loss: 10.67 | Tokens per second: 1890.60 | Training tokens per second (%): 78.20 | MFU (%): 2.35 | TFLOPs: 23.22 | Fwd time: 0.0366702 | Bck time: 0.0525970
2025-05-23 02:53:11,501 - root - INFO - Step: 740 | Loss: 10.98 | Tokens per second: 1889.40 | Training tokens per second (%): 99.92 | MFU (%): 2.35 | TFLOPs: 23.21 | Fwd time: 0.0325616 | Bck time: 0.0529467
2025-05-23 02:53:12,171 - root - INFO - Step: 745 | Loss: 10.82 | Tokens per second: 1920.07 | Training tokens per second (%): 78.75 | MFU (%): 2.38 | TFLOPs: 23.58 | Fwd time: 0.0352925 | Bck time: 0.0522653
2025-05-23 02:53:12,835 - root - INFO - Step: 750 | Loss: 11.15 | Tokens per second: 1934.54 | Training tokens per second (%): 100.00 | MFU (%): 2.40 | TFLOPs: 23.76 | Fwd time: 0.0367494 | Bck time: 0.0510427
2025-05-23 02:53:13,502 - root - INFO - Step: 755 | Loss: 10.92 | Tokens per second: 1928.82 | Training tokens per second (%): 100.00 | MFU (%): 2.40 | TFLOPs: 23.69 | Fwd time: 0.0364424 | Bck time: 0.0518434
2025-05-23 02:53:14,181 - root - INFO - Step: 760 | Loss: 11.14 | Tokens per second: 1892.10 | Training tokens per second (%): 100.00 | MFU (%): 2.35 | TFLOPs: 23.24 | Fwd time: 0.0371254 | Bck time: 0.0521390
2025-05-23 02:53:14,862 - root - INFO - Step: 765 | Loss: 10.66 | Tokens per second: 1887.75 | Training tokens per second (%): 100.00 | MFU (%): 2.34 | TFLOPs: 23.18 | Fwd time: 0.0334509 | Bck time: 0.0516412
2025-05-23 02:53:15,534 - root - INFO - Step: 770 | Loss: 10.30 | Tokens per second: 1913.14 | Training tokens per second (%): 100.00 | MFU (%): 2.38 | TFLOPs: 23.50 | Fwd time: 0.0364434 | Bck time: 0.0522227
2025-05-23 02:53:16,214 - root - INFO - Step: 775 | Loss: 10.62 | Tokens per second: 1891.04 | Training tokens per second (%): 90.39 | MFU (%): 2.35 | TFLOPs: 23.23 | Fwd time: 0.0338796 | Bck time: 0.0523433
2025-05-23 02:53:16,880 - root - INFO - Step: 780 | Loss: 11.16 | Tokens per second: 1928.58 | Training tokens per second (%): 99.45 | MFU (%): 2.39 | TFLOPs: 23.69 | Fwd time: 0.0374927 | Bck time: 0.0490907
2025-05-23 02:53:17,550 - root - INFO - Step: 785 | Loss: 10.51 | Tokens per second: 1920.37 | Training tokens per second (%): 100.00 | MFU (%): 2.38 | TFLOPs: 23.59 | Fwd time: 0.0365381 | Bck time: 0.0516586
2025-05-23 02:53:18,228 - root - INFO - Step: 790 | Loss: 10.74 | Tokens per second: 1896.11 | Training tokens per second (%): 100.00 | MFU (%): 2.35 | TFLOPs: 23.29 | Fwd time: 0.0366946 | Bck time: 0.0516063
2025-05-23 02:53:18,912 - root - INFO - Step: 795 | Loss: 9.85 | Tokens per second: 1877.83 | Training tokens per second (%): 100.00 | MFU (%): 2.33 | TFLOPs: 23.06 | Fwd time: 0.0362814 | Bck time: 0.0514132
2025-05-23 02:53:19,580 - root - INFO - Step: 800 | Loss: 10.65 | Tokens per second: 1923.38 | Training tokens per second (%): 89.14 | MFU (%): 2.39 | TFLOPs: 23.62 | Fwd time: 0.0359530 | Bck time: 0.0520875
2025-05-23 02:53:38,035 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 02:53:38,037 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 02:53:39,785 - root - INFO - Step: 805 | Loss: 10.49 | Tokens per second: 63.36 | Training tokens per second (%): 98.98 | MFU (%): 0.08 | TFLOPs: 0.78 | Fwd time: 0.0355494 | Bck time: 0.0513293
2025-05-23 02:53:40,459 - root - INFO - Step: 810 | Loss: 10.86 | Tokens per second: 1909.71 | Training tokens per second (%): 91.17 | MFU (%): 2.37 | TFLOPs: 23.45 | Fwd time: 0.0368799 | Bck time: 0.0521012
2025-05-23 02:53:41,134 - root - INFO - Step: 815 | Loss: 11.01 | Tokens per second: 1903.50 | Training tokens per second (%): 96.72 | MFU (%): 2.36 | TFLOPs: 23.38 | Fwd time: 0.0357077 | Bck time: 0.0526017
2025-05-23 02:53:41,800 - root - INFO - Step: 820 | Loss: 10.68 | Tokens per second: 1930.44 | Training tokens per second (%): 90.00 | MFU (%): 2.40 | TFLOPs: 23.71 | Fwd time: 0.0360364 | Bck time: 0.0517827
2025-05-23 02:53:42,475 - root - INFO - Step: 825 | Loss: 10.69 | Tokens per second: 1902.82 | Training tokens per second (%): 100.00 | MFU (%): 2.36 | TFLOPs: 23.37 | Fwd time: 0.0356607 | Bck time: 0.0516014
2025-05-23 02:53:43,147 - root - INFO - Step: 830 | Loss: 10.73 | Tokens per second: 1915.17 | Training tokens per second (%): 92.11 | MFU (%): 2.38 | TFLOPs: 23.52 | Fwd time: 0.0358609 | Bck time: 0.0516225
2025-05-23 02:53:43,817 - root - INFO - Step: 835 | Loss: 10.68 | Tokens per second: 1918.38 | Training tokens per second (%): 98.59 | MFU (%): 2.38 | TFLOPs: 23.56 | Fwd time: 0.0359153 | Bck time: 0.0520244
2025-05-23 02:53:44,487 - root - INFO - Step: 840 | Loss: 10.63 | Tokens per second: 1919.09 | Training tokens per second (%): 89.61 | MFU (%): 2.38 | TFLOPs: 23.57 | Fwd time: 0.0360007 | Bck time: 0.0521780
2025-05-23 02:53:45,148 - root - INFO - Step: 845 | Loss: 10.53 | Tokens per second: 1942.90 | Training tokens per second (%): 100.00 | MFU (%): 2.41 | TFLOPs: 23.86 | Fwd time: 0.0355869 | Bck time: 0.0515871
2025-05-23 02:53:45,815 - root - INFO - Step: 850 | Loss: 9.97 | Tokens per second: 1929.08 | Training tokens per second (%): 95.47 | MFU (%): 2.40 | TFLOPs: 23.69 | Fwd time: 0.0361823 | Bck time: 0.0519184
2025-05-23 02:53:46,488 - root - INFO - Step: 855 | Loss: 10.61 | Tokens per second: 1909.20 | Training tokens per second (%): 100.00 | MFU (%): 2.37 | TFLOPs: 23.45 | Fwd time: 0.0358139 | Bck time: 0.0512698
2025-05-23 02:53:47,150 - root - INFO - Step: 860 | Loss: 10.86 | Tokens per second: 1942.21 | Training tokens per second (%): 82.66 | MFU (%): 2.41 | TFLOPs: 23.85 | Fwd time: 0.0350461 | Bck time: 0.0516075
2025-05-23 02:53:47,820 - root - INFO - Step: 865 | Loss: 9.81 | Tokens per second: 1918.39 | Training tokens per second (%): 99.38 | MFU (%): 2.38 | TFLOPs: 23.56 | Fwd time: 0.0361121 | Bck time: 0.0520571
2025-05-23 02:53:48,493 - root - INFO - Step: 870 | Loss: 10.19 | Tokens per second: 1910.85 | Training tokens per second (%): 100.00 | MFU (%): 2.37 | TFLOPs: 23.47 | Fwd time: 0.0362595 | Bck time: 0.0523370
2025-05-23 02:53:49,162 - root - INFO - Step: 875 | Loss: 10.15 | Tokens per second: 1920.31 | Training tokens per second (%): 90.55 | MFU (%): 2.38 | TFLOPs: 23.58 | Fwd time: 0.0360638 | Bck time: 0.0522204
2025-05-23 02:53:49,836 - root - INFO - Step: 880 | Loss: 11.08 | Tokens per second: 1907.44 | Training tokens per second (%): 100.00 | MFU (%): 2.37 | TFLOPs: 23.43 | Fwd time: 0.0358323 | Bck time: 0.0525628
2025-05-23 02:53:50,514 - root - INFO - Step: 885 | Loss: 9.74 | Tokens per second: 1896.34 | Training tokens per second (%): 96.41 | MFU (%): 2.35 | TFLOPs: 23.29 | Fwd time: 0.0361803 | Bck time: 0.0515992
2025-05-23 02:53:51,190 - root - INFO - Step: 890 | Loss: 10.80 | Tokens per second: 1901.70 | Training tokens per second (%): 100.00 | MFU (%): 2.36 | TFLOPs: 23.36 | Fwd time: 0.0364965 | Bck time: 0.0523602
2025-05-23 02:53:51,860 - root - INFO - Step: 895 | Loss: 10.89 | Tokens per second: 1917.77 | Training tokens per second (%): 97.11 | MFU (%): 2.38 | TFLOPs: 23.55 | Fwd time: 0.0358567 | Bck time: 0.0521817
2025-05-23 02:53:52,535 - root - INFO - Step: 900 | Loss: 10.58 | Tokens per second: 1906.83 | Training tokens per second (%): 90.39 | MFU (%): 2.37 | TFLOPs: 23.42 | Fwd time: 0.0356531 | Bck time: 0.0523608
2025-05-23 02:54:10,228 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 02:54:10,252 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 02:54:11,114 - root - INFO - Step: 905 | Loss: 10.71 | Tokens per second: 68.90 | Training tokens per second (%): 89.92 | MFU (%): 0.09 | TFLOPs: 0.85 | Fwd time: 0.0370858 | Bck time: 0.0536286
2025-05-23 02:54:11,798 - root - INFO - Step: 910 | Loss: 9.69 | Tokens per second: 1878.53 | Training tokens per second (%): 100.00 | MFU (%): 2.33 | TFLOPs: 23.07 | Fwd time: 0.0365754 | Bck time: 0.0532868
2025-05-23 02:54:12,475 - root - INFO - Step: 915 | Loss: 10.41 | Tokens per second: 1898.40 | Training tokens per second (%): 95.70 | MFU (%): 2.36 | TFLOPs: 23.32 | Fwd time: 0.0355499 | Bck time: 0.0528620
2025-05-23 02:54:13,152 - root - INFO - Step: 920 | Loss: 10.51 | Tokens per second: 1900.45 | Training tokens per second (%): 100.00 | MFU (%): 2.36 | TFLOPs: 23.34 | Fwd time: 0.0362598 | Bck time: 0.0523155
2025-05-23 02:54:13,825 - root - INFO - Step: 925 | Loss: 10.33 | Tokens per second: 1909.79 | Training tokens per second (%): 86.56 | MFU (%): 2.37 | TFLOPs: 23.46 | Fwd time: 0.0350729 | Bck time: 0.0527414
2025-05-23 02:54:14,507 - root - INFO - Step: 930 | Loss: 10.54 | Tokens per second: 1884.10 | Training tokens per second (%): 89.38 | MFU (%): 2.34 | TFLOPs: 23.14 | Fwd time: 0.0376132 | Bck time: 0.0531643
2025-05-23 02:54:15,198 - root - INFO - Step: 935 | Loss: 10.56 | Tokens per second: 1861.97 | Training tokens per second (%): 100.00 | MFU (%): 2.31 | TFLOPs: 22.87 | Fwd time: 0.0372708 | Bck time: 0.0527136
2025-05-23 02:54:15,882 - root - INFO - Step: 940 | Loss: 8.84 | Tokens per second: 1879.66 | Training tokens per second (%): 100.00 | MFU (%): 2.33 | TFLOPs: 23.09 | Fwd time: 0.0360160 | Bck time: 0.0518470
2025-05-23 02:54:16,565 - root - INFO - Step: 945 | Loss: 10.28 | Tokens per second: 1881.62 | Training tokens per second (%): 100.00 | MFU (%): 2.34 | TFLOPs: 23.11 | Fwd time: 0.0355004 | Bck time: 0.0533086
2025-05-23 02:54:17,254 - root - INFO - Step: 950 | Loss: 10.18 | Tokens per second: 1864.11 | Training tokens per second (%): 87.50 | MFU (%): 2.31 | TFLOPs: 22.89 | Fwd time: 0.0352750 | Bck time: 0.0526334
2025-05-23 02:54:17,934 - root - INFO - Step: 955 | Loss: 10.13 | Tokens per second: 1891.60 | Training tokens per second (%): 92.42 | MFU (%): 2.35 | TFLOPs: 23.23 | Fwd time: 0.0370909 | Bck time: 0.0530772
2025-05-23 02:54:18,623 - root - INFO - Step: 960 | Loss: 10.91 | Tokens per second: 1864.79 | Training tokens per second (%): 93.05 | MFU (%): 2.32 | TFLOPs: 22.90 | Fwd time: 0.0372620 | Bck time: 0.0527890
2025-05-23 02:54:19,309 - root - INFO - Step: 965 | Loss: 10.49 | Tokens per second: 1872.50 | Training tokens per second (%): 92.97 | MFU (%): 2.33 | TFLOPs: 23.00 | Fwd time: 0.0376219 | Bck time: 0.0530228
2025-05-23 02:54:20,000 - root - INFO - Step: 970 | Loss: 10.35 | Tokens per second: 1860.11 | Training tokens per second (%): 96.33 | MFU (%): 2.31 | TFLOPs: 22.85 | Fwd time: 0.0368727 | Bck time: 0.0532588
2025-05-23 02:54:20,687 - root - INFO - Step: 975 | Loss: 9.82 | Tokens per second: 1872.60 | Training tokens per second (%): 92.97 | MFU (%): 2.33 | TFLOPs: 23.00 | Fwd time: 0.0372873 | Bck time: 0.0523436
2025-05-23 02:54:21,383 - root - INFO - Step: 980 | Loss: 10.49 | Tokens per second: 1845.15 | Training tokens per second (%): 100.00 | MFU (%): 2.29 | TFLOPs: 22.66 | Fwd time: 0.0371330 | Bck time: 0.0518546
2025-05-23 02:54:22,071 - root - INFO - Step: 985 | Loss: 10.07 | Tokens per second: 1868.90 | Training tokens per second (%): 100.00 | MFU (%): 2.32 | TFLOPs: 22.95 | Fwd time: 0.0365785 | Bck time: 0.0526838
2025-05-23 02:54:22,761 - root - INFO - Step: 990 | Loss: 10.50 | Tokens per second: 1863.22 | Training tokens per second (%): 96.09 | MFU (%): 2.31 | TFLOPs: 22.88 | Fwd time: 0.0367957 | Bck time: 0.0536700
2025-05-23 02:54:23,469 - root - INFO - Step: 995 | Loss: 10.42 | Tokens per second: 1815.61 | Training tokens per second (%): 93.20 | MFU (%): 2.25 | TFLOPs: 22.30 | Fwd time: 0.0374355 | Bck time: 0.0530055
2025-05-23 02:54:24,161 - root - INFO - Step: 1000 | Loss: 10.16 | Tokens per second: 1857.21 | Training tokens per second (%): 100.00 | MFU (%): 2.31 | TFLOPs: 22.81 | Fwd time: 0.0375212 | Bck time: 0.0529852
2025-05-23 02:54:40,744 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 02:54:40,757 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
total_size: 6845503780, bsize: 6845503780, ratio: 2.0
6845503780 2 False
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 339.31565284729004 ms
CPU copy took 16796.20599746704 ms
---------------------- [PERF] Single Checkpoint time is 17.16129469871521 sec, average is 17.16128945350647
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 319.1559314727783 ms
CPU copy took 16481.194972991943 ms
---------------------- [PERF] Single Checkpoint time is 16.820976495742798 sec, average is 16.99113094806671
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 320.79029083251953 ms
CPU copy took 12797.354936599731 ms
---------------------- [PERF] Single Checkpoint time is 13.143829822540283 sec, average is 16.820972442626953
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 318.4375762939453 ms
CPU copy took 16314.04447555542 ms
---------------------- [PERF] Single Checkpoint time is 16.653109312057495 sec, average is 16.73703896999359
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 316.9248104095459 ms
CPU copy took 18236.780643463135 ms
---------------------- [PERF] Single Checkpoint time is 18.574255228042603 sec, average is 16.820972442626953
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 316.7383670806885 ms
CPU copy took 18692.023277282715 ms
---------------------- [PERF] Single Checkpoint time is 19.014267683029175 sec, average is 16.99113094806671
---- exit
PR_ADDR_DATA is 0x4014c0410000, PR_ADDR is 0x4014c0190000, PEER_CHECK_ADDR is 0x4014c0210000
--------------- init enqueue: 0
--------------- init enqueue: 1
Call dram.alloc, num_batches is 2, batch_size_floats is 6845503780
------------------------- is_distributed is 0, rank is 0
Parall_iter 0, Write new metadata at address 0x4014c0310000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 60, parall_iter is 0, num_threads is 1, last counter is 0, curr_counter is 1
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x4014c0410000, curr_pr_arr is 0x4014c0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x4014c0410000!
Thread ID: 1, savenvm_thread_nd took 16720.986802 ms
Thread ID: 1, set_cpu took 0.096028 ms
Threads took 16721.315078 ms
MSYNC 27382015120 TOOK 65.027501 ms
CAS was successful! new counter is 1, is_distributed is 0
******** checkp_info saved in 0x4014c0310000, curr_checkpoint is 0x4014c0310000
0, 1
Parall_iter 1, Write new metadata at address 0x4014c0390000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 124, parall_iter is 1, num_threads is 1, last counter is 1, curr_counter is 2
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401b205a0000, curr_pr_arr is 0x401b205a0000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401b205a0000!
Thread ID: 2, savenvm_thread_nd took 16454.637070 ms
Thread ID: 2, set_cpu took 0.091869 ms
Threads took 16454.894181 ms
MSYNC 27382015120 TOOK 19.846380 ms
CAS was successful! new counter is 2, is_distributed is 0
******** checkp_info saved in 0x4014c0390000, curr_checkpoint is 0x4014c0390000
1, 2
Parall_iter 0, Write new metadata at address 0x4014c0310000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 79, parall_iter is 0, num_threads is 1, last counter is 2, curr_counter is 3
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x4014c0410000, curr_pr_arr is 0x4014c0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x4014c0410000!
Thread ID: 1, savenvm_thread_nd took 11849.564843 ms
Thread ID: 1, set_cpu took 0.087198 ms
Threads took 11849.814211 ms
MSYNC 27382015120 TOOK 940.721469 ms
CAS was successful! new counter is 3, is_distributed is 0
******** checkp_info saved in 0x4014c0310000, curr_checkpoint is 0x4014c0310000
0, 3
Parall_iter 1, Write new metadata at address 0x4014c0390000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 14, parall_iter is 1, num_threads is 1, last counter is 3, curr_counter is 4
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401b205a0000, curr_pr_arr is 0x401b205a0000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401b205a0000!
Thread ID: 2, savenvm_thread_nd took 16248.876629 ms
Thread ID: 2, set_cpu took 0.086685 ms
Threads took 16249.146540 ms
MSYNC 27382015120 TOOK 58.913896 ms
CAS was successful! new counter is 4, is_distributed is 0
******** checkp_info saved in 0x4014c0390000, curr_checkpoint is 0x4014c0390000
1, 4
Parall_iter 0, Write new metadata at address 0x4014c0310000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 105, parall_iter is 0, num_threads is 1, last counter is 4, curr_counter is 5
Writing offset is 39792, parall_iter_offset is 0
start_pr_arr is 0x4014c0410000, curr_pr_arr is 0x4014c0410000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 6845503780, start addr is 0x4014c0410000!
Thread ID: 1, savenvm_thread_nd took 18162.613660 ms
Thread ID: 1, set_cpu took 0.098461 ms
Threads took 18163.011055 ms
MSYNC 27382015120 TOOK 65.696522 ms
CAS was successful! new counter is 5, is_distributed is 0
******** checkp_info saved in 0x4014c0310000, curr_checkpoint is 0x4014c0310000
0, 5
Parall_iter 1, Write new metadata at address 0x4014c0390000
------------------------- savenvmNew, is_distributed is 0, total_size is 6845503780
At savenvmNew, tid is 70, parall_iter is 1, num_threads is 1, last counter is 5, curr_counter is 6
Writing offset is 39792, parall_iter_offset is 6845513728
start_pr_arr is 0x401b205a0000, curr_pr_arr is 0x401b205a0000, batch_size is 6845503780, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 6845503780
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 6845503780, start addr is 0x401b205a0000!
Thread ID: 2, savenvm_thread_nd took 18644.650758 ms
Thread ID: 2, set_cpu took 0.099485 ms
Threads took 18644.911326 ms
MSYNC 27382015120 TOOK 45.682302 ms
CAS was successful! new counter is 6, is_distributed is 0
******** checkp_info saved in 0x4014c0390000, curr_checkpoint is 0x4014c0390000
1, 6
2025-05-23 02:54:52,285 - root - INFO - Training completed
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
0, 3, 0
1, 4, 3
max_piter is 1
Writing offset is 39792, parall_iter_offset is 6845513728
data_offset is 27384676352
