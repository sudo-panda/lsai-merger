2025-05-23 01:28:55,667 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=512, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=1000, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, seed=4, checkpoint_dir='/iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts', loss_file='/iopsstor/scratch/cscs/bkundu/lsai-merger/results/bf16/loss-pccheck-torch-512-part2.csv', checkpoint_freq=100, max_async=1, warmup=3, load_checkpoint=True, non_blocking=False)
2025-05-23 01:28:55,672 - root - INFO - Random state checkpoint loaded from /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:28:55,672 - root - INFO - Training will resume from step: 400
2025-05-23 01:28:55,672 - root - INFO - Setting up DataLoaders...
2025-05-23 01:28:56,401 - root - INFO - Setting up Model...
2025-05-23 01:29:02,077 - root - INFO - Loading checkpoint model, optimizer + scheduler
/iopsstor/scratch/cscs/bkundu/lsai-merger/LSAI-Checkpointing/training/utils.py:85: UserWarning: The given buffer is not writable, and PyTorch does not support non-writable tensors. This means you can write to the underlying (supposedly non-writable) buffer using the tensor. You may want to copy the buffer to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at /opt/pytorch/pytorch/torch/csrc/utils/tensor_new.cpp:1561.)
  data = torch.frombuffer(payload, dtype=torch.float32)
2025-05-23 01:29:03,472 - root - INFO - Checkpoint loaded from /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/checkpoint_pccheck.pt
2025-05-23 01:29:03,481 - root - INFO - Loaded optimizer, scheduler checkpoint at step 400 in 1.40 seconds
Model size: 255885824, Optimizer size: 511771940, Total size: 767657764
BSIZE IS 767657764
At checkpoint, bsize is 767657764
2025-05-23 01:29:09,190 - root - INFO - Checkpointing warmup done
2025-05-23 01:29:09,194 - root - INFO - ------------------------------------------------------------Starting training!
2025-05-23 01:29:10,017 - root - INFO - Step: 405 | Loss: 11.32 | Tokens per second: 3111.31 | Training tokens per second (%): 76.80 | MFU (%): 0.39 | TFLOPs: 3.84 | Fwd time: 0.0324060 | Bck time: 0.0433658
2025-05-23 01:29:10,586 - root - INFO - Step: 410 | Loss: 11.21 | Tokens per second: 4506.79 | Training tokens per second (%): 94.88 | MFU (%): 0.56 | TFLOPs: 5.56 | Fwd time: 0.0316458 | Bck time: 0.0445490
2025-05-23 01:29:11,165 - root - INFO - Step: 415 | Loss: 11.17 | Tokens per second: 4424.41 | Training tokens per second (%): 86.99 | MFU (%): 0.55 | TFLOPs: 5.46 | Fwd time: 0.0323992 | Bck time: 0.0452730
2025-05-23 01:29:11,735 - root - INFO - Step: 420 | Loss: 11.31 | Tokens per second: 4498.32 | Training tokens per second (%): 72.15 | MFU (%): 0.56 | TFLOPs: 5.55 | Fwd time: 0.0316558 | Bck time: 0.0455363
2025-05-23 01:29:12,304 - root - INFO - Step: 425 | Loss: 11.22 | Tokens per second: 4504.71 | Training tokens per second (%): 69.69 | MFU (%): 0.56 | TFLOPs: 5.56 | Fwd time: 0.0318123 | Bck time: 0.0450647
2025-05-23 01:29:12,876 - root - INFO - Step: 430 | Loss: 11.30 | Tokens per second: 4484.97 | Training tokens per second (%): 95.20 | MFU (%): 0.56 | TFLOPs: 5.53 | Fwd time: 0.0312259 | Bck time: 0.0452177
2025-05-23 01:29:13,483 - root - INFO - Step: 435 | Loss: 11.13 | Tokens per second: 4221.54 | Training tokens per second (%): 98.67 | MFU (%): 0.53 | TFLOPs: 5.21 | Fwd time: 0.0322253 | Bck time: 0.0454361
2025-05-23 01:29:14,092 - root - INFO - Step: 440 | Loss: 11.20 | Tokens per second: 4208.75 | Training tokens per second (%): 83.01 | MFU (%): 0.52 | TFLOPs: 5.19 | Fwd time: 0.0402789 | Bck time: 0.0453298
2025-05-23 01:29:14,680 - root - INFO - Step: 445 | Loss: 11.25 | Tokens per second: 4354.10 | Training tokens per second (%): 79.30 | MFU (%): 0.54 | TFLOPs: 5.37 | Fwd time: 0.0318931 | Bck time: 0.0455090
2025-05-23 01:29:15,256 - root - INFO - Step: 450 | Loss: 11.15 | Tokens per second: 4455.45 | Training tokens per second (%): 92.34 | MFU (%): 0.56 | TFLOPs: 5.50 | Fwd time: 0.0320325 | Bck time: 0.0453147
2025-05-23 01:29:15,879 - root - INFO - Step: 455 | Loss: 11.08 | Tokens per second: 4111.56 | Training tokens per second (%): 92.58 | MFU (%): 0.51 | TFLOPs: 5.07 | Fwd time: 0.0323885 | Bck time: 0.0447105
2025-05-23 01:29:16,452 - root - INFO - Step: 460 | Loss: 11.19 | Tokens per second: 4477.95 | Training tokens per second (%): 93.32 | MFU (%): 0.56 | TFLOPs: 5.52 | Fwd time: 0.0318388 | Bck time: 0.0441762
2025-05-23 01:29:17,055 - root - INFO - Step: 465 | Loss: 11.07 | Tokens per second: 4250.06 | Training tokens per second (%): 90.66 | MFU (%): 0.53 | TFLOPs: 5.24 | Fwd time: 0.0343731 | Bck time: 0.0458935
2025-05-23 01:29:17,634 - root - INFO - Step: 470 | Loss: 10.94 | Tokens per second: 4428.25 | Training tokens per second (%): 85.86 | MFU (%): 0.55 | TFLOPs: 5.46 | Fwd time: 0.0326283 | Bck time: 0.0439934
2025-05-23 01:29:18,209 - root - INFO - Step: 475 | Loss: 11.22 | Tokens per second: 4457.43 | Training tokens per second (%): 92.62 | MFU (%): 0.56 | TFLOPs: 5.50 | Fwd time: 0.0323315 | Bck time: 0.0443124
2025-05-23 01:29:18,786 - root - INFO - Step: 480 | Loss: 11.22 | Tokens per second: 4440.48 | Training tokens per second (%): 85.16 | MFU (%): 0.55 | TFLOPs: 5.48 | Fwd time: 0.0315790 | Bck time: 0.0448535
2025-05-23 01:29:19,357 - root - INFO - Step: 485 | Loss: 11.23 | Tokens per second: 4488.39 | Training tokens per second (%): 83.36 | MFU (%): 0.56 | TFLOPs: 5.54 | Fwd time: 0.0324911 | Bck time: 0.0449831
2025-05-23 01:29:19,926 - root - INFO - Step: 490 | Loss: 11.20 | Tokens per second: 4501.99 | Training tokens per second (%): 84.41 | MFU (%): 0.56 | TFLOPs: 5.55 | Fwd time: 0.0314822 | Bck time: 0.0446538
2025-05-23 01:29:20,510 - root - INFO - Step: 495 | Loss: 11.27 | Tokens per second: 4391.83 | Training tokens per second (%): 73.91 | MFU (%): 0.55 | TFLOPs: 5.42 | Fwd time: 0.0323735 | Bck time: 0.0447945
2025-05-23 01:29:21,089 - root - INFO - Step: 500 | Loss: 11.32 | Tokens per second: 4428.60 | Training tokens per second (%): 100.00 | MFU (%): 0.55 | TFLOPs: 5.46 | Fwd time: 0.0325243 | Bck time: 0.0449751
2025-05-23 01:29:22,069 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:29:22,071 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 01:29:22,695 - root - INFO - Step: 505 | Loss: 11.14 | Tokens per second: 1594.97 | Training tokens per second (%): 85.62 | MFU (%): 0.20 | TFLOPs: 1.97 | Fwd time: 0.0326550 | Bck time: 0.0464429
2025-05-23 01:29:23,278 - root - INFO - Step: 510 | Loss: 11.20 | Tokens per second: 4392.50 | Training tokens per second (%): 79.53 | MFU (%): 0.55 | TFLOPs: 5.42 | Fwd time: 0.0325047 | Bck time: 0.0446876
2025-05-23 01:29:23,848 - root - INFO - Step: 515 | Loss: 10.83 | Tokens per second: 4500.80 | Training tokens per second (%): 81.95 | MFU (%): 0.56 | TFLOPs: 5.55 | Fwd time: 0.0321573 | Bck time: 0.0439364
2025-05-23 01:29:24,419 - root - INFO - Step: 520 | Loss: 11.17 | Tokens per second: 4484.44 | Training tokens per second (%): 84.45 | MFU (%): 0.56 | TFLOPs: 5.53 | Fwd time: 0.0318012 | Bck time: 0.0446296
2025-05-23 01:29:24,994 - root - INFO - Step: 525 | Loss: 10.97 | Tokens per second: 4463.09 | Training tokens per second (%): 75.82 | MFU (%): 0.56 | TFLOPs: 5.50 | Fwd time: 0.0318618 | Bck time: 0.0444171
2025-05-23 01:29:25,567 - root - INFO - Step: 530 | Loss: 11.08 | Tokens per second: 4473.39 | Training tokens per second (%): 95.04 | MFU (%): 0.56 | TFLOPs: 5.52 | Fwd time: 0.0324147 | Bck time: 0.0444247
2025-05-23 01:29:26,156 - root - INFO - Step: 535 | Loss: 11.19 | Tokens per second: 4350.83 | Training tokens per second (%): 100.00 | MFU (%): 0.54 | TFLOPs: 5.37 | Fwd time: 0.0331860 | Bck time: 0.0445291
2025-05-23 01:29:26,742 - root - INFO - Step: 540 | Loss: 10.66 | Tokens per second: 4375.34 | Training tokens per second (%): 82.30 | MFU (%): 0.55 | TFLOPs: 5.40 | Fwd time: 0.0322822 | Bck time: 0.0436440
2025-05-23 01:29:27,321 - root - INFO - Step: 545 | Loss: 11.20 | Tokens per second: 4423.81 | Training tokens per second (%): 98.32 | MFU (%): 0.55 | TFLOPs: 5.46 | Fwd time: 0.0327889 | Bck time: 0.0443687
2025-05-23 01:29:27,892 - root - INFO - Step: 550 | Loss: 11.27 | Tokens per second: 4488.48 | Training tokens per second (%): 47.46 | MFU (%): 0.56 | TFLOPs: 5.54 | Fwd time: 0.0325782 | Bck time: 0.0447577
2025-05-23 01:29:28,466 - root - INFO - Step: 555 | Loss: 11.68 | Tokens per second: 4467.59 | Training tokens per second (%): 78.40 | MFU (%): 0.56 | TFLOPs: 5.51 | Fwd time: 0.0321113 | Bck time: 0.0439172
2025-05-23 01:29:29,041 - root - INFO - Step: 560 | Loss: 11.29 | Tokens per second: 4453.93 | Training tokens per second (%): 82.54 | MFU (%): 0.56 | TFLOPs: 5.49 | Fwd time: 0.0327774 | Bck time: 0.0453103
2025-05-23 01:29:29,614 - root - INFO - Step: 565 | Loss: 11.25 | Tokens per second: 4473.76 | Training tokens per second (%): 68.01 | MFU (%): 0.56 | TFLOPs: 5.52 | Fwd time: 0.0318269 | Bck time: 0.0450244
2025-05-23 01:29:30,186 - root - INFO - Step: 570 | Loss: 11.36 | Tokens per second: 4481.32 | Training tokens per second (%): 68.91 | MFU (%): 0.56 | TFLOPs: 5.53 | Fwd time: 0.0325785 | Bck time: 0.0438641
2025-05-23 01:29:30,762 - root - INFO - Step: 575 | Loss: 11.13 | Tokens per second: 4451.74 | Training tokens per second (%): 91.13 | MFU (%): 0.56 | TFLOPs: 5.49 | Fwd time: 0.0325670 | Bck time: 0.0454823
2025-05-23 01:29:31,340 - root - INFO - Step: 580 | Loss: 11.04 | Tokens per second: 4432.36 | Training tokens per second (%): 56.88 | MFU (%): 0.55 | TFLOPs: 5.47 | Fwd time: 0.0325128 | Bck time: 0.0450978
2025-05-23 01:29:31,915 - root - INFO - Step: 585 | Loss: 11.08 | Tokens per second: 4463.30 | Training tokens per second (%): 70.39 | MFU (%): 0.56 | TFLOPs: 5.50 | Fwd time: 0.0328670 | Bck time: 0.0444460
2025-05-23 01:29:32,483 - root - INFO - Step: 590 | Loss: 11.08 | Tokens per second: 4511.95 | Training tokens per second (%): 84.38 | MFU (%): 0.56 | TFLOPs: 5.56 | Fwd time: 0.0329101 | Bck time: 0.0444401
2025-05-23 01:29:33,058 - root - INFO - Step: 595 | Loss: 11.08 | Tokens per second: 4456.91 | Training tokens per second (%): 65.47 | MFU (%): 0.56 | TFLOPs: 5.50 | Fwd time: 0.0329985 | Bck time: 0.0431912
2025-05-23 01:29:33,633 - root - INFO - Step: 600 | Loss: 11.08 | Tokens per second: 4458.26 | Training tokens per second (%): 80.35 | MFU (%): 0.56 | TFLOPs: 5.50 | Fwd time: 0.0330388 | Bck time: 0.0440269
2025-05-23 01:29:34,736 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:29:34,738 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 01:29:35,368 - root - INFO - Step: 605 | Loss: 11.17 | Tokens per second: 1476.41 | Training tokens per second (%): 69.22 | MFU (%): 0.18 | TFLOPs: 1.82 | Fwd time: 0.0320183 | Bck time: 0.0450930
2025-05-23 01:29:35,928 - root - INFO - Step: 610 | Loss: 11.54 | Tokens per second: 4576.22 | Training tokens per second (%): 60.90 | MFU (%): 0.57 | TFLOPs: 5.64 | Fwd time: 0.0319551 | Bck time: 0.0433608
2025-05-23 01:29:36,498 - root - INFO - Step: 615 | Loss: 11.13 | Tokens per second: 4499.16 | Training tokens per second (%): 95.23 | MFU (%): 0.56 | TFLOPs: 5.55 | Fwd time: 0.0315998 | Bck time: 0.0436522
2025-05-23 01:29:37,063 - root - INFO - Step: 620 | Loss: 10.90 | Tokens per second: 4536.28 | Training tokens per second (%): 72.07 | MFU (%): 0.57 | TFLOPs: 5.59 | Fwd time: 0.0322335 | Bck time: 0.0441683
2025-05-23 01:29:37,637 - root - INFO - Step: 625 | Loss: 11.14 | Tokens per second: 4466.92 | Training tokens per second (%): 91.09 | MFU (%): 0.56 | TFLOPs: 5.51 | Fwd time: 0.0324119 | Bck time: 0.0444080
2025-05-23 01:29:38,209 - root - INFO - Step: 630 | Loss: 11.02 | Tokens per second: 4477.70 | Training tokens per second (%): 89.22 | MFU (%): 0.56 | TFLOPs: 5.52 | Fwd time: 0.0329652 | Bck time: 0.0439528
2025-05-23 01:29:38,786 - root - INFO - Step: 635 | Loss: 11.13 | Tokens per second: 4439.34 | Training tokens per second (%): 91.45 | MFU (%): 0.55 | TFLOPs: 5.48 | Fwd time: 0.0316224 | Bck time: 0.0443220
2025-05-23 01:29:39,355 - root - INFO - Step: 640 | Loss: 11.15 | Tokens per second: 4504.73 | Training tokens per second (%): 84.26 | MFU (%): 0.56 | TFLOPs: 5.56 | Fwd time: 0.0322281 | Bck time: 0.0438198
2025-05-23 01:29:39,925 - root - INFO - Step: 645 | Loss: 11.14 | Tokens per second: 4503.77 | Training tokens per second (%): 69.41 | MFU (%): 0.56 | TFLOPs: 5.55 | Fwd time: 0.0319644 | Bck time: 0.0440528
2025-05-23 01:29:40,511 - root - INFO - Step: 650 | Loss: 10.83 | Tokens per second: 4373.21 | Training tokens per second (%): 97.15 | MFU (%): 0.55 | TFLOPs: 5.39 | Fwd time: 0.0326909 | Bck time: 0.0446715
2025-05-23 01:29:41,082 - root - INFO - Step: 655 | Loss: 11.16 | Tokens per second: 4487.48 | Training tokens per second (%): 71.37 | MFU (%): 0.56 | TFLOPs: 5.53 | Fwd time: 0.0315356 | Bck time: 0.0437699
2025-05-23 01:29:41,652 - root - INFO - Step: 660 | Loss: 11.13 | Tokens per second: 4495.53 | Training tokens per second (%): 82.23 | MFU (%): 0.56 | TFLOPs: 5.54 | Fwd time: 0.0322154 | Bck time: 0.0446726
2025-05-23 01:29:42,235 - root - INFO - Step: 665 | Loss: 11.16 | Tokens per second: 4394.96 | Training tokens per second (%): 81.80 | MFU (%): 0.55 | TFLOPs: 5.42 | Fwd time: 0.0319565 | Bck time: 0.0439455
2025-05-23 01:29:42,804 - root - INFO - Step: 670 | Loss: 11.09 | Tokens per second: 4504.33 | Training tokens per second (%): 87.62 | MFU (%): 0.56 | TFLOPs: 5.56 | Fwd time: 0.0317251 | Bck time: 0.0442618
2025-05-23 01:29:43,374 - root - INFO - Step: 675 | Loss: 10.96 | Tokens per second: 4498.80 | Training tokens per second (%): 67.54 | MFU (%): 0.56 | TFLOPs: 5.55 | Fwd time: 0.0322647 | Bck time: 0.0438010
2025-05-23 01:29:43,954 - root - INFO - Step: 680 | Loss: 11.01 | Tokens per second: 4420.09 | Training tokens per second (%): 77.38 | MFU (%): 0.55 | TFLOPs: 5.45 | Fwd time: 0.0332306 | Bck time: 0.0439541
2025-05-23 01:29:44,526 - root - INFO - Step: 685 | Loss: 11.21 | Tokens per second: 4479.78 | Training tokens per second (%): 86.37 | MFU (%): 0.56 | TFLOPs: 5.53 | Fwd time: 0.0322858 | Bck time: 0.0441764
2025-05-23 01:29:45,089 - root - INFO - Step: 690 | Loss: 11.01 | Tokens per second: 4552.82 | Training tokens per second (%): 58.55 | MFU (%): 0.57 | TFLOPs: 5.62 | Fwd time: 0.0324663 | Bck time: 0.0444944
2025-05-23 01:29:45,673 - root - INFO - Step: 695 | Loss: 11.08 | Tokens per second: 4388.32 | Training tokens per second (%): 88.95 | MFU (%): 0.55 | TFLOPs: 5.41 | Fwd time: 0.0322011 | Bck time: 0.0437905
2025-05-23 01:29:46,238 - root - INFO - Step: 700 | Loss: 10.78 | Tokens per second: 4538.92 | Training tokens per second (%): 78.91 | MFU (%): 0.57 | TFLOPs: 5.60 | Fwd time: 0.0311182 | Bck time: 0.0445768
2025-05-23 01:29:47,267 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:29:47,268 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 01:29:47,869 - root - INFO - Step: 705 | Loss: 11.12 | Tokens per second: 1570.17 | Training tokens per second (%): 87.07 | MFU (%): 0.20 | TFLOPs: 1.94 | Fwd time: 0.0307763 | Bck time: 0.0445462
2025-05-23 01:29:48,441 - root - INFO - Step: 710 | Loss: 11.11 | Tokens per second: 4481.28 | Training tokens per second (%): 100.00 | MFU (%): 0.56 | TFLOPs: 5.53 | Fwd time: 0.0314211 | Bck time: 0.0447804
2025-05-23 01:29:49,003 - root - INFO - Step: 715 | Loss: 10.85 | Tokens per second: 4563.70 | Training tokens per second (%): 74.26 | MFU (%): 0.57 | TFLOPs: 5.63 | Fwd time: 0.0303387 | Bck time: 0.0440647
2025-05-23 01:29:49,557 - root - INFO - Step: 720 | Loss: 10.92 | Tokens per second: 4624.05 | Training tokens per second (%): 81.05 | MFU (%): 0.58 | TFLOPs: 5.70 | Fwd time: 0.0305904 | Bck time: 0.0439341
2025-05-23 01:29:50,111 - root - INFO - Step: 725 | Loss: 10.96 | Tokens per second: 4629.00 | Training tokens per second (%): 61.80 | MFU (%): 0.58 | TFLOPs: 5.71 | Fwd time: 0.0307269 | Bck time: 0.0426100
2025-05-23 01:29:50,667 - root - INFO - Step: 730 | Loss: 11.20 | Tokens per second: 4614.16 | Training tokens per second (%): 77.11 | MFU (%): 0.58 | TFLOPs: 5.69 | Fwd time: 0.0309154 | Bck time: 0.0436861
2025-05-23 01:29:51,223 - root - INFO - Step: 735 | Loss: 10.94 | Tokens per second: 4606.63 | Training tokens per second (%): 59.10 | MFU (%): 0.57 | TFLOPs: 5.68 | Fwd time: 0.0311783 | Bck time: 0.0436972
2025-05-23 01:29:51,786 - root - INFO - Step: 740 | Loss: 11.14 | Tokens per second: 4550.36 | Training tokens per second (%): 86.37 | MFU (%): 0.57 | TFLOPs: 5.61 | Fwd time: 0.0316148 | Bck time: 0.0438019
2025-05-23 01:29:52,340 - root - INFO - Step: 745 | Loss: 11.22 | Tokens per second: 4630.09 | Training tokens per second (%): 51.52 | MFU (%): 0.58 | TFLOPs: 5.71 | Fwd time: 0.0308302 | Bck time: 0.0436860
2025-05-23 01:29:52,904 - root - INFO - Step: 750 | Loss: 11.19 | Tokens per second: 4545.50 | Training tokens per second (%): 96.09 | MFU (%): 0.57 | TFLOPs: 5.61 | Fwd time: 0.0320148 | Bck time: 0.0434438
2025-05-23 01:29:53,465 - root - INFO - Step: 755 | Loss: 11.07 | Tokens per second: 4572.23 | Training tokens per second (%): 94.22 | MFU (%): 0.57 | TFLOPs: 5.64 | Fwd time: 0.0313497 | Bck time: 0.0435316
2025-05-23 01:29:54,034 - root - INFO - Step: 760 | Loss: 11.22 | Tokens per second: 4501.04 | Training tokens per second (%): 94.06 | MFU (%): 0.56 | TFLOPs: 5.55 | Fwd time: 0.0319728 | Bck time: 0.0438767
2025-05-23 01:29:54,612 - root - INFO - Step: 765 | Loss: 11.01 | Tokens per second: 4437.66 | Training tokens per second (%): 100.00 | MFU (%): 0.55 | TFLOPs: 5.47 | Fwd time: 0.0313704 | Bck time: 0.0435658
2025-05-23 01:29:55,176 - root - INFO - Step: 770 | Loss: 10.98 | Tokens per second: 4541.99 | Training tokens per second (%): 90.94 | MFU (%): 0.57 | TFLOPs: 5.60 | Fwd time: 0.0313279 | Bck time: 0.0438595
2025-05-23 01:29:55,746 - root - INFO - Step: 775 | Loss: 11.22 | Tokens per second: 4495.26 | Training tokens per second (%): 69.57 | MFU (%): 0.56 | TFLOPs: 5.54 | Fwd time: 0.0312873 | Bck time: 0.0435469
2025-05-23 01:29:56,302 - root - INFO - Step: 780 | Loss: 11.28 | Tokens per second: 4612.22 | Training tokens per second (%): 83.36 | MFU (%): 0.58 | TFLOPs: 5.69 | Fwd time: 0.0310060 | Bck time: 0.0436142
2025-05-23 01:29:56,865 - root - INFO - Step: 785 | Loss: 11.02 | Tokens per second: 4555.50 | Training tokens per second (%): 90.78 | MFU (%): 0.57 | TFLOPs: 5.62 | Fwd time: 0.0314944 | Bck time: 0.0441764
2025-05-23 01:29:57,426 - root - INFO - Step: 790 | Loss: 11.26 | Tokens per second: 4567.98 | Training tokens per second (%): 95.66 | MFU (%): 0.57 | TFLOPs: 5.63 | Fwd time: 0.0315600 | Bck time: 0.0439339
2025-05-23 01:29:58,005 - root - INFO - Step: 795 | Loss: 11.05 | Tokens per second: 4426.70 | Training tokens per second (%): 96.05 | MFU (%): 0.55 | TFLOPs: 5.46 | Fwd time: 0.0317650 | Bck time: 0.0435584
2025-05-23 01:29:58,583 - root - INFO - Step: 800 | Loss: 10.71 | Tokens per second: 4433.57 | Training tokens per second (%): 81.48 | MFU (%): 0.55 | TFLOPs: 5.47 | Fwd time: 0.0334736 | Bck time: 0.0433423
2025-05-23 01:29:59,617 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:29:59,623 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 01:30:00,250 - root - INFO - Step: 805 | Loss: 10.94 | Tokens per second: 1536.77 | Training tokens per second (%): 89.49 | MFU (%): 0.19 | TFLOPs: 1.90 | Fwd time: 0.0325313 | Bck time: 0.0437451
2025-05-23 01:30:00,821 - root - INFO - Step: 810 | Loss: 10.96 | Tokens per second: 4486.46 | Training tokens per second (%): 85.59 | MFU (%): 0.56 | TFLOPs: 5.53 | Fwd time: 0.0327875 | Bck time: 0.0433175
2025-05-23 01:30:01,403 - root - INFO - Step: 815 | Loss: 11.35 | Tokens per second: 4405.96 | Training tokens per second (%): 83.44 | MFU (%): 0.55 | TFLOPs: 5.43 | Fwd time: 0.0328266 | Bck time: 0.0441221
2025-05-23 01:30:01,976 - root - INFO - Step: 820 | Loss: 11.14 | Tokens per second: 4474.24 | Training tokens per second (%): 83.44 | MFU (%): 0.56 | TFLOPs: 5.52 | Fwd time: 0.0331571 | Bck time: 0.0439355
2025-05-23 01:30:02,555 - root - INFO - Step: 825 | Loss: 10.88 | Tokens per second: 4425.11 | Training tokens per second (%): 99.26 | MFU (%): 0.55 | TFLOPs: 5.46 | Fwd time: 0.0325244 | Bck time: 0.0440339
2025-05-23 01:30:03,126 - root - INFO - Step: 830 | Loss: 10.86 | Tokens per second: 4486.82 | Training tokens per second (%): 80.31 | MFU (%): 0.56 | TFLOPs: 5.53 | Fwd time: 0.0328365 | Bck time: 0.0438140
2025-05-23 01:30:03,692 - root - INFO - Step: 835 | Loss: 11.14 | Tokens per second: 4532.46 | Training tokens per second (%): 73.05 | MFU (%): 0.57 | TFLOPs: 5.59 | Fwd time: 0.0316696 | Bck time: 0.0438295
2025-05-23 01:30:04,259 - root - INFO - Step: 840 | Loss: 10.93 | Tokens per second: 4516.15 | Training tokens per second (%): 68.44 | MFU (%): 0.56 | TFLOPs: 5.57 | Fwd time: 0.0328345 | Bck time: 0.0436631
2025-05-23 01:30:04,832 - root - INFO - Step: 845 | Loss: 10.99 | Tokens per second: 4474.53 | Training tokens per second (%): 79.84 | MFU (%): 0.56 | TFLOPs: 5.52 | Fwd time: 0.0325409 | Bck time: 0.0442837
2025-05-23 01:30:05,402 - root - INFO - Step: 850 | Loss: 11.04 | Tokens per second: 4496.62 | Training tokens per second (%): 79.77 | MFU (%): 0.56 | TFLOPs: 5.55 | Fwd time: 0.0331333 | Bck time: 0.0440103
2025-05-23 01:30:05,983 - root - INFO - Step: 855 | Loss: 10.89 | Tokens per second: 4415.10 | Training tokens per second (%): 96.60 | MFU (%): 0.55 | TFLOPs: 5.45 | Fwd time: 0.0326926 | Bck time: 0.0435219
2025-05-23 01:30:06,548 - root - INFO - Step: 860 | Loss: 11.15 | Tokens per second: 4536.48 | Training tokens per second (%): 61.33 | MFU (%): 0.57 | TFLOPs: 5.59 | Fwd time: 0.0330392 | Bck time: 0.0433370
2025-05-23 01:30:07,118 - root - INFO - Step: 865 | Loss: 10.77 | Tokens per second: 4494.93 | Training tokens per second (%): 89.69 | MFU (%): 0.56 | TFLOPs: 5.54 | Fwd time: 0.0326360 | Bck time: 0.0435354
2025-05-23 01:30:07,694 - root - INFO - Step: 870 | Loss: 10.93 | Tokens per second: 4449.84 | Training tokens per second (%): 93.95 | MFU (%): 0.55 | TFLOPs: 5.49 | Fwd time: 0.0333549 | Bck time: 0.0442485
2025-05-23 01:30:08,266 - root - INFO - Step: 875 | Loss: 10.84 | Tokens per second: 4479.16 | Training tokens per second (%): 65.86 | MFU (%): 0.56 | TFLOPs: 5.52 | Fwd time: 0.0326289 | Bck time: 0.0439547
2025-05-23 01:30:08,840 - root - INFO - Step: 880 | Loss: 11.15 | Tokens per second: 4470.33 | Training tokens per second (%): 92.27 | MFU (%): 0.56 | TFLOPs: 5.51 | Fwd time: 0.0325947 | Bck time: 0.0434803
2025-05-23 01:30:09,415 - root - INFO - Step: 885 | Loss: 10.98 | Tokens per second: 4452.68 | Training tokens per second (%): 88.20 | MFU (%): 0.56 | TFLOPs: 5.49 | Fwd time: 0.0328749 | Bck time: 0.0422631
2025-05-23 01:30:09,992 - root - INFO - Step: 890 | Loss: 10.91 | Tokens per second: 4446.34 | Training tokens per second (%): 90.27 | MFU (%): 0.55 | TFLOPs: 5.48 | Fwd time: 0.0333744 | Bck time: 0.0437457
2025-05-23 01:30:10,560 - root - INFO - Step: 895 | Loss: 11.06 | Tokens per second: 4510.33 | Training tokens per second (%): 82.42 | MFU (%): 0.56 | TFLOPs: 5.56 | Fwd time: 0.0327655 | Bck time: 0.0433533
2025-05-23 01:30:11,130 - root - INFO - Step: 900 | Loss: 10.91 | Tokens per second: 4494.70 | Training tokens per second (%): 72.77 | MFU (%): 0.56 | TFLOPs: 5.54 | Fwd time: 0.0322803 | Bck time: 0.0439384
2025-05-23 01:30:12,191 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:30:12,199 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
2025-05-23 01:30:12,815 - root - INFO - Step: 905 | Loss: 11.27 | Tokens per second: 1520.13 | Training tokens per second (%): 64.02 | MFU (%): 0.19 | TFLOPs: 1.87 | Fwd time: 0.0321331 | Bck time: 0.0442084
2025-05-23 01:30:13,395 - root - INFO - Step: 910 | Loss: 10.84 | Tokens per second: 4423.16 | Training tokens per second (%): 91.95 | MFU (%): 0.55 | TFLOPs: 5.46 | Fwd time: 0.0331539 | Bck time: 0.0439171
2025-05-23 01:30:13,965 - root - INFO - Step: 915 | Loss: 10.96 | Tokens per second: 4493.53 | Training tokens per second (%): 78.75 | MFU (%): 0.56 | TFLOPs: 5.54 | Fwd time: 0.0320552 | Bck time: 0.0438778
2025-05-23 01:30:14,538 - root - INFO - Step: 920 | Loss: 10.96 | Tokens per second: 4475.36 | Training tokens per second (%): 99.73 | MFU (%): 0.56 | TFLOPs: 5.52 | Fwd time: 0.0332266 | Bck time: 0.0433563
2025-05-23 01:30:15,102 - root - INFO - Step: 925 | Loss: 10.83 | Tokens per second: 4543.88 | Training tokens per second (%): 62.85 | MFU (%): 0.57 | TFLOPs: 5.60 | Fwd time: 0.0322110 | Bck time: 0.0433826
2025-05-23 01:30:15,675 - root - INFO - Step: 930 | Loss: 11.11 | Tokens per second: 4477.84 | Training tokens per second (%): 84.69 | MFU (%): 0.56 | TFLOPs: 5.52 | Fwd time: 0.0327814 | Bck time: 0.0433287
2025-05-23 01:30:16,243 - root - INFO - Step: 935 | Loss: 11.03 | Tokens per second: 4505.38 | Training tokens per second (%): 90.55 | MFU (%): 0.56 | TFLOPs: 5.56 | Fwd time: 0.0319869 | Bck time: 0.0437167
2025-05-23 01:30:16,819 - root - INFO - Step: 940 | Loss: 11.06 | Tokens per second: 4453.10 | Training tokens per second (%): 97.46 | MFU (%): 0.56 | TFLOPs: 5.49 | Fwd time: 0.0332601 | Bck time: 0.0437095
2025-05-23 01:30:17,395 - root - INFO - Step: 945 | Loss: 10.81 | Tokens per second: 4451.14 | Training tokens per second (%): 82.30 | MFU (%): 0.56 | TFLOPs: 5.49 | Fwd time: 0.0319441 | Bck time: 0.0438692
2025-05-23 01:30:17,999 - root - INFO - Step: 950 | Loss: 10.62 | Tokens per second: 4243.09 | Training tokens per second (%): 83.75 | MFU (%): 0.53 | TFLOPs: 5.23 | Fwd time: 0.0340928 | Bck time: 0.0438220
2025-05-23 01:30:18,570 - root - INFO - Step: 955 | Loss: 10.43 | Tokens per second: 4486.28 | Training tokens per second (%): 72.66 | MFU (%): 0.56 | TFLOPs: 5.53 | Fwd time: 0.0317663 | Bck time: 0.0438620
2025-05-23 01:30:19,150 - root - INFO - Step: 960 | Loss: 11.10 | Tokens per second: 4421.21 | Training tokens per second (%): 86.52 | MFU (%): 0.55 | TFLOPs: 5.45 | Fwd time: 0.0335748 | Bck time: 0.0436922
2025-05-23 01:30:19,725 - root - INFO - Step: 965 | Loss: 10.96 | Tokens per second: 4459.12 | Training tokens per second (%): 77.11 | MFU (%): 0.56 | TFLOPs: 5.50 | Fwd time: 0.0328752 | Bck time: 0.0435979
2025-05-23 01:30:20,294 - root - INFO - Step: 970 | Loss: 10.93 | Tokens per second: 4503.61 | Training tokens per second (%): 59.96 | MFU (%): 0.56 | TFLOPs: 5.55 | Fwd time: 0.0326777 | Bck time: 0.0435283
2025-05-23 01:30:20,865 - root - INFO - Step: 975 | Loss: 10.72 | Tokens per second: 4486.58 | Training tokens per second (%): 84.57 | MFU (%): 0.56 | TFLOPs: 5.53 | Fwd time: 0.0327636 | Bck time: 0.0433359
2025-05-23 01:30:21,447 - root - INFO - Step: 980 | Loss: 11.06 | Tokens per second: 4408.92 | Training tokens per second (%): 93.05 | MFU (%): 0.55 | TFLOPs: 5.44 | Fwd time: 0.0307604 | Bck time: 0.0435539
2025-05-23 01:30:21,997 - root - INFO - Step: 985 | Loss: 11.20 | Tokens per second: 4658.21 | Training tokens per second (%): 93.44 | MFU (%): 0.58 | TFLOPs: 5.75 | Fwd time: 0.0303241 | Bck time: 0.0433768
2025-05-23 01:30:22,548 - root - INFO - Step: 990 | Loss: 11.20 | Tokens per second: 4652.77 | Training tokens per second (%): 76.68 | MFU (%): 0.58 | TFLOPs: 5.74 | Fwd time: 0.0311655 | Bck time: 0.0431247
2025-05-23 01:30:23,112 - root - INFO - Step: 995 | Loss: 11.25 | Tokens per second: 4547.05 | Training tokens per second (%): 76.60 | MFU (%): 0.57 | TFLOPs: 5.61 | Fwd time: 0.0308047 | Bck time: 0.0435102
2025-05-23 01:30:23,673 - root - INFO - Step: 1000 | Loss: 10.61 | Tokens per second: 4564.72 | Training tokens per second (%): 96.80 | MFU (%): 0.57 | TFLOPs: 5.63 | Fwd time: 0.0328666 | Bck time: 0.0435466
2025-05-23 01:30:24,733 - root - INFO - Random states checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts/rng_states.pt
2025-05-23 01:30:24,738 - root - INFO - Checkpoint saved to /iopsstor/scratch/cscs/bkundu/lsai-merger/chkpts
total_size: 767657764, bsize: 767657764, ratio: 2.0
767657764 2 False
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 23.3156681060791 ms
CPU copy took 1737.0028495788574 ms
---------------------- [PERF] Single Checkpoint time is 1.7733285427093506 sec, average is 1.773324966430664
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 23.242950439453125 ms
CPU copy took 1579.5459747314453 ms
---------------------- [PERF] Single Checkpoint time is 1.6232845783233643 sec, average is 1.6983033418655396
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 23.24390411376953 ms
CPU copy took 1254.0466785430908 ms
---------------------- [PERF] Single Checkpoint time is 1.2977533340454102 sec, average is 1.623281717300415
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 23.226499557495117 ms
CPU copy took 1228.759527206421 ms
---------------------- [PERF] Single Checkpoint time is 1.2775063514709473 sec, average is 1.4605168104171753
Save checkpoint with process 0
************** New checkpoint at position 0
GPU copy took 23.230314254760742 ms
CPU copy took 1282.761573791504 ms
---------------------- [PERF] Single Checkpoint time is 1.326423168182373 sec, average is 1.3264214992523193
Save checkpoint with process 0
************** New checkpoint at position 1
GPU copy took 23.230314254760742 ms
CPU copy took 1266.2510871887207 ms
---------------------- [PERF] Single Checkpoint time is 1.294785737991333 sec, average is 1.3120867013931274
---- exit
PR_ADDR_DATA is 0x4006772f0000, PR_ADDR is 0x400677070000, PEER_CHECK_ADDR is 0x4006770f0000
--------------- init enqueue: 0
--------------- init enqueue: 1
Call dram.alloc, num_batches is 2, batch_size_floats is 767657764
------------------------- is_distributed is 0, rank is 0
Parall_iter 0, Write new metadata at address 0x4006771f0000
------------------------- savenvmNew, is_distributed is 0, total_size is 767657764
At savenvmNew, tid is 45, parall_iter is 0, num_threads is 1, last counter is 0, curr_counter is 1
Writing offset is 58224, parall_iter_offset is 0
start_pr_arr is 0x4006772f0000, curr_pr_arr is 0x4006772f0000, batch_size is 767657764, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 767657764
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 767657764, start addr is 0x4006772f0000!
Thread ID: 1, savenvm_thread_nd took 1690.233216 ms
Thread ID: 1, set_cpu took 0.084541 ms
Threads took 1690.498072 ms
MSYNC 3070631056 TOOK 40.967440 ms
CAS was successful! new counter is 1, is_distributed is 0
******** checkp_info saved in 0x4006771f0000, curr_checkpoint is 0x4006771f0000
0, 1
Parall_iter 1, Write new metadata at address 0x400677270000
------------------------- savenvmNew, is_distributed is 0, total_size is 767657764
At savenvmNew, tid is 88, parall_iter is 1, num_threads is 1, last counter is 1, curr_counter is 2
Writing offset is 58224, parall_iter_offset is 767672320
start_pr_arr is 0x40072e360000, curr_pr_arr is 0x40072e360000, batch_size is 767657764, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 767657764
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 767657764, start addr is 0x40072e360000!
Thread ID: 2, savenvm_thread_nd took 1532.541928 ms
Thread ID: 2, set_cpu took 0.083613 ms
Threads took 1532.749153 ms
MSYNC 3070631056 TOOK 41.127661 ms
CAS was successful! new counter is 2, is_distributed is 0
******** checkp_info saved in 0x400677270000, curr_checkpoint is 0x400677270000
1, 2
Parall_iter 0, Write new metadata at address 0x4006771f0000
------------------------- savenvmNew, is_distributed is 0, total_size is 767657764
At savenvmNew, tid is 113, parall_iter is 0, num_threads is 1, last counter is 2, curr_counter is 3
Writing offset is 58224, parall_iter_offset is 0
start_pr_arr is 0x4006772f0000, curr_pr_arr is 0x4006772f0000, batch_size is 767657764, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 767657764
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 767657764, start addr is 0x4006772f0000!
Thread ID: 1, savenvm_thread_nd took 895.338562 ms
Thread ID: 1, set_cpu took 0.077214 ms
Threads took 895.537629 ms
MSYNC 3070631056 TOOK 352.257402 ms
CAS was successful! new counter is 3, is_distributed is 0
******** checkp_info saved in 0x4006771f0000, curr_checkpoint is 0x4006771f0000
0, 3
Parall_iter 1, Write new metadata at address 0x400677270000
------------------------- savenvmNew, is_distributed is 0, total_size is 767657764
At savenvmNew, tid is 10, parall_iter is 1, num_threads is 1, last counter is 3, curr_counter is 4
Writing offset is 58224, parall_iter_offset is 767672320
start_pr_arr is 0x40072e360000, curr_pr_arr is 0x40072e360000, batch_size is 767657764, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 767657764
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 767657764, start addr is 0x40072e360000!
Thread ID: 2, savenvm_thread_nd took 891.718765 ms
Thread ID: 2, set_cpu took 0.080477 ms
Threads took 891.913479 ms
MSYNC 3070631056 TOOK 331.224001 ms
CAS was successful! new counter is 4, is_distributed is 0
******** checkp_info saved in 0x400677270000, curr_checkpoint is 0x400677270000
1, 4
Parall_iter 0, Write new metadata at address 0x4006771f0000
------------------------- savenvmNew, is_distributed is 0, total_size is 767657764
At savenvmNew, tid is 56, parall_iter is 0, num_threads is 1, last counter is 4, curr_counter is 5
Writing offset is 58224, parall_iter_offset is 0
start_pr_arr is 0x4006772f0000, curr_pr_arr is 0x4006772f0000, batch_size is 767657764, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 767657764
CPU: 1, CPU USE: 2
At savenvm_thread_nd id is 1, sz is 767657764, start addr is 0x4006772f0000!
Thread ID: 1, savenvm_thread_nd took 918.284103 ms
Thread ID: 1, set_cpu took 0.070334 ms
Threads took 918.469185 ms
MSYNC 3070631056 TOOK 357.215930 ms
CAS was successful! new counter is 5, is_distributed is 0
******** checkp_info saved in 0x4006771f0000, curr_checkpoint is 0x4006771f0000
0, 5
Parall_iter 1, Write new metadata at address 0x400677270000
------------------------- savenvmNew, is_distributed is 0, total_size is 767657764
At savenvmNew, tid is 81, parall_iter is 1, num_threads is 1, last counter is 5, curr_counter is 6
Writing offset is 58224, parall_iter_offset is 767672320
start_pr_arr is 0x40072e360000, curr_pr_arr is 0x40072e360000, batch_size is 767657764, batch_num is 1
Save checkpoint - create threads!
size_for_thread_i is 767657764
CPU: 2, CPU USE: 3
At savenvm_thread_nd id is 2, sz is 767657764, start addr is 0x40072e360000!
Thread ID: 2, savenvm_thread_nd took 897.664737 ms
Thread ID: 2, set_cpu took 0.079678 ms
Threads took 897.860668 ms
MSYNC 3070631056 TOOK 366.994027 ms
CAS was successful! new counter is 6, is_distributed is 0
******** checkp_info saved in 0x400677270000, curr_checkpoint is 0x400677270000
1, 6
2025-05-23 01:30:25,727 - root - INFO - Training completed
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
Setting optimizer state...
Setting model state...
******************** CALL SAVE ********************
0, 3, 0
1, 4, 3
max_piter is 1
Writing offset is 58224, parall_iter_offset is 767672320
data_offset is 3073310720
